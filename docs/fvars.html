
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>fvars: FEHM thermodynamic calculations &#8212; PyFEHM 1.0.4 documentation</title>
    <link rel="stylesheet" href="_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorial.html" />
    <link rel="prev" title="fpost: FEHM output file manipulation" href="fpost.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fpost.html" title="fpost: FEHM output file manipulation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyFEHM 1.0.4 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    index.html" class="text-logo">PyFEHM</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="fgrid.html">fgrid: FEHM grid manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdata.html">fdata: FEHM input file manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="fpost.html">fpost: FEHM output file manipulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">fvars: FEHM thermodynamic calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorials</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Contents</h2>
    <div class="sidebar-localtoc">
      <ul>
<li><a class="reference internal" href="#">fvars: FEHM thermodynamic calculations</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

    </div>
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="index.html">Docs</a></li>
              
              <li>fvars: FEHM thermodynamic calculations</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="fvars-fehm-thermodynamic-calculations">
<span id="fvars-chapter"></span><h1>fvars: FEHM thermodynamic calculations<a class="headerlink" href="#fvars-fehm-thermodynamic-calculations" title="Permalink to this headline">¶</a></h1>
<p>It is occasionally useful to be able to calculate thermodynamic properties of the fluids that FEHM simulates.
For convenience, the functions that calculate these properties, for two-phase water and CO2, are supplied here. Density
(<a class="reference internal" href="#fvars.dens" title="fvars.dens"><code class="xref py py-func docutils literal notranslate"><span class="pre">dens()</span></code></a>), enthalpy (<a class="reference internal" href="#fvars.enth" title="fvars.enth"><code class="xref py py-func docutils literal notranslate"><span class="pre">enth()</span></code></a>) and viscosity (<a class="reference internal" href="#fvars.visc" title="fvars.visc"><code class="xref py py-func docutils literal notranslate"><span class="pre">visc()</span></code></a>), and their corresponding
derivatives with respect to pressure and temperature, can be calculated for
given pressure and temperature conditions. Furthermore, the position and derivatives of the saturation line for water
can be calculated for a given temperature or pressure (<a class="reference internal" href="#fvars.sat" title="fvars.sat"><code class="xref py py-func docutils literal notranslate"><span class="pre">sat()</span></code></a> and <a class="reference internal" href="#fvars.tsat" title="fvars.tsat"><code class="xref py py-func docutils literal notranslate"><span class="pre">tsat()</span></code></a>).</p>
<p>Note, these functions are vectorised; that is, the user can supply vectors of temperature and pressure to output a
vector of the corresponding variable.</p>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="fvars.dens">
<code class="descclassname">fvars.</code><code class="descname">dens</code><span class="sig-paren">(</span><em>P</em>, <em>T</em>, <em>derivative=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#dens"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return liquid water, vapor water and CO2 density, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>P</strong> (<em>fl64</em>) – Pressure (MPa).</li>
<li><strong>T</strong> (<em>str</em>) – Temperature (degC)</li>
<li><strong>derivative</strong> – Supply ‘T’ or ‘temperature’ for derivatives with respect to temperature, or ‘P’ or ‘pressure’ for derivatives with respect to pressure.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Three element tuple containing (liquid, vapor, CO2) density or derivatives if requested.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fvars.enth">
<code class="descclassname">fvars.</code><code class="descname">enth</code><span class="sig-paren">(</span><em>P</em>, <em>T</em>, <em>derivative=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#enth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.enth" title="Permalink to this definition">¶</a></dt>
<dd><p>Return liquid water, vapor water and CO2 enthalpy, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>P</strong> (<em>fl64</em>) – Pressure (MPa).</li>
<li><strong>T</strong> (<em>str</em>) – Temperature (degC)</li>
<li><strong>derivative</strong> – Supply ‘T’ or ‘temperature’ for derivatives with respect to temperature, or ‘P’ or ‘pressure’ for derivatives with respect to pressure.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Three element tuple containing (liquid, vapor, CO2) enthalpy or derivatives if requested.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fvars.visc">
<code class="descclassname">fvars.</code><code class="descname">visc</code><span class="sig-paren">(</span><em>P</em>, <em>T</em>, <em>derivative=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#visc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.visc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return liquid water, vapor water and CO2 viscosity, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>P</strong> (<em>fl64</em>) – Pressure (MPa).</li>
<li><strong>T</strong> (<em>str</em>) – Temperature (degC)</li>
<li><strong>derivative</strong> – Supply ‘T’ or ‘temperature’ for derivatives with respect to temperature, or ‘P’ or ‘pressure’ for derivatives with respect to pressure.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Three element tuple containing (liquid, vapor, CO2) viscosity or derivatives if requested.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fvars.sat">
<code class="descclassname">fvars.</code><code class="descname">sat</code><span class="sig-paren">(</span><em>T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#sat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.sat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return saturation pressure and first derivative for given temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>T</strong> (<em>fl64</em>) – Temperature (degC)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Two element tuple containing (saturation pressure, derivative).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fvars.tsat">
<code class="descclassname">fvars.</code><code class="descname">tsat</code><span class="sig-paren">(</span><em>P</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#tsat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.tsat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return saturation temperature and first derivative for given pressure.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>P</strong> (<em>fl64</em>) – Pressure (degC)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Two element tuple containing (saturation temperature, derivative).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="fvars.fluid_column">
<code class="descclassname">fvars.</code><code class="descname">fluid_column</code><span class="sig-paren">(</span><em>z</em>, <em>Tgrad</em>, <em>Tsurf</em>, <em>Psurf</em>, <em>iterations=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fvars.html#fluid_column"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fvars.fluid_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate thermodynamic properties of a column of fluid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>ndarray</em>) – Vector of depths at which to return properties. If z does not begin at 0, this will be prepended.</li>
<li><strong>Tgrad</strong> (<em>fl64</em>) – Temperature gradient in the column (degC / m).</li>
<li><strong>Tsurf</strong> (<em>fl64</em>) – Surface temperature (degC).</li>
<li><strong>Psurf</strong> – Surface pressure (MPa).</li>
<li><strong>iterations</strong> (<em>int</em>) – Number of times to recalculate column pressure based on updated density.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Three element tuple containing (liquid, vapor, CO2) properties. Each contains a three column array corresponding to pressure, temperature, density, enthalpy and viscosity of the fluid.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Calculate the density of liquid water at 10 MPa and 150degC</li>
</ol>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">rho=</span></code><a class="reference internal" href="#fvars.dens" title="fvars.dens"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dens</span></code></a><code class="docutils literal notranslate"><span class="pre">(10,150)[0]</span></code></div></blockquote>
<ol class="arabic simple" start="2">
<li>Calculate the derivative of water vapor enthalpy with respect to temperature, at 2 MPa and 200 - 250 degC.</li>
</ol>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">dhdt=</span></code><a class="reference internal" href="#fvars.enth" title="fvars.enth"><code class="xref py py-meth docutils literal notranslate"><span class="pre">enth</span></code></a><code class="docutils literal notranslate"><span class="pre">(2,np.linspace(200,250,10),'T')[1]</span></code></div></blockquote>
<ol class="arabic simple" start="3">
<li>Calculate the pressure at which water turns two-phase, for a temperature of 200degC.</li>
</ol>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">Psat=</span></code><a class="reference internal" href="#fvars.sat" title="fvars.sat"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sat</span></code></a><code class="docutils literal notranslate"><span class="pre">(200)[0]</span></code></div></blockquote>
<ol class="arabic simple" start="4">
<li>Calculate the viscosity of CO2 at 40degC and 9 MPa.</li>
</ol>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">mu=</span></code><a class="reference internal" href="#fvars.visc" title="fvars.visc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">visc</span></code></a><code class="docutils literal notranslate"><span class="pre">(9,40)[2]</span></code></div></blockquote>
<ol class="arabic simple" start="5">
<li>Calculate the pressure of a column of CO2, with a surface pressure of 8 MPa, and a geothermal gradient of 25degC / km.</li>
</ol>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">z=np.linspace(0,4e3,200)</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">Pco2=</span></code><a class="reference internal" href="#fvars.fluid_column" title="fvars.fluid_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fluid_column</span></code></a><code class="docutils literal notranslate"><span class="pre">(z,0.025,20,8)[2][:,0]</span></code></p>
</div></blockquote>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="fpost.html" title="previous chapter (use the left arrow)">fpost: FEHM output file manipulation</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="tutorial.html" title="next chapter (use the right arrow)">Tutorials</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="Tutorials"
             >next</a> |</li>
        <li class="right" >
          <a href="fpost.html" title="fpost: FEHM output file manipulation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">PyFEHM 1.0.4 documentation</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2018, Los Alamos National Laboratory. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>