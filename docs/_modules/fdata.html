
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>fdata &#8212; PyFEHM 1.0.4 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFEHM 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">PyFEHM</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fgrid.html">fgrid: FEHM grid manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fdata.html">fdata: FEHM input file manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpost.html">fpost: FEHM output file manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fvars.html">fvars: FEHM thermodynamic calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Module code</a></li>
              
              <li>fdata</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <h1>Source code for fdata</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Class for FEHM data&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Copyright 2013.</span>
<span class="sd">Los Alamos National Security, LLC. </span>
<span class="sd">This material was produced under U.S. Government contract DE-AC52-06NA25396 for </span>
<span class="sd">Los Alamos National Laboratory (LANL), which is operated by Los Alamos National </span>
<span class="sd">Security, LLC for the U.S. Department of Energy. The U.S. Government has rights </span>
<span class="sd">to use, reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS </span>
<span class="sd">ALAMOS NATIONAL SECURITY, LLC MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES </span>
<span class="sd">ANY LIABILITY FOR THE USE OF THIS SOFTWARE.  If software is modified to produce </span>
<span class="sd">derivative works, such modified software should be clearly marked, so as not to </span>
<span class="sd">confuse it with the version available from LANL.</span>

<span class="sd">Additionally, this library is free software; you can redistribute it and/or modify </span>
<span class="sd">it under the terms of the GNU Lesser General Public License as published by the </span>
<span class="sd">Free Software Foundation; either version 2.1 of the License, or (at your option) </span>
<span class="sd">any later version. Accordingly, this library is distributed in the hope that it </span>
<span class="sd">will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of </span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General </span>
<span class="sd">Public License for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span><span class="p">,</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span><span class="nn">time</span><span class="o">,</span><span class="nn">platform</span><span class="o">,</span><span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="k">import</span> <span class="n">Popen</span><span class="p">,</span> <span class="n">PIPE</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">Tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_tkagg</span> <span class="k">import</span> <span class="n">FigureCanvasTkAgg</span><span class="p">,</span> <span class="n">NavigationToolbar2TkAgg</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="k">import</span> <span class="n">Rectangle</span>

<span class="k">try</span><span class="p">:</span> <span class="kn">import</span> <span class="nn">ctypes</span><span class="p">;</span> <span class="n">has_ctypes</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span> <span class="n">has_ctypes</span> <span class="o">=</span> <span class="kc">False</span>

<span class="k">try</span><span class="p">:</span>
	<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
	<span class="c1">#plt.ion()</span>
	<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="k">import</span> <span class="n">axes3d</span>
	<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">cm</span>
	<span class="kn">from</span> <span class="nn">matplotlib.pylab</span> <span class="k">import</span> <span class="n">subplots</span><span class="p">,</span><span class="n">close</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
	<span class="s1">&#39;placeholder&#39;</span>

<span class="kn">from</span> <span class="nn">fgrid</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">fvars</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">fpost</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">fdflt</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">fhelp</span> <span class="k">import</span><span class="o">*</span>

<span class="n">dflt</span> <span class="o">=</span> <span class="n">fdflt</span><span class="p">()</span>

<span class="n">WINDOWS</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;Windows&#39;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">WINDOWS</span><span class="p">:</span> <span class="n">has_ctypes</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># list of macros that might be encountered</span>
<span class="n">fdata_sections</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cont&#39;</span><span class="p">,</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;zonn&#39;</span><span class="p">,</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;ctrl&#39;</span><span class="p">,</span><span class="s1">&#39;iter&#39;</span><span class="p">,</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span>
					<span class="s1">&#39;boun&#39;</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="s1">&#39;strs&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;sol&#39;</span><span class="p">,</span><span class="s1">&#39;nfin&#39;</span><span class="p">,</span><span class="s1">&#39;hist&#39;</span><span class="p">,</span><span class="s1">&#39;node&#39;</span><span class="p">,</span><span class="s1">&#39;carb&#39;</span><span class="p">,</span><span class="s1">&#39;rlp&#39;</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;nobr&#39;</span><span class="p">,</span>
					<span class="s1">&#39;flxz&#39;</span><span class="p">,</span><span class="s1">&#39;rlpm&#39;</span><span class="p">,</span><span class="s1">&#39;hflx&#39;</span><span class="p">,</span><span class="s1">&#39;trac&#39;</span><span class="p">,</span><span class="s1">&#39;vcon&#39;</span><span class="p">,</span><span class="s1">&#39;ppor&#39;</span><span class="p">,</span><span class="s1">&#39;vapl&#39;</span><span class="p">,</span><span class="s1">&#39;adif&#39;</span><span class="p">,</span><span class="s1">&#39;ngas&#39;</span><span class="p">,</span><span class="s1">&#39;flxo&#39;</span><span class="p">,</span><span class="s1">&#39;head&#39;</span><span class="p">,</span><span class="s1">&#39;flxn&#39;</span><span class="p">,</span><span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="s1">&#39;airwater&#39;</span><span class="p">]</span>
<span class="c1"># list of potential CONTOUR output variables</span>
<span class="n">contour_variables</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span><span class="s1">&#39;stress&#39;</span><span class="p">],</span>
				   <span class="p">[</span><span class="s1">&#39;co2&#39;</span><span class="p">],</span>
				   <span class="p">[</span><span class="s1">&#39;vapor&#39;</span><span class="p">,</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span><span class="s1">&#39;capillary&#39;</span><span class="p">,</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="s1">&#39;displacement&#39;</span><span class="p">,</span><span class="s1">&#39;fhydrate&#39;</span><span class="p">,</span><span class="s1">&#39;flux&#39;</span><span class="p">,</span><span class="s1">&#39;permeability&#39;</span><span class="p">,</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="s1">&#39;source&#39;</span><span class="p">,</span><span class="s1">&#39;velocity&#39;</span><span class="p">,</span><span class="s1">&#39;wt&#39;</span><span class="p">,</span><span class="s1">&#39;zid&#39;</span><span class="p">],</span>
				   <span class="p">[</span><span class="s1">&#39;formatted&#39;</span><span class="p">,</span><span class="s1">&#39;material&#39;</span><span class="p">,</span><span class="s1">&#39;liquid&#39;</span><span class="p">,</span><span class="s1">&#39;geo&#39;</span><span class="p">,</span><span class="s1">&#39;nodit&#39;</span><span class="p">,</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;head&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span><span class="s1">&#39;zone&#39;</span><span class="p">]]</span>
<span class="c1"># list of potential HISTORY output variables</span>
<span class="n">history_variables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="s1">&#39;mpa&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="s1">&#39;head&#39;</span><span class="p">,</span><span class="s1">&#39;meters&#39;</span><span class="p">,</span><span class="s1">&#39;feet&#39;</span><span class="p">,</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="s1">&#39;wco&#39;</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="s1">&#39;kgs&#39;</span><span class="p">,</span>
				   <span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span><span class="s1">&#39;efl&#39;</span><span class="p">,</span><span class="s1">&#39;mjs&#39;</span><span class="p">,</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="s1">&#39;humidity&#39;</span><span class="p">,</span><span class="s1">&#39;viscosity&#39;</span><span class="p">,</span><span class="s1">&#39;zflux&#39;</span><span class="p">,</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;wt&#39;</span><span class="p">,</span><span class="s1">&#39;co2s&#39;</span><span class="p">,</span>
				   <span class="s1">&#39;co2sl&#39;</span><span class="p">,</span><span class="s1">&#39;co2sg&#39;</span><span class="p">,</span><span class="s1">&#39;co2m&#39;</span><span class="p">,</span><span class="s1">&#39;co2mt&#39;</span><span class="p">,</span><span class="s1">&#39;co2mf&#39;</span><span class="p">,</span><span class="s1">&#39;co2md&#39;</span><span class="p">,</span><span class="s1">&#39;cfluxz&#39;</span><span class="p">,</span><span class="s1">&#39;displacements&#39;</span><span class="p">,</span><span class="s1">&#39;disx&#39;</span><span class="p">,</span><span class="s1">&#39;disy&#39;</span><span class="p">,</span><span class="s1">&#39;disz&#39;</span><span class="p">,</span>
				   <span class="s1">&#39;stress&#39;</span><span class="p">,</span><span class="s1">&#39;strsx&#39;</span><span class="p">,</span><span class="s1">&#39;strsy&#39;</span><span class="p">,</span><span class="s1">&#39;strsz&#39;</span><span class="p">,</span><span class="s1">&#39;strsxy&#39;</span><span class="p">,</span><span class="s1">&#39;strsxz&#39;</span><span class="p">,</span><span class="s1">&#39;strsyz&#39;</span><span class="p">,</span><span class="s1">&#39;strain&#39;</span><span class="p">,</span><span class="s1">&#39;rel&#39;</span><span class="p">,</span><span class="s1">&#39;global&#39;</span><span class="p">]</span>
<span class="c1"># dictionary of perm model parameters, indexed by perm model number, ORDER OF LIST MUST EQUAL ORDER OF INPUT</span>
<span class="n">permDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[]),</span>
	
	<span class="p">(</span><span class="mi">21</span><span class="p">,[</span><span class="s1">&#39;nx&#39;</span><span class="p">,</span><span class="s1">&#39;ny&#39;</span><span class="p">,</span><span class="s1">&#39;nz&#39;</span><span class="p">,</span><span class="s1">&#39;frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;cohesion&#39;</span><span class="p">,</span><span class="s1">&#39;pore_press_factor&#39;</span><span class="p">,</span><span class="s1">&#39;tau_ex_ramp_range&#39;</span><span class="p">,</span>
	<span class="s1">&#39;yngs_mod_mult_x&#39;</span><span class="p">,</span><span class="s1">&#39;yngs_mod_mult_y&#39;</span><span class="p">,</span><span class="s1">&#39;yngs_mod_mult_z&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_x&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_y&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_z&#39;</span><span class="p">]),</span>
	
	<span class="p">(</span><span class="mi">22</span><span class="p">,[</span><span class="s1">&#39;frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;cohesion&#39;</span><span class="p">,</span><span class="s1">&#39;pore_press_factor&#39;</span><span class="p">,</span><span class="s1">&#39;tau_ex_ramp_range&#39;</span><span class="p">,</span><span class="s1">&#39;yngs_mod_mult_x&#39;</span><span class="p">,</span><span class="s1">&#39;yngs_mod_mult_y&#39;</span><span class="p">,</span>
	<span class="s1">&#39;yngs_mod_mult_z&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_x&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_y&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_z&#39;</span><span class="p">,</span><span class="s1">&#39;por_mult&#39;</span><span class="p">,</span><span class="s1">&#39;perm_incremental&#39;</span><span class="p">,</span><span class="s1">&#39;tau_ex_init&#39;</span><span class="p">]),</span>
	
	<span class="p">(</span><span class="mi">24</span><span class="p">,[</span><span class="s1">&#39;shear_frac_tough&#39;</span><span class="p">,</span><span class="s1">&#39;static_frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;dynamic_frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;frac_num&#39;</span><span class="p">,</span><span class="s1">&#39;onset_disp&#39;</span><span class="p">,</span>
	<span class="s1">&#39;disp_interval&#39;</span><span class="p">,</span><span class="s1">&#39;max_perm_change&#39;</span><span class="p">,</span><span class="s1">&#39;frac_cohesion&#39;</span><span class="p">,</span><span class="s1">&#39;frac_dens&#39;</span><span class="p">]),</span>
	
	<span class="p">(</span><span class="mi">25</span><span class="p">,[</span><span class="s1">&#39;shear_frac_tough&#39;</span><span class="p">,</span>
	<span class="s1">&#39;static_frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;dynamic_frict_coef&#39;</span><span class="p">,</span><span class="s1">&#39;frac_num&#39;</span><span class="p">,</span><span class="s1">&#39;onset_disp&#39;</span><span class="p">,</span><span class="s1">&#39;disp_interval&#39;</span><span class="p">,</span><span class="s1">&#39;max_perm_change&#39;</span><span class="p">,</span>
	<span class="s1">&#39;frac_cohesion&#39;</span><span class="p">]),</span>
	
	<span class="p">(</span><span class="mi">100</span><span class="p">,[</span><span class="s1">&#39;perm_mult_x&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_y&#39;</span><span class="p">,</span><span class="s1">&#39;perm_mult_z&#39;</span><span class="p">,</span><span class="s1">&#39;ramp_range&#39;</span><span class="p">]),</span>
	<span class="p">))</span>
<span class="c1"># dictionary of plastic model parameters, indexed by plastic model number, ORDER OF LIST MUST EQUAL ORDER OF INPUT</span>
<span class="n">plasticDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">,</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">,</span><span class="s1">&#39;eta_drucker&#39;</span><span class="p">,</span><span class="s1">&#39;zeta_drucker&#39;</span><span class="p">,</span><span class="s1">&#39;c_drucker&#39;</span><span class="p">]),</span>
	<span class="p">))</span>
<span class="c1"># dictionary of perm model units, indexed by perm model number, ORDER OF LIST MUST EQUAL ORDER OF INPUT</span>
<span class="n">permUnits</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[]),</span>
	<span class="p">(</span><span class="mi">21</span><span class="p">,[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">22</span><span class="p">,[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">24</span><span class="p">,[</span><span class="s1">&#39;MPa/m&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;log(m^2)&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">25</span><span class="p">,[</span><span class="s1">&#39;MPa/m&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="s1">&#39;log(m^2)&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">100</span><span class="p">,[</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;MPa&#39;</span><span class="p">]),</span>
	<span class="p">))</span>
<span class="c1"># dictionary of relative permeability model parameters, indexed by model number, ORDER OF LIST MUST EQUAL ORDER OF INPUT</span>
<span class="n">rlpDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;liq_rel_perm&#39;</span><span class="p">,</span><span class="s1">&#39;vap_rel_perm&#39;</span><span class="p">,</span><span class="s1">&#39;cap_pres_zero_sat&#39;</span><span class="p">,</span><span class="s1">&#39;sat_zero_cap_pres&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;resid_liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;resid_vap_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_vap_sat&#39;</span><span class="p">,</span><span class="s1">&#39;cap_pres_zero_sat&#39;</span><span class="p">,</span><span class="s1">&#39;sat_zero_cap_pres&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;resid_liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;resid_vap_sat&#39;</span><span class="p">,</span><span class="s1">&#39;cap_pres_zero_sat&#39;</span><span class="p">,</span><span class="s1">&#39;sat_zero_cap_pres&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="s1">&#39;resid_liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;resid_vap_sat&#39;</span><span class="p">,</span><span class="s1">&#39;inv_air_entry_head&#39;</span><span class="p">,</span><span class="s1">&#39;power_exponent&#39;</span><span class="p">,</span>
	<span class="s1">&#39;low_sat_fit_param&#39;</span><span class="p">,</span><span class="s1">&#39;cutoff_sat&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">16</span><span class="p">,[</span><span class="s1">&#39;resid_water_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_water_sat&#39;</span><span class="p">,</span><span class="s1">&#39;water_exp&#39;</span><span class="p">,</span><span class="s1">&#39;resid_co2_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_co2_sat&#39;</span><span class="p">,</span><span class="s1">&#39;co2_exp&#39;</span><span class="p">,</span>
	<span class="s1">&#39;co2_water_Pc_exp&#39;</span><span class="p">,</span><span class="s1">&#39;co2_water_Pc_max&#39;</span><span class="p">]),</span>
	<span class="p">(</span><span class="mi">17</span><span class="p">,[</span><span class="s1">&#39;resid_water_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_water_sat&#39;</span><span class="p">,</span><span class="s1">&#39;water_exp&#39;</span><span class="p">,</span><span class="s1">&#39;resid_co2liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_co2liq_sat&#39;</span><span class="p">,</span><span class="s1">&#39;co2liq_exp&#39;</span><span class="p">,</span>
	<span class="s1">&#39;co2gasliq_exp&#39;</span><span class="p">,</span><span class="s1">&#39;resid_co2gas_sat&#39;</span><span class="p">,</span><span class="s1">&#39;max_co2gas_sat&#39;</span><span class="p">,</span><span class="s1">&#39;co2gas_exp&#39;</span><span class="p">,</span><span class="s1">&#39;co2liq_water_Pc_exp&#39;</span><span class="p">,</span><span class="s1">&#39;co2liq_water_Pc_max&#39;</span><span class="p">,</span>
	<span class="s1">&#39;co2liq_co2gas_Pc_exp&#39;</span><span class="p">,</span><span class="s1">&#39;co2liq_co2gas_Pc_max&#39;</span><span class="p">]),</span>
	<span class="p">))</span>
<span class="n">adsorptionDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="s1">&#39;alpha1&#39;</span><span class="p">,</span><span class="s1">&#39;alpha2&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">]),</span>		<span class="c1"># conservative solute</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;alpha1&#39;</span><span class="p">,</span><span class="s1">&#39;alpha2&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">]),</span>		<span class="c1"># linear sorption isotherm</span>
	<span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;alpha1&#39;</span><span class="p">,</span><span class="s1">&#39;alpha2&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">]),</span>		<span class="c1"># Freundlich sorption isotherm</span>
	<span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="s1">&#39;alpha1&#39;</span><span class="p">,</span><span class="s1">&#39;alpha2&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">]),</span>		<span class="c1"># Modified Freundlich sorption isotherm</span>
	<span class="p">(</span><span class="mi">4</span><span class="p">,[</span><span class="s1">&#39;alpha1&#39;</span><span class="p">,</span><span class="s1">&#39;alpha2&#39;</span><span class="p">,</span><span class="s1">&#39;beta&#39;</span><span class="p">]),</span>		<span class="c1"># Langmuir sorption isotherm</span>
	<span class="p">))</span>
<span class="n">diffusionDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">0</span><span class="p">,[</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_x&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_y&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_z&#39;</span><span class="p">]),</span>		<span class="c1"># molecular diffusion coefficient is constant</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_x&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_y&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_z&#39;</span><span class="p">]),</span>		<span class="c1"># Millington Quark diffusion model</span>
	<span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_x&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_y&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_z&#39;</span><span class="p">]),</span>		<span class="c1"># Conca Wright diffusion model</span>
	<span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_x&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_y&#39;</span><span class="p">,</span><span class="s1">&#39;dispersion_z&#39;</span><span class="p">]),</span>		<span class="c1"># calculated from adif</span>
	<span class="p">))</span>
<span class="n">vconDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;T_ref&#39;</span><span class="p">,</span><span class="s1">&#39;cond_ref&#39;</span><span class="p">,</span><span class="s1">&#39;dcond_dT&#39;</span><span class="p">]),</span>		<span class="c1"># linear variation of thermal conductivity with temperature</span>
	<span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;cond_s1&#39;</span><span class="p">,</span><span class="s1">&#39;cond_s0&#39;</span><span class="p">]),</span>					<span class="c1"># square root variation of thermal conductivity with liquid saturation</span>
	<span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="s1">&#39;T_ref&#39;</span><span class="p">,</span><span class="s1">&#39;cond_ref&#39;</span><span class="p">,</span><span class="s1">&#39;exponent&#39;</span><span class="p">]),</span>		<span class="c1"># intact salt</span>
	<span class="p">(</span><span class="mi">4</span><span class="p">,[</span><span class="s1">&#39;T_ref&#39;</span><span class="p">,</span><span class="s1">&#39;cond_ref&#39;</span><span class="p">,</span><span class="s1">&#39;coeff_phi4&#39;</span><span class="p">,</span><span class="s1">&#39;coeff_phi3&#39;</span><span class="p">,</span><span class="s1">&#39;coeff_phi2&#39;</span><span class="p">,</span><span class="s1">&#39;coeff_phi1&#39;</span><span class="p">,</span><span class="s1">&#39;coeff_phi0&#39;</span><span class="p">,</span><span class="s1">&#39;exponent&#39;</span><span class="p">]),</span> <span class="c1"># crushed salt</span>
	<span class="p">))</span>
<span class="n">pporDicts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;compressibility&#39;</span><span class="p">]),</span>		<span class="c1"># aquifer compressibility</span>
	<span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,[</span><span class="s1">&#39;specific_storage&#39;</span><span class="p">]),</span>					<span class="c1"># specific storage</span>
	<span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,[</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="s1">&#39;Px&#39;</span><span class="p">]),</span>		<span class="c1"># gangi model</span>
	<span class="p">(</span><span class="mi">7</span><span class="p">,[</span><span class="s1">&#39;param1&#39;</span><span class="p">,</span><span class="s1">&#39;param2&#39;</span><span class="p">,</span><span class="s1">&#39;param3&#39;</span><span class="p">,</span><span class="s1">&#39;param4&#39;</span><span class="p">]),</span> 		<span class="c1"># unknown - salt</span>
	<span class="p">))</span>
<span class="n">model_list</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;permmodel&#39;</span><span class="p">,</span><span class="n">permDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">,</span><span class="n">plasticDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;rlp&#39;</span><span class="p">,</span><span class="n">rlpDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;vcon&#39;</span><span class="p">,</span><span class="n">vconDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;ppor&#39;</span><span class="p">,</span><span class="n">pporDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;adsorption&#39;</span><span class="p">,</span><span class="n">adsorptionDicts</span><span class="p">),</span>
		<span class="p">(</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="n">diffusionDicts</span><span class="p">)))</span>
<span class="n">model_titles</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;rlp&#39;</span><span class="p">,</span><span class="s1">&#39;RELATIVE PERMEABILITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;permmodel&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;vcon&#39;</span><span class="p">,</span><span class="s1">&#39;VARIABLE THERMAL CONDUCTIVITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;ppor&#39;</span><span class="p">,</span><span class="s1">&#39;VARIABLE POROSITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;dispersion&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;adsorption&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">))</span>
<span class="c1"># list of macros</span>
<span class="n">fpres</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fperm</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;ky&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;kz&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fcond</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;cond_x&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;cond_y&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;cond_z&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fflow</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;impedance&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">frock</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fgrad</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;reference_coord&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;direction&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;variable&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;reference_value&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;gradient&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fbiot</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">felastic</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fbodyforce</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;fx&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;fy&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;fz&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fco2frac</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;water_rich_sat&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;co2_rich_sat&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;co2_mass_frac&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;init_salt_conc&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;override_flag&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fco2flow</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;impedance&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;bc_flag&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fco2diff</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;tortuosity&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fco2pres</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fstressboun</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;direction&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">fhflx</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;heat_flow&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;multiplier&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>
<span class="n">ftpor</span> <span class="o">=</span> <span class="p">((</span><span class="s1">&#39;tracer_porosity&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),)</span>

<span class="n">macro_list</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">fpres</span><span class="p">),(</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="n">fperm</span><span class="p">),(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="n">fcond</span><span class="p">),(</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="n">fflow</span><span class="p">),(</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="n">frock</span><span class="p">),</span>
			<span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">,</span><span class="n">fbiot</span><span class="p">),(</span><span class="s1">&#39;elastic&#39;</span><span class="p">,</span><span class="n">felastic</span><span class="p">),(</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">,</span><span class="n">fbodyforce</span><span class="p">),(</span><span class="s1">&#39;co2frac&#39;</span><span class="p">,</span><span class="n">fco2frac</span><span class="p">),(</span><span class="s1">&#39;co2flow&#39;</span><span class="p">,</span><span class="n">fco2flow</span><span class="p">),</span>
			<span class="p">(</span><span class="s1">&#39;co2pres&#39;</span><span class="p">,</span><span class="n">fco2pres</span><span class="p">),(</span><span class="s1">&#39;co2diff&#39;</span><span class="p">,</span><span class="n">fco2diff</span><span class="p">),</span>
			<span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="n">fstressboun</span><span class="p">),(</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="n">fgrad</span><span class="p">),(</span><span class="s1">&#39;hflx&#39;</span><span class="p">,</span><span class="n">fhflx</span><span class="p">),(</span><span class="s1">&#39;tpor&#39;</span><span class="p">,</span><span class="n">ftpor</span><span class="p">)))</span>
			
<span class="c1"># potential nodal properties</span>
<span class="n">node_props</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="s1">&#39;ky&#39;</span><span class="p">,</span><span class="s1">&#39;kz&#39;</span><span class="p">,</span><span class="s1">&#39;cond_x&#39;</span><span class="p">,</span><span class="s1">&#39;cond_y&#39;</span><span class="p">,</span><span class="s1">&#39;cond_z&#39;</span><span class="p">,</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">,</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">,</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">,</span>
<span class="s1">&#39;youngs_modulus&#39;</span><span class="p">,</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">)</span>
<span class="n">node_gen</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span><span class="s1">&#39;impedance&#39;</span><span class="p">)</span>
<span class="n">macro_titles</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;INITIAL TEMPERATURE AND PRESSURE&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="s1">&#39;PERMEABILITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="s1">&#39;ROCK CONDUCTIVITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="s1">&#39;GENERATORS&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;hflx&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="s1">&#39;MATERIAL PARAMETERS&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;INITIAL VARIABLE GRADIENTS&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;co2flow&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;co2frac&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;co2pres&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;co2diff&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;rlpm&#39;</span><span class="p">,</span><span class="s1">&#39;RELATIVE PERMEABILITY&#39;</span><span class="p">),</span>
					 <span class="p">(</span><span class="s1">&#39;tpor&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">),))</span>
<span class="n">macro_descriptor</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="s1">&#39;Initial conditions&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="s1">&#39;Permeability&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="s1">&#39;Thermal conductivity properties&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="s1">&#39;Source or sink&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="s1">&#39;Material properties&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;Initial condition gradients&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">,</span><span class="s1">&#39;Elastic properties&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">,</span><span class="s1">&#39;Body force at node&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">,</span><span class="s1">&#39;Fluid-stress coupling properties&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;co2flow&#39;</span><span class="p">,</span><span class="s1">&#39;CO2 source of sink&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;co2frac&#39;</span><span class="p">,</span><span class="s1">&#39;CO2 fraction&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;co2pres&#39;</span><span class="p">,</span><span class="s1">&#39;CO2 initial conditions&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;co2diff&#39;</span><span class="p">,</span><span class="s1">&#39;CO2 diffusion properties&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="s1">&#39;Stress boundary condition&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;permmodel&#39;</span><span class="p">,</span><span class="s1">&#39;Stress permeability relationship&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">,</span><span class="s1">&#39;Plasticity relationship&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;rlp&#39;</span><span class="p">,</span><span class="s1">&#39;Relative permeablity relationship&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;hflx&#39;</span><span class="p">,</span><span class="s1">&#39;Heat flux boundary condition&#39;</span><span class="p">),</span>
	<span class="p">(</span><span class="s1">&#39;tpor&#39;</span><span class="p">,</span><span class="s1">&#39;Tracer porosity&#39;</span><span class="p">),)</span>
	<span class="p">)</span>
<span class="n">rlpm_dicts</span><span class="o">=</span><span class="nb">dict</span><span class="p">((</span>
	<span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">,{}),</span>
	<span class="p">(</span><span class="s1">&#39;linear&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;exponential&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;maximum_relperm&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;corey&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;brooks-corey&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;vg&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;air_entry_head&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span>
	
	<span class="p">(</span><span class="s1">&#39;linear_cap&#39;</span><span class="p">,((</span><span class="s1">&#39;cap_at_zero_sat&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;sat_at_zero_cap&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;brooks-corey_cap&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;capillary_entry_presure&#39;</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),</span>
				<span class="p">(</span><span class="s1">&#39;low_saturation_fitting&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;cutoff_saturation&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))),</span>
	<span class="p">(</span><span class="s1">&#39;vg_cap&#39;</span><span class="p">,((</span><span class="s1">&#39;minimum_saturation&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="s1">&#39;maximum_saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;air_entry_head&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s1">&#39;exponent&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
				<span class="p">(</span><span class="s1">&#39;low_saturation_fitting&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;cutoff_saturation&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">))),</span>
	<span class="p">))</span>
<span class="n">rlpm_cap1</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;vg_cap&#39;</span><span class="p">,</span><span class="s1">&#39;vg_cap&#39;</span><span class="p">),(</span><span class="s1">&#39;brooks-corey_cap&#39;</span><span class="p">,</span><span class="s1">&#39;brooks-corey&#39;</span><span class="p">),(</span><span class="s1">&#39;linear_cap&#39;</span><span class="p">,</span><span class="s1">&#39;linear_for&#39;</span><span class="p">)))</span>
<span class="n">rlpm_cap2</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="s1">&#39;vg_cap&#39;</span><span class="p">,</span><span class="s1">&#39;vg_cap&#39;</span><span class="p">),(</span><span class="s1">&#39;brooks-corey&#39;</span><span class="p">,</span><span class="s1">&#39;brooks-corey_cap&#39;</span><span class="p">),(</span><span class="s1">&#39;linear_for&#39;</span><span class="p">,</span><span class="s1">&#39;linear_cap&#39;</span><span class="p">)))</span>
<span class="n">rlpm_phases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="s1">&#39;co2_liquid&#39;</span><span class="p">,</span><span class="s1">&#39;co2_gas&#39;</span><span class="p">,</span><span class="s1">&#39;vapor&#39;</span><span class="p">]</span>

<span class="n">buildWarnings</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">_buildWarnings</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
	<span class="k">global</span> <span class="n">buildWarnings</span>
	<span class="n">buildWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_title_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="p">):</span> 						<span class="c1">#prepends headers to sections of FEHM input file</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">n</span><span class="p">:</span> <span class="k">return</span>
	<span class="n">ws</span> <span class="o">=</span> <span class="s1">&#39;# &#39;</span>
	<span class="n">pad</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pad</span><span class="p">):</span> <span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;-&#39;</span>
	<span class="n">ws</span><span class="o">+=</span><span class="n">s</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">pad</span><span class="p">):</span> <span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;-&#39;</span>
	<span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
	<span class="k">return</span> <span class="n">ws</span>
<span class="k">def</span> <span class="nf">_zone_ind</span><span class="p">(</span><span class="n">indStr</span><span class="p">):</span> <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indStr</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indStr</span><span class="p">)</span><span class="o">+</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">indStr</span><span class="p">)))</span><span class="o">/</span><span class="mi">2</span>
<div class="viewcode-block" id="process_output"><a class="viewcode-back" href="../tutorial.html#fdata.process_output">[docs]</a><span class="k">def</span> <span class="nf">process_output</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">hide</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">write</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Runs an FEHM \*.outp file through the diagnostic tool. Writes output files containing simulation balance, </span>
<span class="sd">	   convergence, time stepping information.</span>
<span class="sd">	   </span>
<span class="sd">	   :param filename: Path to the \*.outp file.</span>
<span class="sd">	   :type filename: str</span>
<span class="sd">	   :param input: Path to corresponding FEHM input file .</span>
<span class="sd">	   :type input: str</span>
<span class="sd">	   :param grid: Path to corresponding FEHM grid file.</span>
<span class="sd">	   :type grid: str</span>
<span class="sd">	   :param hide: Suppress diagnostic window (default False).</span>
<span class="sd">	   :type hide: bool</span>
<span class="sd">	   :param silent: Suppress output to the screen (default False).</span>
<span class="sd">	   :type silent: bool</span>
<span class="sd">	   :param write: Write output files (default True).</span>
<span class="sd">	   :type write: bool</span>
<span class="sd">	&quot;&quot;&quot;</span>
	
	<span class="k">if</span> <span class="nb">input</span> <span class="ow">and</span> <span class="n">grid</span><span class="p">:</span> <span class="n">dat</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span><span class="n">gridfilename</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span> 
		<span class="n">dat</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">()</span>
		<span class="n">dat</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="n">hide</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">write</span> <span class="o">=</span> <span class="n">write</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">silent</span> <span class="o">=</span> <span class="n">silent</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">refresh_nodes</span><span class="p">()</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">poll</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">read_with_tcl</span><span class="p">()</span>
	<span class="k">return</span> <span class="n">dat</span><span class="o">.</span><span class="n">_diagnostic</span></div>
<div class="viewcode-block" id="fzone"><a class="viewcode-back" href="../fdata.html#fdata.fzone">[docs]</a><span class="k">class</span> <span class="nc">fzone</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM zone object.</span>
	<span class="sd">&quot;&quot;&quot;FEHM Zone object.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;_index&#39;</span><span class="p">,</span><span class="s1">&#39;_type&#39;</span><span class="p">,</span><span class="s1">&#39;_points&#39;</span><span class="p">,</span><span class="s1">&#39;_file&#39;</span><span class="p">,</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_nodelist&#39;</span><span class="p">,</span><span class="s1">&#39;_file&#39;</span><span class="p">,</span><span class="s1">&#39;_permeability&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_conductivity&#39;</span><span class="p">,</span><span class="s1">&#39;_density&#39;</span><span class="p">,</span><span class="s1">&#39;_specific_heat&#39;</span><span class="p">,</span><span class="s1">&#39;_porosity&#39;</span><span class="p">,</span><span class="s1">&#39;_youngs_modulus&#39;</span><span class="p">,</span><span class="s1">&#39;_poissons_ratio&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_thermal_expansion&#39;</span><span class="p">,</span><span class="s1">&#39;_pressure_coupling&#39;</span><span class="p">,</span><span class="s1">&#39;_Pi&#39;</span><span class="p">,</span><span class="s1">&#39;_Ti&#39;</span><span class="p">,</span><span class="s1">&#39;_Si&#39;</span><span class="p">,</span><span class="s1">&#39;_fixedT&#39;</span><span class="p">,</span><span class="s1">&#39;_fixedP&#39;</span><span class="p">,</span><span class="s1">&#39;_updateFlag&#39;</span><span class="p">,</span><span class="s1">&#39;_silent&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">points</span><span class="o">=</span><span class="p">[],</span><span class="n">nodelist</span><span class="o">=</span><span class="p">[],</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="o">=</span><span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="k">if</span> <span class="n">index</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="o">=</span><span class="p">[]</span>				
		<span class="k">if</span> <span class="n">points</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span><span class="o">=</span><span class="n">points</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>				
		<span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;nnum&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">nodelist</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="n">nodelist</span>
		<span class="k">if</span> <span class="n">file</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>
		<span class="c1"># material properties</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_density</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_specific_heat</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_porosity</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_youngs_modulus</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_poissons_ratio</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_thermal_expansion</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_pressure_coupling</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_fixedT</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_fixedP</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;zn&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
	<span class="k">def</span> <span class="nf">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_index</span><span class="p">,</span><span class="n">_set_index</span><span class="p">)</span> <span class="c1">#: (*int*) Integer number denoting the zone.</span>
	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
		<span class="n">oldtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">!=</span> <span class="n">oldtype</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span><span class="n">_set_type</span><span class="p">)</span>	<span class="c1">#: (*str*) String denoting the zone type. Default is &#39;rect&#39;, alternatives are &#39;list&#39;, &#39;nnum&#39;</span>
	<span class="k">def</span> <span class="nf">_get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
	<span class="k">def</span> <span class="nf">_set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_name</span><span class="p">,</span><span class="n">_set_name</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of the zone. Will appear commented beside the zone definition in the input file. Can be used to index the ``fdata.zone`` attribute.</span>
	<span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
	<span class="k">def</span> <span class="nf">_set_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span><span class="o">=</span><span class="n">value</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_file</span><span class="p">,</span><span class="n">_set_file</span><span class="p">)</span>	<span class="c1">#: (*str*) File name if zone data is or is to be contained in a separate file. If file does not exist, it will be created and written to when the FEHM input file is being written out.</span>
<div class="viewcode-block" id="fzone.rect"><a class="viewcode-back" href="../fdata.html#fdata.fzone.rect">[docs]</a>	<span class="k">def</span> <span class="nf">rect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">):</span> 					<span class="c1">#generates a rectangular zone based on corner coordinates</span>
		<span class="sd">&quot;&quot;&quot;Create a rectangular zone corresponding to the bounding box delimited by p1 and p2.</span>
<span class="sd">		</span>
<span class="sd">		:param p1: coordinate of first corner of the bounding box.</span>
<span class="sd">		:type p1: ndarray</span>
<span class="sd">		:param p2: coordinate of the second corner of the bounding box.</span>
<span class="sd">		:type p2: ndarray</span>
<span class="sd">		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
			<span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span><span class="p">],</span>
						 <span class="p">[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span>
						 <span class="c1">#[0., 0., 0., 0., 0., 0., 0., 0.]</span>
						 <span class="p">]</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
			<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
			<span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
			<span class="n">zmax</span><span class="p">,</span><span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">=</span><span class="p">[[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span><span class="p">],</span>
						 <span class="p">[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span>
						 <span class="p">[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">]]</span></div>
<div class="viewcode-block" id="fzone.fix_temperature"><a class="viewcode-back" href="../fdata.html#fdata.fzone.fix_temperature">[docs]</a>	<span class="k">def</span> <span class="nf">fix_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">multiplier</span><span class="o">=</span><span class="mf">1.e10</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Fixes temperatures at nodes within this zone. Temperatures fixed by adding an HFLX macro with high</span>
<span class="sd">			heat flow multiplier.</span>
<span class="sd">			</span>
<span class="sd">			:param T: Temperature to fix.</span>
<span class="sd">			:type T: fl64</span>
<span class="sd">			:param multiplier: Multiplier for HFLX macro (default = 1.e10)</span>
<span class="sd">			:type multiplier: fl64</span>
<span class="sd">			:param file: Name of auxiliary file to save macro.</span>
<span class="sd">			:type file: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;fix_temperature() only available if zone associated with fdata() object&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;hflx&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;heat_flow&#39;</span><span class="p">,</span><span class="n">T</span><span class="p">),(</span><span class="s1">&#39;multiplier&#39;</span><span class="p">,</span><span class="n">multiplier</span><span class="p">)),</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_fixedT</span> <span class="o">=</span> <span class="n">T</span></div>
<div class="viewcode-block" id="fzone.fix_pressure"><a class="viewcode-back" href="../fdata.html#fdata.fzone.fix_pressure">[docs]</a>	<span class="k">def</span> <span class="nf">fix_pressure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">P</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mf">30.</span><span class="p">,</span> <span class="n">impedance</span><span class="o">=</span><span class="mf">1.e6</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Fixes pressures at nodes within this zone. Pressures fixed by adding a FLOW macro with high</span>
<span class="sd">			impedance.</span>
<span class="sd">			</span>
<span class="sd">			:param P: Pressure to fix. Default is 0, corresponding to fixing initial pressure.</span>
<span class="sd">			:type P: fl64</span>
<span class="sd">			:param T: Temperature to fix (default = 30 degC).</span>
<span class="sd">			:type T: fl64</span>
<span class="sd">			:param impedance: Impedance for FLOW macro (default = 1.e6)</span>
<span class="sd">			:type impedance: fl64</span>
<span class="sd">			:param file: Name of auxiliary file to save macro.</span>
<span class="sd">			:type file: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;fix_pressure() only available if zone associated with fdata() object&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;flow&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span><span class="n">P</span><span class="p">),(</span><span class="s1">&#39;energy&#39;</span><span class="p">,</span><span class="o">-</span><span class="n">T</span><span class="p">),(</span><span class="s1">&#39;impedance&#39;</span><span class="p">,</span><span class="n">impedance</span><span class="p">)),</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_fixedP</span> <span class="o">=</span> <span class="p">[</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">]</span></div>
<div class="viewcode-block" id="fzone.fix_displacement"><a class="viewcode-back" href="../fdata.html#fdata.fzone.fix_displacement">[docs]</a>	<span class="k">def</span> <span class="nf">fix_displacement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="p">,</span><span class="n">displacement</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Fixes displacement at nodes within this zone. Displacements fixed by adding a STRESSBOUN macro.</span>
<span class="sd">			</span>
<span class="sd">			:param direction: Direction in which displacement is fixed. Specify as string or integer, e.g., 1 = &#39;x&#39;, 2 = &#39;y&#39;, 3 = &#39;z&#39;.</span>
<span class="sd">			:type direction: str, int</span>
<span class="sd">			:param displacement: Fixed displacement</span>
<span class="sd">			:type displacement: fl64</span>
<span class="sd">			:param file: Name of auxiliary file to save macro.</span>
<span class="sd">			:type file: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;fix_displacement() only available if zone associated with fdata() object&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span> <span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;direction must be specified as either 1, 2, 3, </span><span class="se">\&#39;</span><span class="s1">x</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">y</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">z</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;direction&#39;</span><span class="p">,</span><span class="n">direction</span><span class="p">),(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">displacement</span><span class="p">)),</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">))</span></div>
<div class="viewcode-block" id="fzone.fix_stress"><a class="viewcode-back" href="../fdata.html#fdata.fzone.fix_stress">[docs]</a>	<span class="k">def</span> <span class="nf">fix_stress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="p">,</span><span class="n">stress</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Fixes displacement at nodes within this zone. Displacements fixed by adding a STRESSBOUN macro.</span>
<span class="sd">			</span>
<span class="sd">			:param direction: Direction in which stress is fixed. Specify as string or integer, e.g., 1 = &#39;x&#39;, 2 = &#39;y&#39;, 3 = &#39;z&#39;.</span>
<span class="sd">			:type direction: str, int</span>
<span class="sd">			:param stress: Fixed stress</span>
<span class="sd">			:type stress: fl64</span>
<span class="sd">			:param file: Name of auxiliary file to save macro.</span>
<span class="sd">			:type file: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;fix_stress() only available if zone associated with fdata() object&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">2</span>
		<span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">3</span>
		<span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">direction</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]:</span> <span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;direction must be specified as either 1, 2, 3, </span><span class="se">\&#39;</span><span class="s1">x</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">y</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">z</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;direction&#39;</span><span class="p">,</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">direction</span><span class="p">)),(</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">stress</span><span class="p">)),</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">))</span></div>
<div class="viewcode-block" id="fzone.roller"><a class="viewcode-back" href="../fdata.html#fdata.fzone.roller">[docs]</a>	<span class="k">def</span> <span class="nf">roller</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Assigns a roller boundary condition to the zone (zero displacement in normal direction).</span>
<span class="sd">			</span>
<span class="sd">			:param direction: Normal of roller. Specify as string or integer, e.g., 1 = &#39;x&#39;, 2 = &#39;y&#39;, 3 = &#39;z&#39;. Defaults to zone normal for &#39;XMIN&#39;, &#39;ZMAX&#39; etc.</span>
<span class="sd">			:type direction: str, int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;XMIN&#39;</span><span class="p">,</span><span class="s1">&#39;XMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;YMIN&#39;</span><span class="p">,</span><span class="s1">&#39;YMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">2</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ZMIN&#39;</span><span class="p">,</span><span class="s1">&#39;ZMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">3</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;no direction specified&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fix_displacement</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span><span class="n">displacement</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span></div>
<div class="viewcode-block" id="fzone.free_surface"><a class="viewcode-back" href="../fdata.html#fdata.fzone.free_surface">[docs]</a>	<span class="k">def</span> <span class="nf">free_surface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">direction</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Assigns a free surface boundary condition to the zone (zero stress in normal direction).</span>
<span class="sd">			</span>
<span class="sd">			:param direction: Normal of free surface. Specify as string or integer, e.g., 1 = &#39;x&#39;, 2 = &#39;y&#39;, 3 = &#39;z&#39;. Defaults to zone normal for &#39;XMIN&#39;, &#39;ZMAX&#39; etc.</span>
<span class="sd">			:type direction: str, int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">direction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;XMIN&#39;</span><span class="p">,</span><span class="s1">&#39;XMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;YMIN&#39;</span><span class="p">,</span><span class="s1">&#39;YMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ZMIN&#39;</span><span class="p">,</span><span class="s1">&#39;ZMAX&#39;</span><span class="p">]:</span> <span class="n">direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;no direction specified&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">fix_stress</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span><span class="n">stress</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span></div>
	<span class="k">def</span> <span class="nf">copy_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">from_zone</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">grid_new</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span><span class="n">grid_old</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Transfer zone information from one grid to another.</span>
<span class="sd">		</span>
<span class="sd">		:param from_zone: Zone object to convert.</span>
<span class="sd">		:type from_zone: fzone</span>
<span class="sd">		:param method: Method for node to node transfer of zone. Options are &#39;nearest&#39;, &#39;volume&#39;.</span>
<span class="sd">		:type method: str</span>
<span class="sd">		</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">grid_new</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">grid_new</span>
		<span class="k">if</span> <span class="n">grid_old</span><span class="p">:</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">grid_old</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">index</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="n">from_zone</span><span class="p">:</span> <span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;No zone supplied&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> 		<span class="c1"># if rectangular zone, copy across bounding box</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;rect&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">points</span>
		<span class="k">else</span><span class="p">:</span> 								<span class="c1"># zone comprises a list of nodes</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">grid</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Supplied zone does not contain grid information.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="n">from_nodes</span> <span class="o">=</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">nodelist</span>
			<span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;nearest&#39;</span><span class="p">:</span>
				<span class="n">ndinds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node_nearest_point</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">from_nodes</span><span class="p">])</span>
				<span class="n">ndinds</span> <span class="o">=</span> <span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">ndinds</span> <span class="k">if</span> <span class="n">nd</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;volume&#39;</span><span class="p">:</span>
				<span class="s1">&#39;a&#39;</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">from_zone</span><span class="o">.</span><span class="n">type</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">ndind</span><span class="p">]</span> <span class="k">for</span> <span class="n">ndind</span> <span class="ow">in</span> <span class="n">ndinds</span><span class="p">]</span>			
<div class="viewcode-block" id="fzone.plot"><a class="viewcode-back" href="../fdata.html#fdata.fzone.plot">[docs]</a>	<span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">angle</span><span class="o">=</span><span class="p">[</span><span class="mi">45</span><span class="p">,</span><span class="mi">45</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">connections</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">equal_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
			<span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / m&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y / m&#39;</span><span class="p">,</span><span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;z / m&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">font_size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">):</span> 		<span class="c1">#generates a 3-D plot of the zone.</span>
		<span class="sd">&#39;&#39;&#39;Generates and saves a 3-D plot of the zone.</span>
<span class="sd">		</span>
<span class="sd">		:param save: Name of saved zone image.</span>
<span class="sd">		:type save: str</span>
<span class="sd">		:param angle: 	View angle of zone. First number is azimuth angle in degrees, second number is tilt. Alternatively, if angle is &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, view is aligned along the corresponding axis.</span>
<span class="sd">		:type angle: [fl64,fl64], str</span>
<span class="sd">		:param color: Colour of zone.</span>
<span class="sd">		:type color: str, [fl64,fl64,fl64]</span>
<span class="sd">		:param connections: Plot connections. If ``True`` all connections plotted. If between 0 and 1, random proportion plotted. If greater than 1, specified number plotted.</span>
<span class="sd">		:type connections: bool</span>
<span class="sd">		:param equal_axes: Force plotting with equal aspect ratios for all axes.</span>
<span class="sd">		:type equal_axes: bool</span>
<span class="sd">		</span>
<span class="sd">		:param xlabel: Label on x-axis.</span>
<span class="sd">		:type xlabel: str</span>
<span class="sd">		:param ylabel: Label on y-axis.</span>
<span class="sd">		:type ylabel: str</span>
<span class="sd">		:param zlabel: Label on z-axis.</span>
<span class="sd">		:type zlabel: str</span>
<span class="sd">		:param title: Title of plot.</span>
<span class="sd">		:type title: str</span>
<span class="sd">		</span>
<span class="sd">		:param font_size: Size of text on plot.</span>
<span class="sd">		:type font_size: str, int</span>
<span class="sd">		 </span>
<span class="sd">		*Example:*</span>
<span class="sd">		</span>
<span class="sd">		``zn.plot(save=&#39;myzone.png&#39;, angle = [45,45], xlabel = &#39;x / m&#39;, font_size = &#39;small&#39;, color = &#39;r&#39;)``</span>
<span class="sd">		 </span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">save</span> <span class="o">=</span> <span class="n">os_path</span><span class="p">(</span><span class="n">save</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">angle</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">angle</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">angle</span> <span class="o">==</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">angle</span> <span class="o">=</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">plotBoundingBox</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">plotZoneBox</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">plotBoundingBox</span> <span class="o">=</span> <span class="kc">True</span>	
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> <span class="n">plotZoneBox</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="c1"># plot bounding box</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
		<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">8.275</span><span class="p">,</span><span class="mf">11.7</span><span class="p">])</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
		
		<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="n">zlabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
			<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
			<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_zticklabels</span><span class="p">():</span>
			<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
		
		<span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmax</span>
		<span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymax</span>
		<span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmax</span>
		
		<span class="k">if</span> <span class="n">equal_axes</span><span class="p">:</span>
			<span class="n">MAX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">,</span><span class="n">zmax</span><span class="o">-</span><span class="n">zmin</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
			<span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xmin</span><span class="o">+</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymin</span><span class="o">+</span><span class="n">ymax</span><span class="p">,</span><span class="n">zmin</span><span class="o">+</span><span class="n">zmax</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
			<span class="k">for</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">direction</span> <span class="o">*</span> <span class="n">MAX</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])):</span>
					<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">C</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">point</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">C</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">angle</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">angle</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		
		<span class="k">if</span> <span class="n">plotBoundingBox</span><span class="p">:</span>
				<span class="c1"># x lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
				<span class="c1"># y lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
				<span class="c1"># z lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="s1">&#39;k--&#39;</span><span class="p">)</span>
		<span class="c1"># plot node connections</span>
		<span class="k">if</span> <span class="n">connections</span><span class="p">:</span>
			<span class="n">conns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">nb</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">nb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
						<span class="n">p1</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">position</span>
						<span class="n">p2</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">position</span>
						<span class="n">conns</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">))</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">connections</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>		<span class="c1"># plot all connections</span>
				<span class="k">if</span> <span class="n">connections</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">connections</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span> 	<span class="c1"># plot proportion of connections</span>
					<span class="n">connections</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">conns</span><span class="p">)</span><span class="o">*</span><span class="n">connections</span><span class="p">)</span>
				<span class="n">connections</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">connections</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">conns</span><span class="p">)])</span>
			<span class="kn">import</span> <span class="nn">random</span>
			<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">conns</span><span class="p">)</span>
			<span class="n">conns</span> <span class="o">=</span> <span class="n">conns</span><span class="p">[:</span><span class="n">connections</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="ow">in</span> <span class="n">conns</span><span class="p">:</span>
				<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>								<span class="c1"># plot some connections</span>
		<span class="c1"># plot nodes</span>
		<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span> 
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],],[</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">],],[</span><span class="n">node</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">],],</span>
			<span class="n">markerfacecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>		
		<span class="k">if</span> <span class="n">plotZoneBox</span><span class="p">:</span>
			<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">zmax</span><span class="p">,</span><span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
				<span class="c1"># x lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
				<span class="c1"># y lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmin</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmax</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
				<span class="c1"># z lines</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmin</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymax</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
			<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">xmax</span><span class="p">,</span><span class="n">xmax</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymin</span><span class="p">],[</span><span class="n">zmin</span><span class="p">,</span><span class="n">zmax</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>			
		
		<span class="n">extension</span><span class="p">,</span> <span class="n">save_fname</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">=</span> <span class="n">save_name</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;zone&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">),</span><span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span> 
		<span class="nb">format</span><span class="o">=</span><span class="n">extension</span><span class="p">,</span><span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">pdf</span><span class="p">:</span> 
			<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;epstopdf &#39;</span> <span class="o">+</span> <span class="n">save_fname</span><span class="p">)</span>
			<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">save_fname</span><span class="p">)</span>			</div>
<div class="viewcode-block" id="fzone.topo"><a class="viewcode-back" href="../fdata.html#fdata.fzone.topo">[docs]</a>	<span class="k">def</span> <span class="nf">topo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">save</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">cbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">equal_axes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">divisions</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span> <span class="n">xlims</span><span class="o">=</span><span class="p">[],</span>
			<span class="n">ylims</span><span class="o">=</span><span class="p">[],</span> <span class="n">clims</span><span class="o">=</span><span class="p">[],</span> <span class="n">levels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">clabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
			<span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x / m&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y / m&#39;</span><span class="p">,</span><span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;z / m&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">font_size</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">):</span> 		<span class="c1">#generates a 2-D topographical plot of the zone.</span>
		<span class="sd">&#39;&#39;&#39;Returns a contour plot of the top surface of the zone.</span>
<span class="sd">		</span>
<span class="sd">		:param divisions: Resolution to supply mesh data.</span>
<span class="sd">		:type divisions: [int,int]</span>
<span class="sd">		:param method: Method of interpolation, options are &#39;nearest&#39;, &#39;linear&#39;.</span>
<span class="sd">		:type method: str</span>
<span class="sd">		:param levels: Contour levels to plot. Can specify specific levels in list form, or a single integer indicating automatic assignment of levels. </span>
<span class="sd">		:type levels: lst[fl64], int</span>
<span class="sd">		:param cbar: Add colour bar to plot.</span>
<span class="sd">		:param type: bool</span>
<span class="sd">		:param xlims: Plot limits on x-axis.</span>
<span class="sd">		:type xlims: [fl64, fl64]</span>
<span class="sd">		:param ylims: Plot limits on y-axis.</span>
<span class="sd">		:type ylims: [fl64, fl64]</span>
<span class="sd">		:param clims: Colour limits. </span>
<span class="sd">		:type clims: [fl64,fl64]</span>
<span class="sd">		:param save: Name to save plot. Format specified extension (default .png if none give). Supported extensions: .png, .eps, .pdf.</span>
<span class="sd">		:type save: str</span>
<span class="sd">		:param xlabel: Label on x-axis.</span>
<span class="sd">		:type xlabel: str</span>
<span class="sd">		:param ylabel: Label on y-axis.</span>
<span class="sd">		:type ylabel: str</span>
<span class="sd">		:param title: Plot title.</span>
<span class="sd">		:type title: str</span>
<span class="sd">		:param font_size: Specify text size, either as an integer or string, e.g., 10, &#39;small&#39;, &#39;x-large&#39;.</span>
<span class="sd">		:type font_size: str, int</span>
<span class="sd">		:param equal_axes: Specify equal scales on axes.</span>
<span class="sd">		:type equal_axes: bool</span>
<span class="sd">		</span>
<span class="sd">		*Example:*</span>
<span class="sd">		</span>
<span class="sd">		``dat.zone[2].topo(&#39;zoneDEMtopo.png&#39;,method = &#39;linear&#39;)``</span>
<span class="sd">		</span>
<span class="sd">		&#39;&#39;&#39;</span>	
		<span class="n">save</span> <span class="o">=</span> <span class="n">os_path</span><span class="p">(</span><span class="n">save</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: No node information, aborting...&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">title</span><span class="p">:</span> 
			<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Topographic plot of zone &#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">title</span> <span class="o">+=</span> <span class="s1">&#39;: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span>
		<span class="c1"># assemble data</span>
		<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
		<span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
		<span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">xs</span><span class="p">);</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
		<span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ys</span><span class="p">);</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span>		
		<span class="n">xrange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">divisions</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">yrange</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">divisions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="n">XI</span><span class="p">,</span><span class="n">YI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">)</span>
		<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xrange</span><span class="p">,</span><span class="n">yrange</span><span class="p">)</span>
		
		<span class="n">ZI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)))</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmin</span><span class="o">-</span><span class="mi">1</span>
		<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
			<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">xs</span><span class="o">==</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ys</span><span class="o">==</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">ZI</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">ZI</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
		
		<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="n">X</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
		<span class="n">ptsI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">XI</span><span class="p">,</span><span class="n">YI</span><span class="p">,</span><span class="n">ZI</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="n">XI</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
		
		<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">griddata</span>
		<span class="n">vals</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">ptsI</span><span class="p">[:,:</span><span class="mi">2</span><span class="p">],</span><span class="n">ptsI</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">pts</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
		<span class="n">vals</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">vals</span><span class="p">,(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
		
		<span class="c1"># plot topo</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
		<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mf">8.275</span><span class="p">,</span><span class="mf">11.7</span><span class="p">])</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">xlims</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlims</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ylims</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylims</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">equal_axes</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
		<span class="n">CS</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">vals</span><span class="p">,</span><span class="n">levels</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">clims</span><span class="p">:</span> <span class="n">CS</span><span class="o">.</span><span class="n">vmin</span><span class="o">=</span><span class="n">clims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">CS</span><span class="o">.</span><span class="n">vmax</span><span class="o">=</span><span class="n">clims</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">xlabel</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>		
		<span class="k">if</span> <span class="n">ylabel</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">title</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">cbar</span><span class="p">:</span>			
			<span class="n">cbar</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">CS</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
				<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
			<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
			<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">font_size</span><span class="p">)</span>
					
		<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>
		<span class="n">extension</span><span class="p">,</span> <span class="n">save_fname</span><span class="p">,</span> <span class="n">pdf</span> <span class="o">=</span> <span class="n">save_name</span><span class="p">(</span><span class="n">save</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;zone_topo&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">),</span><span class="n">time</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fname</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;portrait&#39;</span><span class="p">,</span> 
		<span class="nb">format</span><span class="o">=</span><span class="n">extension</span><span class="p">,</span><span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></div>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Print details of the zone to the screen.&quot;&quot;&quot;</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="s1">&#39;Zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Geometric properties.......</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
			<span class="n">ws</span> <span class="o">+=</span>  <span class="s1">&#39;  Type: rectangular box</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Contains &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; nodes</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span><span class="o">==</span><span class="mi">24</span><span class="p">:</span> <span class="n">pts</span><span class="o">=</span><span class="n">pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">pts</span> <span class="o">=</span> <span class="n">pts</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>			
			<span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">0</span><span class="p">,:])</span>
			<span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">1</span><span class="p">,:])</span>
			<span class="k">if</span> <span class="n">pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[</span><span class="mi">2</span><span class="p">,:])</span>
				<span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">dz</span> <span class="o">=</span> <span class="p">[</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">,</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">,</span><span class="n">zmax</span><span class="o">-</span><span class="n">zmin</span><span class="p">]</span>
				<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  dimensions: [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dy</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>
				<span class="k">if</span> <span class="mi">100</span><span class="o">*</span><span class="n">dz</span><span class="o">&lt;</span><span class="n">dx</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dz</span><span class="o">&lt;</span><span class="n">dy</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (plane at z = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">zmin</span><span class="o">+</span><span class="n">zmax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">elif</span> <span class="mi">100</span><span class="o">*</span><span class="n">dx</span><span class="o">&lt;</span><span class="n">dy</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dx</span><span class="o">&lt;</span><span class="n">dz</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (plane at x = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">xmin</span><span class="o">+</span><span class="n">xmax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">elif</span> <span class="mi">100</span><span class="o">*</span><span class="n">dy</span><span class="o">&lt;</span><span class="n">dz</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dy</span><span class="o">&lt;</span><span class="n">dz</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (plane at y = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ymin</span><span class="o">+</span><span class="n">ymax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">elif</span> <span class="mi">100</span><span class="o">*</span><span class="n">dz</span><span class="o">&lt;</span><span class="n">dx</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dy</span><span class="o">&lt;</span><span class="n">dx</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (column at x = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">xmin</span><span class="o">+</span><span class="n">xmax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">elif</span> <span class="mi">100</span><span class="o">*</span><span class="n">dx</span><span class="o">&lt;</span><span class="n">dy</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dz</span><span class="o">&lt;</span><span class="n">dy</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (column at y = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ymin</span><span class="o">+</span><span class="n">ymax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">elif</span> <span class="mi">100</span><span class="o">*</span><span class="n">dx</span><span class="o">&lt;</span><span class="n">dz</span> <span class="ow">and</span> <span class="mi">100</span><span class="o">*</span><span class="n">dy</span><span class="o">&lt;</span><span class="n">dz</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  (column at z = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">zmin</span><span class="o">+</span><span class="n">zmax</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  x-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xmin</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xmax</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  y-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ymin</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ymax</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="n">pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  z-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zmin</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zmax</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
				<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  mid-point: [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">xmin</span><span class="o">+</span><span class="n">xmax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ymin</span><span class="o">+</span><span class="n">ymax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">zmin</span><span class="o">+</span><span class="n">zmax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">elif</span> <span class="n">pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span><span class="mi">1</span><span class="p">:</span>
				<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  mid-point: [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">xmin</span><span class="o">+</span><span class="n">xmax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ymin</span><span class="o">+</span><span class="n">ymax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;]</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
			<span class="c1">#ws = &#39;Zone &#39;+str(self.index)+&#39;\n&#39;</span>
			<span class="c1">#ws+=&#39;\nGeometric properties.......\n&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span>  <span class="s1">&#39;  Type: list</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Contains &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; nodes</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">pts</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  x-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  y-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  z-range: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  mid-point: [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;]</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="n">pts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">:</span>
				<span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;  points: [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]</span><span class="se">\n</span><span class="s1">&#39;</span>			
				<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
					<span class="n">ws</span><span class="o">+=</span><span class="s1">&#39;        [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]</span><span class="se">\n</span><span class="s1">&#39;</span>			
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;nnum&#39;</span><span class="p">:</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Type: nnum (list of nodes)</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Contains &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39; nodes</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Background zone (denoted 1 0 0), encompassing all nodes.</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span>
		
		<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Material properties........</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  permeability...... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_permeability</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  conductivity...... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_conductivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  density........... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_density</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specific_heat</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  specific heat..... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specific_heat</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_porosity</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  porosity.......... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_porosity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_youngs_modulus</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Youngs modulus.... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_youngs_modulus</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poissons_ratio</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  Poissons ratio.... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_poissons_ratio</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thermal_expansion</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  thermal expansion. &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_thermal_expansion</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pressure_coupling</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  pressure coupling. &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pressure_coupling</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Initial conditions.........</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  pressure.......... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  temperature....... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Si</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  saturation........ &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Si</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Boundary conditions........</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fixedT</span><span class="p">:</span> <span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  fixed temperature.... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixedT</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fixedP</span><span class="p">:</span> 
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;  fixed pressure....... &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixedP</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">ws</span> <span class="o">+=</span> <span class="s1">&#39;    inflow temperature. &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixedP</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="nb">print</span> <span class="n">ws</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span> 				<span class="c1">#: Print to screen information about the zone.</span>
	<span class="k">def</span> <span class="nf">_get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Assemble a list of fnode objects contained in the zone.&quot;&quot;&quot;</span>
		<span class="n">nds</span>  <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="n">nds</span><span class="p">;</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span>
			<span class="n">xmax</span><span class="p">,</span><span class="n">xmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
				<span class="n">zmax</span><span class="p">,</span><span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">zmax</span><span class="p">,</span><span class="n">zmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">zmax</span><span class="o">+.</span><span class="mi">01</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">zmin</span><span class="o">-.</span><span class="mi">01</span>
			<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">_position</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
			<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x</span><span class="o">&lt;=</span><span class="n">xmax</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">xmin</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">ymax</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">y</span><span class="o">&gt;=</span><span class="n">ymin</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">z</span><span class="o">&lt;=</span><span class="n">zmax</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">z</span><span class="o">&gt;=</span><span class="n">zmin</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_grid</span><span class="o">.</span><span class="n">_nodelist</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span>
	<span class="k">def</span> <span class="nf">_set_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: nodelist for zone defined by content of points.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">nodelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nodes</span><span class="p">,</span><span class="n">_set_nodes</span><span class="p">)</span>	<span class="c1">#: (*lst[fnode]*) List of nodes contained within the zone.</span>
	<span class="k">def</span> <span class="nf">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">nd</span><span class="p">)</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
	<span class="n">node</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_node</span><span class="p">)</span> <span class="c1">#: (*dict[fnode]*) Dictionary of nodes contained within the zone, indexed by node number.</span>
	<span class="k">def</span> <span class="nf">_get_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="sd">&quot;&quot;&quot;Assemble spatial data as it would appear in an FEHM input file.&quot;&quot;&quot;</span>
		<span class="n">pts</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;nnum&#39;</span><span class="p">,</span><span class="s1">&#39;list&#39;</span><span class="p">]:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">pts</span><span class="p">;</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>
			<span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;nnum&#39;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">]</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
				<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;nnum&#39;</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">);</span> <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">if</span> <span class="n">row</span> <span class="o">!=</span> <span class="p">[]:</span> <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">pts</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_points</span>		
	<span class="k">def</span> <span class="nf">_set_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;list&#39;</span><span class="p">,</span><span class="s1">&#39;nnum&#39;</span><span class="p">]:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: points defined by content of nodelist.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_points</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">points</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_points</span><span class="p">,</span><span class="n">_set_points</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Spatial data defining the zone.</span>
	<span class="k">def</span> <span class="nf">_get_permeability</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permeability</span>
	<span class="k">def</span> <span class="nf">_set_permeability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">=</span> <span class="n">value</span>
		<span class="c1"># set commands</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span> <span class="n">kx</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="n">ky</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="n">kz</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span> <span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">perm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kx</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ky</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kz</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="n">kx</span><span class="p">),(</span><span class="s1">&#39;ky&#39;</span><span class="p">,</span><span class="n">ky</span><span class="p">),(</span><span class="s1">&#39;kz&#39;</span><span class="p">,</span><span class="n">kz</span><span class="p">))))</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">permeability</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
					<span class="n">nd</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span><span class="p">])</span>
	<span class="n">permeability</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_permeability</span><span class="p">,</span> <span class="n">_set_permeability</span><span class="p">)</span> <span class="c1">#: (*fl64*,*lst*) Permeability properties of zone.</span>
	<span class="k">def</span> <span class="nf">_get_conductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conductivity</span>
	<span class="k">def</span> <span class="nf">_set_conductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">=</span> <span class="n">value</span>
		<span class="c1"># set commands</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span> <span class="n">kx</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="n">ky</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="n">kz</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span> <span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">cond</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kx</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_y&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ky</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_z&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">kz</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;cond_x&#39;</span><span class="p">,</span><span class="n">kx</span><span class="p">),(</span><span class="s1">&#39;cond_y&#39;</span><span class="p">,</span><span class="n">ky</span><span class="p">),(</span><span class="s1">&#39;cond_z&#39;</span><span class="p">,</span><span class="n">kz</span><span class="p">))))</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">conductivity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
					<span class="n">nd</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span><span class="p">])</span>
	<span class="n">conductivity</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_conductivity</span><span class="p">,</span> <span class="n">_set_conductivity</span><span class="p">)</span> <span class="c1">#: (*fl64*,*lst*) Conductivity properties of zone.</span>
	<span class="k">def</span> <span class="nf">_set_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">prop0</span><span class="p">,</span><span class="n">props</span><span class="p">,</span><span class="n">macro</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">prop0</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
				
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		
		<span class="c1"># macro creation/modification</span>
		<span class="n">ks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">macro</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">prop0</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span><span class="o">=</span><span class="n">value</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">params</span> <span class="o">=</span> <span class="p">[(</span><span class="n">prop0</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">value</span><span class="p">)]</span>
			<span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
				<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">dflt</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="n">macro</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">params</span><span class="p">)))</span>
			<span class="n">warn_string</span> <span class="o">=</span> <span class="s1">&#39;WARNING: Assigning default &#39;</span>
			<span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
				<span class="n">warn_string</span> <span class="o">+=</span> <span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">+</span><span class="s1">&#39; (</span><span class="si">%6.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">dflt</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span><span class="o">+</span><span class="s1">&#39;), &#39;</span>
			<span class="n">warn_string</span> <span class="o">=</span> <span class="n">warn_string</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; to zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="n">warn_string</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">dflt</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">prop</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
		
		<span class="c1"># node association</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">zonelist</span><span class="p">])</span><span class="o">-</span><span class="nb">set</span><span class="p">([</span><span class="mi">994</span><span class="p">,</span><span class="mi">995</span><span class="p">,</span><span class="mi">996</span><span class="p">,</span><span class="mi">997</span><span class="p">,</span><span class="mi">998</span><span class="p">,</span><span class="mi">999</span><span class="p">]))</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">nd</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">prop0</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>		
				<span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">])</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>				
					<span class="n">nd</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">prop0</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>			
				<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]):</span>
					<span class="n">nd</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">prop0</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density</span>
	<span class="k">def</span> <span class="nf">_set_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_density&#39;</span><span class="p">,[</span><span class="s1">&#39;_specific_heat&#39;</span><span class="p">,</span><span class="s1">&#39;_porosity&#39;</span><span class="p">],</span><span class="s1">&#39;rock&#39;</span><span class="p">)</span>
	<span class="n">density</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_density</span><span class="p">,</span> <span class="n">_set_density</span><span class="p">)</span> <span class="c1">#: (*fl64*) 	Density of zone.</span>
	<span class="k">def</span> <span class="nf">_get_specific_heat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specific_heat</span>
	<span class="k">def</span> <span class="nf">_set_specific_heat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_specific_heat&#39;</span><span class="p">,[</span><span class="s1">&#39;_density&#39;</span><span class="p">,</span><span class="s1">&#39;_porosity&#39;</span><span class="p">],</span><span class="s1">&#39;rock&#39;</span><span class="p">)</span>
	<span class="n">specific_heat</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_specific_heat</span><span class="p">,</span> <span class="n">_set_specific_heat</span><span class="p">)</span> <span class="c1">#: (*fl64*) Specific heat of zone.</span>
	<span class="k">def</span> <span class="nf">_get_porosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_porosity</span>
	<span class="k">def</span> <span class="nf">_set_porosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_porosity&#39;</span><span class="p">,[</span><span class="s1">&#39;_density&#39;</span><span class="p">,</span><span class="s1">&#39;_specific_heat&#39;</span><span class="p">],</span><span class="s1">&#39;rock&#39;</span><span class="p">)</span>
	<span class="n">porosity</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_porosity</span><span class="p">,</span> <span class="n">_set_porosity</span><span class="p">)</span> <span class="c1">#: (*fl64*) Porosity of zone.</span>
	<span class="k">def</span> <span class="nf">_get_youngs_modulus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_youngs_modulus</span>
	<span class="k">def</span> <span class="nf">_set_youngs_modulus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_youngs_modulus&#39;</span><span class="p">,[</span><span class="s1">&#39;_poissons_ratio&#39;</span><span class="p">],</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span>
	<span class="n">youngs_modulus</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_youngs_modulus</span><span class="p">,</span> <span class="n">_set_youngs_modulus</span><span class="p">)</span> <span class="c1">#: (*fl64*) Young&#39;s modulus of zone.</span>
	<span class="k">def</span> <span class="nf">_get_poissons_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poissons_ratio</span>
	<span class="k">def</span> <span class="nf">_set_poissons_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_poissons_ratio&#39;</span><span class="p">,[</span><span class="s1">&#39;_youngs_modulus&#39;</span><span class="p">],</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span>
	<span class="n">poissons_ratio</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_poissons_ratio</span><span class="p">,</span> <span class="n">_set_poissons_ratio</span><span class="p">)</span> <span class="c1">#: (*fl64*) Poisson&#39;s ratio of zone.</span>
	<span class="k">def</span> <span class="nf">_get_thermal_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_thermal_expansion</span>
	<span class="k">def</span> <span class="nf">_set_thermal_expansion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_thermal_expansion&#39;</span><span class="p">,[</span><span class="s1">&#39;_pressure_coupling&#39;</span><span class="p">],</span><span class="s1">&#39;biot&#39;</span><span class="p">)</span>
	<span class="n">thermal_expansion</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_thermal_expansion</span><span class="p">,</span> <span class="n">_set_thermal_expansion</span><span class="p">)</span> <span class="c1">#: (*fl64*) Coefficient of thermal expansion of zone.</span>
	<span class="k">def</span> <span class="nf">_get_pressure_coupling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pressure_coupling</span>
	<span class="k">def</span> <span class="nf">_set_pressure_coupling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_set_property</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="s1">&#39;_pressure_coupling&#39;</span><span class="p">,[</span><span class="s1">&#39;_thermal_expansion&#39;</span><span class="p">],</span><span class="s1">&#39;biot&#39;</span><span class="p">)</span>
	<span class="n">pressure_coupling</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_pressure_coupling</span><span class="p">,</span> <span class="n">_set_pressure_coupling</span><span class="p">)</span> <span class="c1">#: (*fl64*) Pressure coupling term of zone.</span>
	<span class="k">def</span> <span class="nf">_get_Pi</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span>
	<span class="k">def</span> <span class="nf">_set_Pi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">value</span>
		<span class="c1"># set commands</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">value</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">Ti</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Assigning default initial temperature (</span><span class="si">%4.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">dflt</span><span class="o">.</span><span class="n">Ti</span><span class="o">+</span><span class="s1">&#39; degC, fully saturated liquid) to zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Ti</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">Ti</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ti</span> <span class="o">&gt;</span> <span class="n">tsat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Si</span> <span class="o">=</span> <span class="mf">0.</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">Si</span> <span class="o">=</span> <span class="mf">1.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">Pi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
					<span class="n">nd</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">Pi</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_Pi</span><span class="p">,</span> <span class="n">_set_Pi</span><span class="p">)</span> <span class="c1">#: (*fl64*) Initial pressure in zone.</span>
	<span class="k">def</span> <span class="nf">_get_Ti</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span>
	<span class="k">def</span> <span class="nf">_set_Ti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">value</span>
		<span class="c1"># set commands</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">value</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Assigning default initial pressure (</span><span class="si">%4.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="o">+</span><span class="s1">&#39; MPa, fully saturated liquid) to zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">&gt;</span> <span class="n">tsat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="mf">0.</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="mf">1.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">Ti</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
					<span class="n">nd</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">Ti</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_Ti</span><span class="p">,</span> <span class="n">_set_Ti</span><span class="p">)</span> <span class="c1">#: (*fl64*) Initial temperature in zone.</span>
	<span class="k">def</span> <span class="nf">_get_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Si</span>
	<span class="k">def</span> <span class="nf">_set_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="n">value</span>
		<span class="c1"># set commands</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Zone not associated with input file, no macro changes made.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_updateFlag</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">value</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">value</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">))))</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Assigning default initial pressure (</span><span class="si">%4.1f</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="o">+</span><span class="s1">&#39; MPa, two phase) to zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">tsat</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">Si</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span> 
					<span class="n">nd</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">Si</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_Si</span><span class="p">,</span> <span class="n">_set_Si</span><span class="p">)</span> <span class="c1">#: (*fl64*) Initial saturation in zone.</span>
	<span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># if file called for but non-existant on disk, print warning</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; type not assigned.&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; points array is empty.&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="fmacro"><a class="viewcode-back" href="../fdata.html#fdata.fmacro">[docs]</a><span class="k">class</span> <span class="nc">fmacro</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM macro object</span>
	<span class="sd">&quot;&quot;&quot;FEHM macro object.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_type&#39;</span><span class="p">,</span><span class="s1">&#39;_param&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_zone&#39;</span><span class="p">,</span><span class="s1">&#39;_subtype&#39;</span><span class="p">,</span><span class="s1">&#39;_file&#39;</span><span class="p">,</span><span class="s1">&#39;_write_one_macro&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="p">[],</span><span class="n">param</span><span class="o">=</span><span class="p">[],</span><span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">write_one_macro</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span> 		
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;stressboun&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">subtype</span><span class="p">:</span> <span class="n">subtype</span> <span class="o">=</span> <span class="s1">&#39;fixed&#39;</span>
		<span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;bodyforce&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">subtype</span><span class="p">:</span> <span class="n">subtype</span> <span class="o">=</span> <span class="s1">&#39;force&#39;</span>
		<span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;stressboun&#39;</span><span class="p">:</span> <span class="n">write_one_macro</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="kc">None</span> 		
		<span class="bp">self</span><span class="o">.</span><span class="n">_check_type</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_assign_param</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_param2</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="p">[]</span>			
		<span class="k">if</span> <span class="n">zone</span> <span class="o">!=</span> <span class="p">[]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_subtype</span> <span class="o">=</span> <span class="n">subtype</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_check_zone</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_one_macro</span> <span class="o">=</span> <span class="n">write_one_macro</span>
	<span class="k">def</span> <span class="nf">_assign_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="sd">&#39;&#39;&#39;Assign parameters if supplied on initialisation.&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">macro_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">])</span>
	<span class="k">def</span> <span class="nf">_set_param2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Assign keys in param attribute appropriate to specific macro.&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">par</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">macro_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">par</span>
	<span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Determine if macro is supported.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="k">return</span> <span class="kc">None</span>
	<span class="k">def</span> <span class="nf">_check_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Determine if zone definitions are acceptable.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="k">return</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fnode</span><span class="p">):</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">;</span> <span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">])</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
			<span class="n">newlist</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="n">newlist</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="k">return</span>
		<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">;</span> <span class="k">return</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">prntStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span><span class="s1">&#39;: &#39;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span> 
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; ,&#39;</span>
			<span class="n">prntStr</span> <span class="o">=</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>	<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;)&#39;</span>
		<span class="k">return</span> <span class="n">prntStr</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span> 
		<span class="n">oldtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span>
		<span class="k">if</span> <span class="n">oldtype</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">macro_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">])</span>
	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span><span class="n">_set_type</span><span class="p">)</span><span class="c1">#: (*str*) Name of the macro. Macro names are identical to those invoked in FEHM.</span>
	<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span>
	<span class="k">def</span> <span class="nf">_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">param</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_param</span><span class="p">,</span> <span class="n">_set_param</span><span class="p">)</span> <span class="c1">#: (*dict[fl64]*) A dictionary of values defining the operation of the macro. See table below for macro-specific dictionary keys.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span><span class="n">_set_zone</span><span class="p">)</span><span class="c1">#: (*fzone, lst[fzone], tuple[int,int,int], zone key*) The zone, zones or nodes to which the macro is assigned. Note, only permmodel and rlp can be assigned lists of zones. Optionally, a key (index or string) may be passed, in which case the zone will be retrieved when the macro is added to the model.</span>
	<span class="k">def</span> <span class="nf">_get_subtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subtype</span>
	<span class="k">def</span> <span class="nf">_set_subtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_subtype</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;stressboun&#39;</span><span class="p">,</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">]:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: subtype ignored unless macro is stressboun or bodyforce&#39;</span><span class="p">)</span>
	<span class="n">subtype</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_subtype</span><span class="p">,</span><span class="n">_set_subtype</span><span class="p">)</span>	<span class="c1">#: (*str*) Macro subtype, required for **STRESSBOUN**  or **BODYFORCE** macros.</span>
	<span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
	<span class="k">def</span> <span class="nf">_set_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_file</span><span class="p">,</span><span class="n">_set_file</span><span class="p">)</span><span class="c1">#: (*str*) File string where information about the macro is stored. If file does not currently exist, it will be created and written to when the FEHM input file is written.</span>
	<span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># if not zone assigned, apply default background</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Macro &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; has no zone assigned.&#39;</span><span class="p">)</span>
		<span class="c1"># if parameter value not assigned, print warning</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Macro &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">&#39; not assigned.&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">macro_descriptor</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="c1"># print zone info</span>
		<span class="n">zns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zns</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Assigned to zone &#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zns</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zns</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Assigned to zones &#39;</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span> 
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>	<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;), &#39;</span>
			<span class="n">prntStr</span> <span class="o">=</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zns</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Assigned to node set (&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zns</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>	<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zns</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zns</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;).</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="c1"># print parameter info</span>
		<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Parameters: </span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: Not assigned</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;    &#39;</span> <span class="o">+</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;stressboun&#39;</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_more_info_stressboun</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;flow&#39;</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_more_info_flow</span><span class="p">()</span>
		<span class="nb">print</span> <span class="n">prntStr</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span>		<span class="c1">#: Return a summary of the macros function.</span>
	<span class="k">def</span> <span class="nf">_more_info_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Return additional information about flow macro.&#39;&#39;&#39;</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>	
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass production at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass production against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; MPa&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MJ/kg fluid at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
				<span class="k">else</span><span class="p">:</span><span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MJ/kg fluid against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; MPa&#39;</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; degC fluid at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
				<span class="k">else</span><span class="p">:</span><span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; degC fluid against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; MPa&#39;</span>
		<span class="k">return</span> <span class="n">prntStr</span>
	<span class="k">def</span> <span class="nf">_more_info_stressboun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Return additional information about stressboun macro.&#39;&#39;&#39;</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="n">strsDirs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;x-dir&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;y-dir&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;z-dir&#39;</span><span class="p">)])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span><span class="o">==</span><span class="s1">&#39;lithograd&#39;</span><span class="p">:</span> 
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;lithograd, &#39;</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;stress grad = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; MPa/m&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;distributed&#39;</span><span class="p">:</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">+</span><span class="s1">&#39; force, &#39;</span>	
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39; MPa&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;lithostatic&#39;</span><span class="p">:</span>
			<span class="n">prntStr</span> <span class="o">+=</span><span class="s1">&#39;not done!&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;fixed disp, &#39;</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;fixed force, &#39;</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;m&#39;</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;MPa&#39;</span>
		<span class="k">return</span> <span class="n">prntStr</span></div>
<div class="viewcode-block" id="fmodel"><a class="viewcode-back" href="../fdata.html#fdata.fmodel">[docs]</a><span class="k">class</span> <span class="nc">fmodel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM model object.</span>
	<span class="sd">&#39;&#39;&#39;Model object, used in a variety of macro definitions.</span>
<span class="sd">	</span>
<span class="sd">	Model objects should have:</span>
<span class="sd">		- a type for the macro</span>
<span class="sd">		- a list of zones to which the model is assigned.</span>
<span class="sd">		- an index for the specific model.</span>
<span class="sd">		- a dictionary of parameters for the model.	</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_type&#39;</span><span class="p">,</span><span class="s1">&#39;_param&#39;</span><span class="p">,</span><span class="s1">&#39;_index&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_zonelist&#39;</span><span class="p">,</span><span class="s1">&#39;_zone&#39;</span><span class="p">,</span><span class="s1">&#39;_file&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">zonelist</span><span class="o">=</span><span class="p">[],</span><span class="n">param</span><span class="o">=</span><span class="p">[],</span><span class="n">index</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span> 	
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="kc">None</span> 		
		<span class="bp">self</span><span class="o">.</span><span class="n">_check_type</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="kc">None</span>	
		<span class="k">if</span> <span class="n">index</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_assign_param</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="c1"># check param hasn&#39;t been misspecified</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">param</span> <span class="o">=</span> <span class="p">(</span><span class="n">param</span><span class="p">,)</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_param2</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="p">[]</span>			
		<span class="k">if</span> <span class="n">zonelist</span> <span class="o">!=</span> <span class="p">[]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">zonelist</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_check_zone</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>
	<span class="k">def</span> <span class="nf">_check_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Determine if macro is supported.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="k">return</span> <span class="kc">None</span>
	<span class="k">def</span> <span class="nf">_assign_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="sd">&#39;&#39;&#39;Assign parameters if supplied on initialisation.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">par</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]])</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">def</span> <span class="nf">_set_param2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Assign keys in param attribute appropriate to specific macro.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>	
			<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">par</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param</span><span class="p">)])</span>	
			<span class="k">return</span>																		
		<span class="k">elif</span> <span class="n">param</span><span class="o">.</span><span class="fm">__len__</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> 
			<span class="k">return</span>		<span class="c1"># return if numbers don&#39;t match up</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">paramDict</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">paramDict</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
		<span class="k">for</span> <span class="n">par</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">paramDict</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span>		
	<span class="k">def</span> <span class="nf">_check_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Determine if zone definitions are acceptable.&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,(</span><span class="n">fzone</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="o">=</span><span class="kc">None</span><span class="p">;</span> <span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">])]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
			<span class="n">newlist</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,(</span><span class="n">fzone</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span> <span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">newlist</span>
		<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="o">=</span><span class="kc">None</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span>
			<span class="n">newlist</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">newlist</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">prntStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span><span class="s1">&#39;: &#39;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span> 
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; ,&#39;</span>
			<span class="n">prntStr</span> <span class="o">=</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>	<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;)&#39;</span>
		<span class="k">return</span> <span class="n">prntStr</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="n">oldtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span>
		<span class="k">if</span> <span class="n">oldtype</span> <span class="o">!=</span> <span class="nb">type</span><span class="p">:</span> 
			<span class="n">param_dicts</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">param_dicts</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: model index not known.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">param_dicts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span> <span class="n">_set_type</span><span class="p">)</span> <span class="c1">#: (*str*) Name of the macro for this model. Macro names are identical to those invoked in FEHM.</span>
	<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span>
	<span class="k">def</span> <span class="nf">_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">param</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_param</span><span class="p">,</span> <span class="n">_set_param</span><span class="p">)</span> <span class="c1">#: (*dict[fl64]*) A dictionary of values defining the operation of the macro. See table below for macro-specific dictionary keys.</span>
	<span class="k">def</span> <span class="nf">_get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
	<span class="k">def</span> <span class="nf">_set_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">index</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_index</span><span class="p">,</span> <span class="n">_set_index</span><span class="p">)</span> <span class="c1">#: (*int*) Index of the model to be invoked.</span>
	<span class="k">def</span> <span class="nf">_get_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span>
	<span class="k">def</span> <span class="nf">_set_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zonelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zonelist</span><span class="p">,</span> <span class="n">_set_zonelist</span><span class="p">)</span> <span class="c1">#: (*list*) A list of zones to which the model is applied.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">tempdict</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="n">tempdict</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">tuple</span><span class="p">])</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
				<span class="n">tempdict</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">zn</span><span class="p">])</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tempdict</span><span class="p">)</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
	<span class="k">def</span> <span class="nf">_set_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_file</span><span class="p">,</span> <span class="n">_set_file</span><span class="p">)</span> <span class="c1">#: (**)</span></div>
<div class="viewcode-block" id="fincon"><a class="viewcode-back" href="../fdata.html#fdata.fincon">[docs]</a><span class="k">class</span> <span class="nc">fincon</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM restart object.</span>
	<span class="sd">&#39;&#39;&#39;Initial conditions object. Also called a restart file.</span>
<span class="sd">	</span>
<span class="sd">	Reading one of these files associates the temperature, pressure, saturation etc. data with grid nodes</span>
<span class="sd">	and sets up fehmn.files to use the file for restarting.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_source&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_time&#39;</span><span class="p">,</span><span class="s1">&#39;_changeTime&#39;</span><span class="p">,</span><span class="s1">&#39;_writeOut&#39;</span><span class="p">,</span><span class="s1">&#39;_stressgradCalled&#39;</span><span class="p">,</span><span class="s1">&#39;_T&#39;</span><span class="p">,</span><span class="s1">&#39;_P&#39;</span><span class="p">,</span><span class="s1">&#39;_S&#39;</span><span class="p">,</span>
		<span class="s1">&#39;_co2aq&#39;</span><span class="p">,</span><span class="s1">&#39;_eos&#39;</span><span class="p">,</span><span class="s1">&#39;_co2_eos&#39;</span><span class="p">,</span><span class="s1">&#39;_dc_eos&#39;</span><span class="p">,</span><span class="s1">&#39;_S_co2l&#39;</span><span class="p">,</span><span class="s1">&#39;_strs_xx&#39;</span><span class="p">,</span><span class="s1">&#39;_strs_yy&#39;</span><span class="p">,</span><span class="s1">&#39;_strs_zz&#39;</span><span class="p">,</span><span class="s1">&#39;_strs_xy&#39;</span><span class="p">,</span>
		<span class="s1">&#39;_strs_yz&#39;</span><span class="p">,</span><span class="s1">&#39;_strs_xz&#39;</span><span class="p">,</span><span class="s1">&#39;_disp_x&#39;</span><span class="p">,</span><span class="s1">&#39;_disp_y&#39;</span><span class="p">,</span><span class="s1">&#39;_disp_z&#39;</span><span class="p">,</span><span class="s1">&#39;_path&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inconfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_changeTime</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_writeOut</span> <span class="o">=</span> <span class="kc">False</span> 		<span class="c1"># flag that changes have been made and the incon file should be rewritten</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_stressgradCalled</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_T</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_P</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_S</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_co2aq</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_eos</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_co2_eos</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dc_eos</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_S_co2l</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_disp_x</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_disp_y</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_disp_z</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">inconfilename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">inconfilename</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="s1">&#39;no initial conditions&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>			<span class="c1">#Print out details</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<div class="viewcode-block" id="fincon.read"><a class="viewcode-back" href="../fdata.html#fdata.fincon.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inconfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">if_new</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Parse a restart file for variable information.</span>
<span class="sd">		</span>
<span class="sd">		:param inconfilename: Name of restart file.</span>
<span class="sd">		:type inconfilename: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">inconfilename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">inconfilename</span>
		
		<span class="k">if</span> <span class="n">if_new</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		
		<span class="c1"># check if file exists, if not found, check in work directory</span>
		
		<span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>	
		
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="n">inconfilename</span>

		<span class="n">lns</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
		<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="c1"># check if incon file finished writing</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;no fluxes&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;no fluxes&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;no fluxes&#39;</span><span class="p">)):</span>
			<span class="k">return</span>
		<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">ln</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
		<span class="n">new_time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">new_time</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span> <span class="ow">and</span> <span class="n">if_new</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> 			<span class="c1"># get time stamp</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_changeTime</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
		<span class="n">node_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;nddp&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
			<span class="n">var</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">];</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;no fluxes&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="c1"># read in data</span>
			<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="n">node_number</span><span class="p">:</span>
				<span class="n">values</span> <span class="o">+=</span> <span class="n">lns</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">();</span> <span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
			<span class="c1"># save to attribute</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2temperat&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2pressure&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;saturation&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;wsaturation&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;lco2saturat&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_S_co2l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dissolvdco2&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_co2aq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;eoswater&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_eos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;eosco2&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_co2_eos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;eosdc&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_dc_eos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;xstress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ystress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;zstress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;xystress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;xzstress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;yzstress&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;xdisplacmnt&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_disp_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ydisplacmnt&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_disp_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;zdisplacmnt&#39;</span><span class="p">):</span> 
				<span class="bp">self</span><span class="o">.</span><span class="n">_disp_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">values</span><span class="p">])</span>
		<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_associate_incon</span><span class="p">()</span>
		
		<span class="k">if</span> <span class="n">if_new</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="fincon.write"><a class="viewcode-back" href="../fdata.html#fdata.fincon.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">inconfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Write out a restart file.</span>
<span class="sd">		</span>
<span class="sd">		:param inconfilename: Name of restart file to write out.</span>
<span class="sd">		:type inconfilename: str</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">inconfilename</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">inconfilename</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span>
			<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">absolute_to_workdir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
		<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="n">path</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">path</span>
		
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Writing new INCON file &#39;</span><span class="o">+</span><span class="n">inconfilename</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
		<span class="c1"># write headers</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;PyFEHM V1.0                      &#39;</span><span class="p">)</span>
		<span class="kn">import</span> <span class="nn">time</span>
		<span class="n">lt</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
		<span class="n">mon</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_mon</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mon</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">mon</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">mon</span>
		<span class="n">day</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_mday</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">day</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">day</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">day</span>
		<span class="n">yr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_year</span><span class="p">)</span>
		<span class="n">hr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_hour</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hr</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">hr</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">hr</span>
		<span class="nb">min</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_min</span><span class="p">)</span>
		<span class="n">sec</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">lt</span><span class="o">.</span><span class="n">tm_sec</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mon</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">day</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">yr</span><span class="o">+</span><span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">hr</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="nb">min</span><span class="o">+</span><span class="s1">&#39;:&#39;</span><span class="o">+</span><span class="n">sec</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%20f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="si">%8d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; nddp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># write info</span>
		<span class="n">co2flag</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_co2aq</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">stressflag</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="c1">#if self._parent and co2flag:</span>
		<span class="c1">#	if self._parent.carb.iprtype == 1: co2flag = False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="ow">and</span> <span class="n">stressflag</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">stressflag</span> <span class="o">=</span> <span class="kc">False</span>
		
		<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
		<span class="n">variables</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">]</span>
		<span class="n">formats</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">]</span>
		<span class="n">Ns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">nan_subs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">25.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">co2flag</span><span class="p">:</span>
			<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;co2temperat&#39;</span><span class="p">,</span><span class="s1">&#39;wsaturation&#39;</span><span class="p">,</span><span class="s1">&#39;co2pressure&#39;</span><span class="p">,</span><span class="s1">&#39;lco2saturat&#39;</span><span class="p">,</span><span class="s1">&#39;dissolvdco2&#39;</span><span class="p">,</span>
			<span class="s1">&#39;eoswater&#39;</span><span class="p">,</span><span class="s1">&#39;eosco2&#39;</span><span class="p">,</span><span class="s1">&#39;eosdc&#39;</span><span class="p">]</span>
			<span class="n">variables</span><span class="o">+=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_S_co2l</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_co2aq</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_eos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_co2_eos</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_dc_eos</span><span class="p">]</span>
			<span class="n">formats</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%1d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%1d</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%1d</span><span class="s1">&#39;</span><span class="p">]</span>
			<span class="n">Ns</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
			<span class="n">nan_subs</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">stressflag</span><span class="p">:</span>
			<span class="n">headers</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;xdisplacmnt&#39;</span><span class="p">,</span><span class="s1">&#39;ydisplacmnt&#39;</span><span class="p">,</span><span class="s1">&#39;zdisplacmnt&#39;</span><span class="p">,</span><span class="s1">&#39;xstress&#39;</span><span class="p">,</span><span class="s1">&#39;ystress&#39;</span><span class="p">,</span><span class="s1">&#39;xystress&#39;</span><span class="p">,</span>
				<span class="s1">&#39;zstress&#39;</span><span class="p">,</span><span class="s1">&#39;xzstress&#39;</span><span class="p">,</span><span class="s1">&#39;yzstress&#39;</span><span class="p">]</span>
			<span class="n">variables</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_disp_x</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_disp_y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_disp_z</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span><span class="p">,</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span><span class="p">]</span>
			<span class="n">formats</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span>
					<span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">%#20.10e</span><span class="s1">&#39;</span><span class="p">]</span>
			<span class="n">Ns</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
			<span class="n">nan_subs</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">]</span>
		
		<span class="k">for</span> <span class="n">header</span><span class="p">,</span><span class="n">variable</span><span class="p">,</span><span class="nb">format</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">nan_sub</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">variables</span><span class="p">,</span><span class="n">formats</span><span class="p">,</span><span class="n">Ns</span><span class="p">,</span><span class="n">nan_subs</span><span class="p">):</span>
			<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">variable</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">val</span><span class="p">:</span> <span class="n">val</span> <span class="o">=</span> <span class="n">nan_sub</span>
					<span class="k">if</span> <span class="n">N</span> <span class="o">!=</span> <span class="mi">30</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;ess&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">header</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;displacmnt&#39;</span><span class="p">)):</span> <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">val</span><span class="p">,</span><span class="mf">1.e-98</span><span class="p">])</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">format</span> <span class="o">%</span> <span class="n">val</span> <span class="o">+</span> <span class="s1">&#39;    &#39;</span><span class="p">)</span>
					<span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
					<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="n">N</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="n">cnt</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;no fluxes</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_writeOut</span> <span class="o">=</span> <span class="kc">False</span></div>
<div class="viewcode-block" id="fincon.stressgrad"><a class="viewcode-back" href="../fdata.html#fdata.fincon.stressgrad">[docs]</a>	<span class="k">def</span> <span class="nf">stressgrad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xgrad</span><span class="p">,</span><span class="n">ygrad</span><span class="p">,</span><span class="n">zgrad</span><span class="p">,</span><span class="n">xygrad</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span><span class="n">xzgrad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">yzgrad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">calculate_vertical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">vertical_fraction</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Construct initial stress state with vertical stress gradients.</span>
<span class="sd">		</span>
<span class="sd">		:param xgrad: Vertical gradient in x stress (MPa/m), assumed intercept at [0,0]. If a two element list is given, the first value is interpreted as the gradient, and the second value as the elevation where stress is zero (i.e., the intercept with the z-axis).</span>
<span class="sd">		:type xgrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param ygrad: Vertical gradient in y stress (MPa/m), format as for **xgrad**.</span>
<span class="sd">		:type ygrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param zgrad: Vertical gradient in z stress (MPa/m), format as for **xgrad**.</span>
<span class="sd">		:type zgrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param xygrad: Vertical gradient in xy stress (MPa/m), default is 0, format as for **xgrad**.</span>
<span class="sd">		:type xygrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param xzgrad: Vertical gradient in xz stress (MPa/m), default is 0, format as for **xgrad**.</span>
<span class="sd">		:type xzgrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param yzgrad: Vertical gradient in yz stress (MPa/m), default is 0, format as for **xgrad**.</span>
<span class="sd">		:type yzgrad: fl64, list[fl64,fl64]</span>
<span class="sd">		:param calculate_vertical: Vertical stress calculated by integrating density. If true, then zgrad specifies the overburden.</span>
<span class="sd">		:type calculate_vertical: bool</span>
<span class="sd">		:param vertical_fraction: Horizontal stresses calculated as a fraction of the vertical. If true, xgrad and ygrad are interpreted as fractions.</span>
<span class="sd">		:type vertical_fraction: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: initial conditions file containing temperature/pressure data not loaded.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_associate</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: incon file not associated with parent data file - node and coordinate data not available.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="n">vertical_fraction</span><span class="p">:</span> <span class="n">calculate_vertical</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">calculate_vertical</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;NOTE: density integration to obtain vertical stress should only be done for orthogonal meshes&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_associate</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: node property association required to access density data - set associate=True in data file&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
			<span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
			<span class="c1"># for each x and y, find the column of z-values corresponding</span>
			<span class="n">zs</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">xs</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">ys</span><span class="p">:</span>
					<span class="n">zs</span><span class="o">.</span><span class="n">append</span><span class="p">(((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),[]))</span>
			<span class="n">zs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="n">zs</span><span class="p">[(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">number_nodes</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">zs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
				<span class="n">z0</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="n">sz</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="o">+</span><span class="n">zgrad</span><span class="p">]</span>
				<span class="n">oldRho</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">density</span>
				<span class="n">oldZ</span> <span class="o">=</span> <span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">:]:</span>
					<span class="n">sz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">9.81</span><span class="o">*</span><span class="p">(</span><span class="n">oldRho</span><span class="o">+</span><span class="n">z</span><span class="o">.</span><span class="n">density</span><span class="p">)</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">oldZ</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
					<span class="n">oldRho</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">density</span>
					<span class="n">oldZ</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
				<span class="k">for</span> <span class="n">nd</span><span class="p">,</span><span class="n">szi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">sz</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span><span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">szi</span>			
			<span class="k">if</span> <span class="n">vertical_fraction</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xgrad</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xgrad</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">+</span><span class="n">xgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xgrad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span>
				
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ygrad</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ygrad</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">+</span><span class="n">ygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ygrad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span>
				
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xygrad</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xygrad</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">+</span><span class="n">xygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xygrad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span>
				
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">+</span><span class="n">xzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">xzgrad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span>
				
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">+</span><span class="n">yzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">yzgrad</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span>
				
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">xgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xgrad</span><span class="p">);</span> <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ygrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">ygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ygrad</span><span class="p">);</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xygrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dxy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">xy0</span> <span class="o">=</span> <span class="n">xygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">dxy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xygrad</span><span class="p">);</span> <span class="n">xy0</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dxz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">xz0</span> <span class="o">=</span> <span class="n">xzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">dxz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">);</span> <span class="n">xz0</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dyz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">yz0</span> <span class="o">=</span> <span class="n">yzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">dyz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">);</span> <span class="n">yz0</span> <span class="o">=</span> <span class="mi">0</span>
				
				<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="o">-</span><span class="n">dy</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="o">-</span><span class="n">dxy</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">xy0</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="o">-</span><span class="n">dxz</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">xz0</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="o">-</span><span class="n">dyz</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">yz0</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">x0</span> <span class="o">=</span> <span class="n">xgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dx</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xgrad</span><span class="p">);</span> <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ygrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">ygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ygrad</span><span class="p">);</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">z0</span> <span class="o">=</span> <span class="n">zgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">zgrad</span><span class="p">);</span> <span class="n">z0</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xygrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dxy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xygrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">xy0</span> <span class="o">=</span> <span class="n">xygrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dxy</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xygrad</span><span class="p">);</span> <span class="n">xy0</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dxz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">xz0</span> <span class="o">=</span> <span class="n">xzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dxz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">xzgrad</span><span class="p">);</span> <span class="n">xz0</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">list</span><span class="p">)):</span> <span class="n">dyz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">yz0</span> <span class="o">=</span> <span class="n">yzgrad</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">dyz</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">yzgrad</span><span class="p">);</span> <span class="n">yz0</span> <span class="o">=</span> <span class="mi">0</span>
			
			<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="o">-</span><span class="n">dx</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">x0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="o">-</span><span class="n">dy</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">y0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span> <span class="o">=</span> <span class="o">-</span><span class="n">dz</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">z0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span> <span class="o">=</span> <span class="o">-</span><span class="n">dxy</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">xy0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span> <span class="o">=</span> <span class="o">-</span><span class="n">dxz</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">xz0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span> <span class="o">=</span> <span class="o">-</span><span class="n">dyz</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="n">yz0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_writeOut</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_stressgradCalled</span> <span class="o">=</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="fincon.critical_stress"><a class="viewcode-back" href="../fdata.html#fdata.fincon.critical_stress">[docs]</a>	<span class="k">def</span> <span class="nf">critical_stress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">regime</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">horiz_stress</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span><span class="n">cohesion</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">proximity</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">overburden</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Construct initial stress state near Mohr-Coulomb failure. The vertical stress is calculated</span>
<span class="sd">		using the assigned density. Minimum or maximum horizontal stress calculated using the specified</span>
<span class="sd">		friction coefficient. Intermediate principal stress is assumed to be the average of the other two.</span>
<span class="sd">		</span>
<span class="sd">		:param regime: Stress regime, 0 = compression, 1 = extension (default).</span>
<span class="sd">		:type regime: bool int</span>
<span class="sd">		:param horiz_stress: Horizontal coordinate direction (&#39;x&#39; or &#39;y&#39;) to assign the minimum or maximum principal stress (depending on stress regime).</span>
<span class="sd">		:type horiz_stress: str</span>
<span class="sd">		:param mu: Friction coefficient for Mohr-Coulomb failure (default = 0.6).</span>
<span class="sd">		:type mu: fl64</span>
<span class="sd">		:param cohesion: Cohesion for Mohr-Coulomb failure (default = 0).</span>
<span class="sd">		:type cohesion: fl64</span>
<span class="sd">		:param proximity: A negative quantity indicating how close the minimum principal stress is to Mohr-Coulomb failure (MPa, default = 0).</span>
<span class="sd">		:type proximity: fl64</span>
<span class="sd">		:param overburden: Overburden at top of model (MPa, default = 0).</span>
<span class="sd">		:type overburden: fl64</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="n">mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">mu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">mu</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">stressgrad</span><span class="p">(</span><span class="n">xgrad</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">ygrad</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span><span class="n">zgrad</span><span class="o">=</span><span class="n">overburden</span><span class="p">,</span><span class="n">calculate_vertical</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">regime</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">horiz_stress</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cohesion</span><span class="o">*</span><span class="n">mult</span><span class="p">)</span><span class="o">/</span><span class="n">mult</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">proximity</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cohesion</span><span class="o">*</span><span class="n">mult</span><span class="p">)</span><span class="o">/</span><span class="n">mult</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">proximity</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">horiz_stress</span> <span class="o">==</span> <span class="s1">&#39;x&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">cohesion</span><span class="o">*</span><span class="n">mult</span><span class="o">+</span><span class="n">mult</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">-</span><span class="n">proximity</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">cohesion</span><span class="o">*</span><span class="n">mult</span><span class="o">+</span><span class="n">mult</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">)</span><span class="o">-</span><span class="n">proximity</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span> <span class="o">=</span> <span class="nb">list</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span></div>
	<span class="k">def</span> <span class="nf">_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="n">L</span> <span class="o">=</span> <span class="mi">62</span>
		<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; IIII---------------------------------------------------------IIII&#39;</span><span class="p">)</span>
		<span class="n">line</span> <span class="o">=</span> <span class="s1">&#39; IIII FEHM restart file </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> summary.&#39;</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span> <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;IIII&#39;</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; IIII---------------------------------------------------------IIII&#39;</span><span class="p">)</span>
		
		<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; IIII Restart parameters:&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="p">):</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; Heat and mass: pressure, temperature, saturation.&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">S_co2l</span><span class="p">):</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; CO2 module: CO2 saturations, dissolve mass, EOS.&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">):</span> <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; Stress module: normal and shear stresses, displacements.&#39;</span><span class="p">)</span>
		
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39; II&#39;</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span> <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
				<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;IIII&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; IIII -&#39;</span>
				<span class="n">keepGoing</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">while</span> <span class="n">keepGoing</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> 
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prntStr</span><span class="o">+</span><span class="s1">&#39;IIII&#39;</span><span class="p">)</span>
						<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; IIII &#39;</span>
						<span class="k">break</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)</span><span class="o">&lt;</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span> 
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prntStr</span><span class="o">+</span><span class="s1">&#39;IIII&#39;</span><span class="p">)</span>
						<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; IIII   &#39;</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; IIII---------------------------------------------------------IIII&#39;</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_filename</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of restart file (initial conditions)</span>
	<span class="k">def</span> <span class="nf">_get_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
	<span class="k">def</span> <span class="nf">_set_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changeTime</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">time</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time</span><span class="p">,</span><span class="n">_set_time</span><span class="p">)</span> 			<span class="c1">#: (*fl64*) Time stamp of initial conditions file (end time of simulation that produced this file).</span>
	<span class="k">def</span> <span class="nf">_get_T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_T</span>
	<span class="n">T</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_T</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node temperatures, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_P</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_P</span>
	<span class="n">P</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_P</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node pressures, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_S</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S</span>
	<span class="n">S</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_S</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node water saturations, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_eos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eos</span>
	<span class="n">eos</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_eos</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node water equation of state indices, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_co2_eos</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_co2_eos</span>
	<span class="n">co2_eos</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2_eos</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node co2 equation of state indices, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_S_co2l</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S_co2l</span>
	<span class="n">S_co2l</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_S_co2l</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node co2 liquid/super-critical saturations, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_S_co2g</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">S_co2l</span> <span class="o">==</span> <span class="p">[]:</span> <span class="k">return</span> <span class="p">[]</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">S_co2l</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">S</span>
	<span class="n">S_co2g</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_S_co2g</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node co2 gas saturations, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_co2aq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_co2aq</span>
	<span class="n">co2aq</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2aq</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Initial node dissolved co2 concentrations, ordered by node index.</span>
	<span class="k">def</span> <span class="nf">_get_disp_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_x</span>
	<span class="n">disp_x</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_disp_x</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node x displacement, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_disp_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_y</span>
	<span class="n">disp_y</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_disp_y</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node y displacement, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_disp_z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_disp_z</span>
	<span class="n">disp_z</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_disp_z</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node z displacement, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_xx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xx</span>
	<span class="n">strs_xx</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_xx</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node x stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_yy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_yy</span>
	<span class="n">strs_yy</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_yy</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node y stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_zz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_zz</span>
	<span class="n">strs_zz</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_zz</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node z stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xy</span>
	<span class="n">strs_xy</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_xy</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node xy stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_xz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_xz</span>
	<span class="n">strs_xz</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_xz</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node xz stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_strs_yz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs_yz</span>
	<span class="n">strs_yz</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs_yz</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Initial node yz stress, ordered by node index</span>
	<span class="k">def</span> <span class="nf">_get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>
	<span class="n">source</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_source</span><span class="p">)</span>					<span class="c1">#: (*str*) Name of input file that generated the restart.</span></div>
<div class="viewcode-block" id="fstrs"><a class="viewcode-back" href="../fdata.html#fdata.fstrs">[docs]</a><span class="k">class</span> <span class="nc">fstrs</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM stress module.</span>
	<span class="sd">&quot;&quot;&quot;Stress module object, sets properties for execution of FEHM stress module (see macro **STRS**).</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_initcalc&#39;</span><span class="p">,</span><span class="s1">&#39;_fem&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_bodyforce&#39;</span><span class="p">,</span><span class="s1">&#39;_tolerance&#39;</span><span class="p">,</span><span class="s1">&#39;_param&#39;</span><span class="p">,</span><span class="s1">&#39;_excess_she&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">initcalc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fem</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bodyforce</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">tolerance</span><span class="o">=-</span><span class="mf">0.01</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">{},</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_initcalc</span><span class="o">=</span><span class="n">initcalc</span> 	
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_fem</span><span class="o">=</span><span class="n">fem</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_bodyforce</span><span class="o">=</span><span class="n">bodyforce</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="o">=</span><span class="n">tolerance</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="o">=</span><span class="p">{}</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="s1">&#39;IHMS&#39;</span><span class="p">]</span><span class="o">=-</span><span class="mi">3</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="s1">&#39;porosity_factor&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span> <span class="o">=</span> <span class="p">{}</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span><span class="p">[</span><span class="s1">&#39;PAR2&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span><span class="p">[</span><span class="s1">&#39;PAR3&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">param</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]:</span> <span class="k">return</span> <span class="s1">&#39;stress module inactive&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;stress module active&#39;</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<div class="viewcode-block" id="fstrs.on"><a class="viewcode-back" href="../fdata.html#fdata.fstrs.on">[docs]</a>	<span class="k">def</span> <span class="nf">on</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set parameters to turn stress calculations ON.</span>
<span class="sd">		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> 		<span class="c1"># seg fault when using stress module without this set</span></div>
<div class="viewcode-block" id="fstrs.off"><a class="viewcode-back" href="../fdata.html#fdata.fstrs.off">[docs]</a>	<span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set param to turn stress calculations OFF.</span>
<span class="sd">		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;element_integration_INTG&#39;</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span></div>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]:</span> <span class="nb">print</span> <span class="s1">&#39;Stress module activated.&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Stress module inactive&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bodyforce</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Body forces (gravity) will be calculated.&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Body forces (gravity) will NOT be calculated.&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">initcalc</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Initial stress state will be calculated.&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;Initial stress state will NOT be calculated.&#39;</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span><span class="c1">#: Return a summary of the stress module.</span>
	<span class="k">def</span> <span class="nf">_get_bodyforce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bodyforce</span>
	<span class="k">def</span> <span class="nf">_set_bodyforce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span> <span class="nb">print</span> <span class="s1">&#39;Boolean values only&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_bodyforce</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">bodyforce</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bodyforce</span><span class="p">,</span><span class="n">_set_bodyforce</span><span class="p">)</span><span class="c1">#: (*bool*) Boolean calling for body force calculations (gravity). Default is True.</span>
	<span class="k">def</span> <span class="nf">_get_initcalc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initcalc</span>
	<span class="k">def</span> <span class="nf">_set_initcalc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span> <span class="nb">print</span> <span class="s1">&#39;Boolean values only&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_initcalc</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">initcalc</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_initcalc</span><span class="p">,</span><span class="n">_set_initcalc</span><span class="p">)</span><span class="c1">#: (*bool*) Boolean signalling if initial stress calculations should be performed. Default is True.</span>
	<span class="k">def</span> <span class="nf">_get_fem</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fem</span>
	<span class="k">def</span> <span class="nf">_set_fem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span> <span class="nb">print</span> <span class="s1">&#39;Boolean values only&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_fem</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">fem</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_fem</span><span class="p">,</span><span class="n">_set_fem</span><span class="p">)</span><span class="c1">#: (*bool*) Boolean signalling use of finite element modules for calculating stress and displacement. Default is True.</span>
	<span class="k">def</span> <span class="nf">_get_tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span>
	<span class="k">def</span> <span class="nf">_set_tolerance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tolerance</span><span class="o">=</span><span class="n">value</span>
	<span class="n">tolerance</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tolerance</span><span class="p">,</span><span class="n">_set_tolerance</span><span class="p">)</span><span class="c1">#: (*flt*) Tolerance of stress calculations.</span>
	<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span>
	<span class="k">def</span> <span class="nf">_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">param</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_param</span><span class="p">,</span> <span class="n">_set_param</span><span class="p">)</span> <span class="c1">#: (*dict[flt]*) Dictionary of stress parameters: &#39;IHMS&#39; - coupling parameter, &#39;ISTRS&#39; - type of stress solution.</span>
	<span class="k">def</span> <span class="nf">_get_excess_she</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span>
	<span class="k">def</span> <span class="nf">_set_excess_she</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_excess_she</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">excess_she</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_excess_she</span><span class="p">,</span> <span class="n">_set_excess_she</span><span class="p">)</span> <span class="c1">#: Dictionary of excess shear parameters:</span></div>
<span class="k">class</span> <span class="nc">fngas</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM noncondensible gas transport.</span>
	<span class="sd">&quot;&quot;&quot;Module for noncondensible gas transport (see macro **NGAS**).</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_dof&#39;</span><span class="p">,</span><span class="s1">&#39;_init_pres&#39;</span><span class="p">,</span><span class="s1">&#39;_ncg_pres&#39;</span><span class="p">,</span><span class="s1">&#39;_source&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dof</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">=</span><span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dof</span> <span class="o">=</span> <span class="n">dof</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_init_pres</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_ncg_pres</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dof</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;ncg module inactive&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;ncg module active&#39;</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">add_init_pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="p">,</span><span class="n">init_pres</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>	<span class="n">key</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">key</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">init_pres</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">key</span><span class="p">,</span><span class="n">init_pres</span><span class="p">),)))</span>
	<span class="k">def</span> <span class="nf">add_ncg_pres</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="p">,</span><span class="n">ncg_pres</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>	<span class="n">key</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">key</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ncg_pres</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">key</span><span class="p">,</span><span class="n">ncg_pres</span><span class="p">),)))</span>
	<span class="k">def</span> <span class="nf">add_source</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="p">,</span><span class="n">source</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>	<span class="n">key</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">key</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">key</span><span class="p">,</span><span class="n">source</span><span class="p">),)))</span>
	<span class="k">def</span> <span class="nf">_get_init_pres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_pres</span>
	<span class="n">init_pres</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_init_pres</span><span class="p">)</span> <span class="c1">#: (*dict*) dictionary of initial partial pressures indexed by zone number.</span>
	<span class="k">def</span> <span class="nf">_get_ncg_pres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ncg_pres</span>
	<span class="n">ncg_pres</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ncg_pres</span><span class="p">)</span> <span class="c1">#: (*dict*) dictionary of noncondensible pressures indexed by zone number.</span>
	<span class="k">def</span> <span class="nf">_get_source</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>
	<span class="n">source</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_source</span><span class="p">)</span> <span class="c1">#: (*dict*) dictionary of air sources indexed by zone number.</span>
	<span class="k">def</span> <span class="nf">_get_dof</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof</span>
	<span class="k">def</span> <span class="nf">_set_dof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dof</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">dof</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dof</span><span class="p">,</span> <span class="n">_set_dof</span><span class="p">)</span> <span class="c1">#: (*int*) 	degree of freedom (1-3) for the calculation</span>
<div class="viewcode-block" id="fcarb"><a class="viewcode-back" href="../fdata.html#fdata.fcarb">[docs]</a><span class="k">class</span> <span class="nc">fcarb</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM CO2 module.</span>
	<span class="sd">&quot;&quot;&quot;CO2 module object, sets properties for execution of FEHM CO2 module (see macro **CARB**).</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_iprtype&#39;</span><span class="p">,</span><span class="s1">&#39;_brine&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iprtype</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">brine</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_iprtype</span> <span class="o">=</span> <span class="n">iprtype</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_brine</span> <span class="o">=</span> <span class="n">brine</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span><span class="n">parent</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;CO2 module inactive&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;CO2 module active&#39;</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<div class="viewcode-block" id="fcarb.on"><a class="viewcode-back" href="../fdata.html#fdata.fcarb.on">[docs]</a>	<span class="k">def</span> <span class="nf">on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">iprtype</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set parameters to turn CO2 calculations ON.</span>
<span class="sd">		</span>
<span class="sd">		:param iprtype: Integer denoting type of simulation (1 = water only, 2 = CO2 only, 3 = water+CO2, no solubility, 4 = water+CO2, with solubility, 5 = water+CO2+air, with solubility)</span>
<span class="sd">		:type iprtype: int</span>
<span class="sd">		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">=</span> <span class="n">iprtype</span></div>
<div class="viewcode-block" id="fcarb.off"><a class="viewcode-back" href="../fdata.html#fdata.fcarb.off">[docs]</a>	<span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Set parameters to turn CO2 calculations OFF.</span>
<span class="sd">		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_co2in</span> <span class="o">=</span> <span class="kc">False</span></div>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;CO2 module activated.&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;CO2 module inactive&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;Components:&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;Water only&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;CO2 only&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span><span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;CO2, water (no solubility)&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span><span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;CO2, water (with solubility)&#39;</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span><span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;CO2, water, air (with solubility)&#39;</span>		
		<span class="nb">print</span> <span class="n">prntStr</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;CO2 solubility dependent on brine concentration.&#39;</span>
		<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;CO2 solubility NOT dependent on brine concentration.&#39;</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span><span class="c1">#: Return a summary of the CO2 module.</span>
	<span class="k">def</span> <span class="nf">_get_iprtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iprtype</span>
	<span class="k">def</span> <span class="nf">_set_iprtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iprtype</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">iprtype</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_iprtype</span><span class="p">,</span> <span class="n">_set_iprtype</span><span class="p">)</span> <span class="c1">#: (*int*) Integer indicating type of simulation.</span>
	<span class="k">def</span> <span class="nf">_get_brine</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brine</span>
	<span class="k">def</span> <span class="nf">_set_brine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_brine</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">brine</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_brine</span><span class="p">,</span> <span class="n">_set_brine</span><span class="p">)</span> <span class="c1">#: (*bool*) Boolean signalling calculation of brine in simulation.</span></div>
<div class="viewcode-block" id="ftrac"><a class="viewcode-back" href="../fdata.html#fdata.ftrac">[docs]</a><span class="k">class</span> <span class="nc">ftrac</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM chemistry module.</span>
	<span class="sd">&quot;&quot;&quot;Chemistry module object, sets properties for execution of FEHM chemistry module (see macro **TRAC**).</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ldsp</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="o">=</span><span class="n">copy</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">trac</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_on</span><span class="o">=</span><span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_ldsp</span> <span class="o">=</span> <span class="n">ldsp</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_common_modellist</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_common_model_key</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_transport_porosity</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">def</span> <span class="nf">on</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="sd">&quot;&quot;&quot;Switches on the **TRAC** macro. This occurs automatically when the first species object is added.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_on</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="sd">&quot;&quot;&quot;Switches off the **TRAC** macro. This occurs automatically when the las species object is deleted.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_on</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">def</span> <span class="nf">add_species</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase</span><span class="p">,</span><span class="n">adsorption_model</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">adsorption</span><span class="o">=</span><span class="p">[],</span><span class="n">diffusion_model</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">diffusion</span><span class="o">=</span><span class="mf">1.e-9</span><span class="p">,</span>
			<span class="n">dispersion</span> <span class="o">=</span> <span class="p">[</span><span class="o">.</span><span class="mi">0005</span><span class="p">,</span><span class="o">.</span><span class="mi">0005</span><span class="p">,</span><span class="o">.</span><span class="mi">0005</span><span class="p">],</span><span class="n">species</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Add a new species to **TRAC**. The new species is accessible via the last item in the specieslist attribute.</span>
<span class="sd">		</span>
<span class="sd">		:param phase: Flag indicating the phase of the species.</span>
<span class="sd">		:type phase: int</span>
<span class="sd">		:param adsorption_model: Flag for desired adsorption model (default 0).</span>
<span class="sd">		:type adsorption_model: int</span>
<span class="sd">		:param adsorption: Adsorption model parameters - three element list.</span>
<span class="sd">		:type adsorption: lst[fl64]</span>
<span class="sd">		:param diffusion_model: Flag for diffusion model (default 0).</span>
<span class="sd">		:type diffusion_model: int</span>
<span class="sd">		:param diffusion: Diffusion coefficien (default 1.e-9).</span>
<span class="sd">		:type diffusion: fl64</span>
<span class="sd">		:param dispersion: Three item list containing X,Y,Z dispersion coefficients. If the ldsp attribute is set to true, the first two entries are interpreted as longitudinal and transverse dispersion, and the third is ignored.</span>
<span class="sd">		:type dispersion: lst[fl64]</span>
<span class="sd">		:param species: Pre-defined fspecies object.</span>
<span class="sd">		:type species: fspecies</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">species</span><span class="p">:</span>
			<span class="n">species</span> <span class="o">=</span> <span class="n">fspecies</span><span class="p">(</span><span class="n">phase</span> <span class="o">=</span> <span class="n">phase</span><span class="p">,</span><span class="n">adsorption_model</span><span class="o">=</span><span class="n">adsorption_model</span><span class="p">,</span>	<span class="n">adsorption</span><span class="o">=</span><span class="n">adsorption</span><span class="p">,</span>
					<span class="n">diffusion_model</span><span class="o">=</span><span class="n">diffusion_model</span><span class="p">,</span> <span class="n">diffusion</span><span class="o">=</span><span class="n">diffusion</span><span class="p">,</span><span class="n">dispersion</span><span class="o">=</span><span class="n">dispersion</span><span class="p">)</span>
		<span class="n">species</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_species</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on</span> <span class="o">=</span> <span class="kc">True</span>	<span class="c1"># only switch on if first species added</span>
	<span class="k">def</span> <span class="nf">delete_species</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">species</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Delete a species from ftrac.</span>
<span class="sd">		</span>
<span class="sd">		:param species: Species object to be removed.</span>
<span class="sd">		:type species: fspecies</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_species</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on</span> <span class="o">=</span> <span class="kc">False</span> 	<span class="c1"># switch off if no species remain</span>
	<span class="k">def</span> <span class="nf">add_common_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zone</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">diffusion_model</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">diffusion</span> <span class="o">=</span> <span class="mf">1.e-9</span><span class="p">,</span> <span class="n">dispersion</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.005</span><span class="p">]):</span>
		<span class="sd">&quot;&quot;&quot;Add a new common dispersion/diffusion model for multiple species (see GROUP 9 entry of macro **TRAC** in FEHM user manual).</span>
<span class="sd">		</span>
<span class="sd">		:param zone: Zone to which these parameters are applied.</span>
<span class="sd">		:type zone: int, str, fzone</span>
<span class="sd">		:param diffusion_model: Flag for desired diffusion model (default 0).</span>
<span class="sd">		:type diffusion_model: int</span>
<span class="sd">		:param diffusion: Diffusion coefficien (default 1.e-9).</span>
<span class="sd">		:type diffusion: fl64</span>
<span class="sd">		:param dispersion: Three item list containing X,Y,Z dispersion coefficients. If the ldsp attribute is set to true, the first two entries are interpreted as longitudinal and transverse dispersion, and the third is ignored.</span>
<span class="sd">		:type dispersion: lst[fl64]		</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">cm</span> <span class="o">=</span> <span class="n">_common_model</span><span class="p">(</span><span class="n">zone</span> <span class="o">=</span> <span class="n">zone</span><span class="p">,</span> <span class="n">diffusion</span> <span class="o">=</span> <span class="n">diffusion</span><span class="p">,</span> <span class="n">dispersion</span> <span class="o">=</span> <span class="n">dispersion</span><span class="p">,</span> <span class="n">diffusion_model</span> <span class="o">=</span> <span class="n">diffusion_model</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">cm</span><span class="o">.</span><span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">cm</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_common_modellist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_number_species</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span><span class="p">)</span>
	<span class="n">number_species</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_number_species</span><span class="p">)</span> <span class="c1">#: (*int*) Number of species for which transport properties have been defined.</span>
	<span class="k">def</span> <span class="nf">_get_ldsp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ldsp</span>
	<span class="k">def</span> <span class="nf">_set_ldsp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ldsp</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">ldsp</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ldsp</span><span class="p">,</span><span class="n">_set_ldsp</span><span class="p">)</span> <span class="c1">#: (*bool*) Boolean signalling longitudinal/transverse description of dispersivities to be used.</span>
	<span class="k">def</span> <span class="nf">_get_common_modellist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_modellist</span>
	<span class="k">def</span> <span class="nf">_set_common_modellist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_modellist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">common_modellist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_common_modellist</span><span class="p">,</span><span class="n">_set_common_modellist</span><span class="p">)</span> <span class="c1">#: (*lst*) List of common model definitions.</span>
	<span class="k">def</span> <span class="nf">_get_common_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">tempDict</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_modellist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
				<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">),</span><span class="n">cm</span><span class="p">))</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
				<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">cm</span><span class="p">))</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tempDict</span><span class="p">)</span>
	<span class="n">common_model</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_common_model</span><span class="p">)</span> <span class="c1">#: (*dict*) Dictionary of common models.</span>
	<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span>
	<span class="k">def</span> <span class="nf">_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">param</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_param</span><span class="p">,</span><span class="n">_set_param</span><span class="p">)</span> <span class="c1">#: (*dict*) Dictionary of **TRAC** parameters.</span>
	<span class="k">def</span> <span class="nf">_get_transport_porosity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transport_porosity</span>
	<span class="k">def</span> <span class="nf">_set_transport_porosity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transport_porosity</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">transport_porosity</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_transport_porosity</span><span class="p">,</span><span class="n">_set_transport_porosity</span><span class="p">)</span> <span class="c1">#: (*fl64*) Transport porosity for entire domain (zone by zone not supported).</span>
	<span class="k">def</span> <span class="nf">_get_specieslist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span>
	<span class="k">def</span> <span class="nf">_set_specieslist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_specieslist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">specieslist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_specieslist</span><span class="p">,</span><span class="n">_set_specieslist</span><span class="p">)</span> <span class="c1">#: (*lst*) List of species objects.</span>
	<span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
	<span class="k">def</span> <span class="nf">_set_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">on</span><span class="p">()</span> 	<span class="c1"># if set, turn on trac macro</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_file</span><span class="p">,</span> <span class="n">_set_file</span><span class="p">)</span> <span class="c1">#: (*str*) Path of auxiliary file containing trac information. PyFEHM will copy the contents of this file into the input file verbatim. Setting this variable will cause PyFEHM to use trac in &#39;stupid&#39; mode.</span>
	<span class="k">def</span> <span class="nf">_get_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span>
	<span class="k">def</span> <span class="nf">_set_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zonelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zonelist</span><span class="p">,</span> <span class="n">_set_zonelist</span><span class="p">)</span> <span class="c1">#: (*lst[fzone]*) A list of zones to be written before the trac macro, for the situation that trac is used in &#39;stupid&#39; model, i.e., the file attribute has been set to an auxiliary file.</span></div>
<span class="k">class</span> <span class="nc">fspecies</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>							<span class="c1"># class for species transport model</span>
	<span class="sd">&quot;&quot;&quot;Object for each chemical species. The species transport, adsorption, initial concentration and generator</span>
<span class="sd">	properties are assigned in here.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase</span><span class="p">,</span><span class="n">adsorption_model</span><span class="p">,</span><span class="n">adsorption</span><span class="p">,</span><span class="n">diffusion_model</span><span class="p">,</span><span class="n">diffusion</span><span class="p">,</span> <span class="n">dispersion</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">phase</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">_adsorption_model</span> <span class="o">=</span> <span class="n">adsorption_model</span>
		<span class="k">if</span> <span class="n">adsorption</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">adsorption</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: expecting three adsorption parameters&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_adsorption</span> <span class="o">=</span> <span class="n">adsorption</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span> <span class="o">=</span> <span class="n">diffusion_model</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span> <span class="o">=</span> <span class="n">dispersion</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span> <span class="o">=</span> <span class="n">diffusion</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_density_modifier</span> <span class="o">=</span> <span class="kc">None</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_generatorlist</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">def</span> <span class="nf">add_tracer_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">initial_concentration</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Define initial tracer concentration in a zone.</span>
<span class="sd">		</span>
<span class="sd">		:param initial_concentration: Initial concentration of the tracer.</span>
<span class="sd">		:type initial_concentration: fl64</span>
<span class="sd">		:param zone: Zone to which the initial concentration is assigned (default Zone 0).</span>
<span class="sd">		:type zone: int, str, fzone</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">zone</span><span class="p">:</span> <span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">ic</span> <span class="o">=</span> <span class="n">_tracer_concentration</span><span class="p">(</span><span class="n">initial_concentration</span><span class="p">,</span><span class="n">zone</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">delete_tracer_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tracer_concentration</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tracer_concentration</span><span class="p">)</span>		
	<span class="k">def</span> <span class="nf">add_tracer_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tracer_generator</span><span class="p">,</span><span class="n">time_start</span><span class="p">,</span><span class="n">time_end</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Define a tracer source or sink within a zone.</span>
<span class="sd">		</span>
<span class="sd">		:param tracer_generator: Injection concentration at inlet node. If outlet, in place concentration will be used. If negative, concentration will be fixed at the absolute value.</span>
<span class="sd">		:type tracer_generator:fl64</span>
<span class="sd">		:param time_start: Time to start the source/sink.</span>
<span class="sd">		:type time_start:fl64</span>
<span class="sd">		:param time_end: Time to stop the source/sink.</span>
<span class="sd">		:type time_end: fl64</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">zone</span><span class="p">:</span> <span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">ic</span> <span class="o">=</span> <span class="n">_tracer_generator</span><span class="p">(</span><span class="n">tracer_generator</span><span class="p">,</span><span class="n">time_start</span><span class="p">,</span><span class="n">time_end</span><span class="p">,</span><span class="n">zone</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_generatorlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ic</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">delete_tracer_generator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tracer_generator</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tracer_generatorlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tracer_generator</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span>
	<span class="k">def</span> <span class="nf">_set_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">phase</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phase</span><span class="p">,</span><span class="n">_set_phase</span><span class="p">)</span> <span class="c1">#: (*int*) Flag for species phase.</span>
	<span class="k">def</span> <span class="nf">_get_adsorption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adsorption_model</span>
	<span class="k">def</span> <span class="nf">_set_adsorption_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adsorption_model</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">adsorption_model</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_adsorption_model</span><span class="p">,</span><span class="n">_set_adsorption_model</span><span class="p">)</span> <span class="c1">#: (*int*) Flag for adsorption model.</span>
	<span class="k">def</span> <span class="nf">_get_adsorption</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adsorption</span>
	<span class="k">def</span> <span class="nf">_set_adsorption</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adsorption</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">adsorption</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_adsorption</span><span class="p">,</span><span class="n">_set_adsorption</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*) Three item list of adsoprtion parameters.</span>
	<span class="k">def</span> <span class="nf">_get_diffusion_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span>
	<span class="k">def</span> <span class="nf">_set_diffusion_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">diffusion_model</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_diffusion_model</span><span class="p">,</span><span class="n">_set_diffusion_model</span><span class="p">)</span> <span class="c1">#: (*int*) Flag for diffusion model.</span>
	<span class="k">def</span> <span class="nf">_get_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span>
	<span class="k">def</span> <span class="nf">_set_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">diffusion</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_diffusion</span><span class="p">,</span><span class="n">_set_diffusion</span><span class="p">)</span> <span class="c1">#: (*fl64*) Diffusion coefficient.</span>
	<span class="k">def</span> <span class="nf">_get_dispersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span>
	<span class="k">def</span> <span class="nf">_set_dispersion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">dispersion</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dispersion</span><span class="p">,</span><span class="n">_set_dispersion</span><span class="p">)</span> <span class="c1">#: (*lst[fl64]*)	Three item list of X,Y,Z dispersion coefficients, or longitudinal and transverse components if ldsp = True.</span>
	<span class="k">def</span> <span class="nf">_get_density_modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density_modifier</span>
	<span class="k">def</span> <span class="nf">_set_density_modifier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_density_modifier</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">density_modifier</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_density_modifier</span><span class="p">,</span><span class="n">_set_density_modifier</span><span class="p">)</span> <span class="c1">#: (*fl64*) Density modifier used in macro **CDEN**. If set, **CDEN** output will be written along with **TRAC**.</span>
	<span class="k">def</span> <span class="nf">_get_tracer_concentrationlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span>
	<span class="k">def</span> <span class="nf">_set_tracer_concentrationlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">tracer_concentrationlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tracer_concentrationlist</span><span class="p">,</span><span class="n">_set_tracer_concentrationlist</span><span class="p">)</span> <span class="c1">#: (*lst*) List of initial tracer concentration objects.</span>
	<span class="k">def</span> <span class="nf">_get_tracer_generatorlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_generatorlist</span>
	<span class="k">def</span> <span class="nf">_set_tracer_generatorlist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tracer_generatorlist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">tracer_generatorlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tracer_generatorlist</span><span class="p">,</span><span class="n">_set_tracer_generatorlist</span><span class="p">)</span> <span class="c1">#: (*lst*) List of tracer generator objects.</span>
<span class="k">class</span> <span class="nc">_common_model</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">diffusion_model</span><span class="p">,</span> <span class="n">diffusion</span><span class="p">,</span> <span class="n">dispersion</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span> <span class="o">=</span> <span class="n">diffusion</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span> <span class="o">=</span> <span class="n">dispersion</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span> <span class="o">=</span> <span class="n">diffusion_model</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span><span class="n">_set_zone</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span>
	<span class="k">def</span> <span class="nf">_set_diffusion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">diffusion</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_diffusion</span><span class="p">,</span><span class="n">_set_diffusion</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_diffusion_model</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span>
	<span class="k">def</span> <span class="nf">_set_diffusion_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diffusion_model</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">diffusion_model</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_diffusion_model</span><span class="p">,</span><span class="n">_set_diffusion_model</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_dispersion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span>
	<span class="k">def</span> <span class="nf">_set_dispersion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dispersion</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">dispersion</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dispersion</span><span class="p">,</span><span class="n">_set_dispersion</span><span class="p">)</span> <span class="c1">#: (**)</span>
<span class="k">class</span> <span class="nc">_tracer_concentration</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">initial_concentration</span><span class="p">,</span><span class="n">zone</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_initial_concentration</span> <span class="o">=</span> <span class="n">initial_concentration</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span><span class="n">_set_zone</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_initial_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_concentration</span>
	<span class="k">def</span> <span class="nf">_set_initial_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_concentration</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">initial_concentration</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_initial_concentration</span><span class="p">,</span><span class="n">_set_initial_concentration</span><span class="p">)</span> <span class="c1">#: (**)</span>
<span class="k">class</span> <span class="nc">_tracer_generator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">injection_concentration</span><span class="p">,</span> <span class="n">time_start</span><span class="p">,</span> <span class="n">time_end</span> <span class="p">,</span><span class="n">zone</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_injection_concentration</span> <span class="o">=</span> <span class="n">injection_concentration</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_time_start</span> <span class="o">=</span> <span class="n">time_start</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_time_end</span> <span class="o">=</span> <span class="n">time_end</span>
	<span class="k">def</span> <span class="nf">_get_injection_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_injection_concentration</span>
	<span class="k">def</span> <span class="nf">_set_injection_concentration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_injection_concentration</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">injection_concentration</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_injection_concentration</span><span class="p">,</span><span class="n">_set_injection_concentration</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_time_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_start</span>
	<span class="k">def</span> <span class="nf">_set_time_start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_start</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">time_start</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time_start</span><span class="p">,</span><span class="n">_set_time_start</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_time_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_end</span>
	<span class="k">def</span> <span class="nf">_set_time_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_end</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">time_end</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time_end</span><span class="p">,</span><span class="n">_set_time_end</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span><span class="n">_set_zone</span><span class="p">)</span> <span class="c1">#: (**)</span>
<span class="k">class</span> <span class="nc">fgeneral</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 					<span class="c1">#PyFEHM general (undefined) macro class</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">insert_after</span><span class="p">,</span> <span class="n">zonelist</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lines</span> <span class="o">=</span> <span class="n">lines</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">zonelist</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">insert_after</span> <span class="o">=</span> <span class="n">insert_after</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
		
		<span class="c1"># check zonelist correct format</span>
		<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">],]</span>
		<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
				<span class="k">if</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">zns</span>
		
		<span class="c1"># check lines correct format</span>
		<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span> <span class="s2">&quot;ERROR: bad type for lines, bro&quot;</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;ERROR: lines are empty&quot;</span>
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
			<span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;ERROR: each entry in lines must be a string&quot;</span>
<span class="k">class</span> <span class="nc">fstorage</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Storage object - allows user to save information to the dat file.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span><span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
<div class="viewcode-block" id="fcont"><a class="viewcode-back" href="../fdata.html#fdata.fcont">[docs]</a><span class="k">class</span> <span class="nc">fcont</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM contour output object.</span>
	<span class="sd">&quot;&quot;&quot;Contour output object, makes request for contour data to be output (see macro **CONT**).</span>
<span class="sd">	</span>
<span class="sd">	This data type outputs specified variables (e.g., temperature, permeability) for x,y,z or node locations</span>
<span class="sd">	at fixed times (one file = one time). The data can be output in several formats (all of which are readable by</span>
<span class="sd">	PyFEHM) and at specified times.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_format&#39;</span><span class="p">,</span><span class="s1">&#39;_timestep_interval&#39;</span><span class="p">,</span><span class="s1">&#39;_time_interval&#39;</span><span class="p">,</span><span class="s1">&#39;_time_flag&#39;</span><span class="p">,</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_zones&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">cont_format</span><span class="p">,</span><span class="n">timestep_interval</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">time_interval</span><span class="o">=</span><span class="mf">1.e30</span><span class="p">,</span><span class="n">time_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">variables</span><span class="o">=</span><span class="p">[],</span><span class="n">zones</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="nb">format</span> 	
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span><span class="o">=</span><span class="n">timestep_interval</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span><span class="o">=</span><span class="n">time_interval</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_time_flag</span><span class="o">=</span><span class="n">time_flag</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">=</span><span class="p">[]</span> 			
		<span class="k">if</span> <span class="n">variables</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">=</span><span class="n">variables</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zones</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="n">zones</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zones</span><span class="o">=</span><span class="n">zones</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">retStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">+</span> <span class="s1">&#39; contour output:</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)):</span>
			<span class="n">retStr</span> <span class="o">+=</span> <span class="n">v</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">return</span> <span class="n">retStr</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>		
	<span class="k">def</span> <span class="nf">_get_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 							<span class="c1">#print out available variables</span>
		<span class="nb">print</span> <span class="s1">&#39;The following are acceptable variables&#39;</span>
		<span class="n">allVariables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">contour_variables</span><span class="p">:</span> 
			<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">allVariables</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">v</span> <span class="o">+</span><span class="s1">&#39; (selected)&#39;</span>
				<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">v</span>
	<span class="n">options</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_options</span><span class="p">)</span> 		<span class="c1">#: Print out eligible variables for output.</span>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="nb">print</span> <span class="s1">&#39;Contour output requested (&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39; format): &#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;    every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep_interval</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; timesteps&#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;    every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_interval</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; days&#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;    for variables:&#39;</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)):</span>
			<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="n">var</span>
		<span class="nb">print</span> 
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span> 				<span class="c1">#: Print out information about the attribute.</span>
	<span class="k">def</span> <span class="nf">_get_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span>
	<span class="k">def</span> <span class="nf">_set_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="n">value</span>
	<span class="nb">format</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_format</span><span class="p">,</span> <span class="n">_set_format</span><span class="p">)</span> <span class="c1">#: (*str*) File format for contour output: &#39;tec&#39;, &#39;surf&#39;, &#39;avs&#39;, &#39;avsx&#39;</span>
	<span class="k">def</span> <span class="nf">_get_time_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span>
	<span class="k">def</span> <span class="nf">_set_time_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">time_interval</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time_interval</span><span class="p">,</span> <span class="n">_set_time_interval</span><span class="p">)</span> <span class="c1">#: (*flt*) Time interval to output data.</span>
	<span class="k">def</span> <span class="nf">_get_timestep_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span>
	<span class="k">def</span> <span class="nf">_set_timestep_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">timestep_interval</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_timestep_interval</span><span class="p">,</span> <span class="n">_set_timestep_interval</span><span class="p">)</span> <span class="c1">#: (*int*) Time step interval to output data.</span>
	<span class="k">def</span> <span class="nf">_get_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>
	<span class="k">def</span> <span class="nf">_set_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">variables</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_variables</span><span class="p">,</span> <span class="n">_set_variables</span><span class="p">)</span> <span class="c1">#: (*lst[str]*)List of variables to write contour data for, e.g., [&#39;temperature&#39;,&#39;pressure&#39;]</span>
	<span class="k">def</span> <span class="nf">_get_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zones</span>
	<span class="k">def</span> <span class="nf">_set_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zones</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zones</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zones</span><span class="p">,</span> <span class="n">_set_zones</span><span class="p">)</span> <span class="c1">#: (*lst[fzone]*) List of zone objects for which contour data is to be written - **NOT FULLY SUPPORTED**.</span>
	<span class="k">def</span> <span class="nf">_get_time_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_flag</span>
	<span class="k">def</span> <span class="nf">_set_time_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_flag</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">time_flag</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time_flag</span><span class="p">,</span> <span class="n">_set_time_flag</span><span class="p">)</span> <span class="c1">#: (*bool*) Set to True to include in output title.</span></div>
<div class="viewcode-block" id="fhist"><a class="viewcode-back" href="../fdata.html#fdata.fhist">[docs]</a><span class="k">class</span> <span class="nc">fhist</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM history output object.</span>
	<span class="sd">&quot;&quot;&quot;FEHM history output object.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_format&#39;</span><span class="p">,</span><span class="s1">&#39;_timestep_interval&#39;</span><span class="p">,</span><span class="s1">&#39;_time_interval&#39;</span><span class="p">,</span><span class="s1">&#39;_variables&#39;</span><span class="p">,</span><span class="s1">&#39;_nodelist&#39;</span><span class="p">,</span><span class="s1">&#39;_zonelist&#39;</span><span class="p">,</span><span class="s1">&#39;_zoneflux&#39;</span><span class="p">,</span><span class="s1">&#39;_azonelist&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">hist_format</span><span class="p">,</span><span class="n">timestep_interval</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">time_interval</span><span class="o">=</span><span class="mf">1.e30</span><span class="p">,</span><span class="n">variables</span><span class="o">=</span><span class="p">[],</span><span class="n">nodelist</span><span class="o">=</span><span class="p">[],</span><span class="n">zonelist</span><span class="o">=</span><span class="p">[],</span><span class="n">zoneflux</span><span class="o">=</span><span class="p">[],</span><span class="n">azonelist</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="nb">format</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span><span class="o">=</span><span class="n">timestep_interval</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span><span class="o">=</span><span class="n">time_interval</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_variables</span><span class="o">=</span><span class="p">[]</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="n">nodelist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="n">nodelist</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="n">zonelist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="n">zonelist</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zoneflux</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="n">zoneflux</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zoneflux</span> <span class="o">=</span> <span class="n">zoneflux</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_azonelist</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">if</span> <span class="n">azonelist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_azonelist</span> <span class="o">=</span> <span class="n">azonelist</span>
		<span class="k">if</span> <span class="n">variables</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="o">=</span><span class="n">variables</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">retStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">+</span> <span class="s1">&#39; history output:</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
			<span class="n">retStr</span> <span class="o">+=</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">return</span> <span class="n">retStr</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_options</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 							<span class="c1">#print out available variables</span>
		<span class="nb">print</span> <span class="s1">&#39;The following are acceptable variables&#39;</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">history_variables</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="nb">print</span> <span class="n">var</span> <span class="o">+</span><span class="s1">&#39; (selected)&#39;</span>
			<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="n">var</span>
	<span class="n">options</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_options</span><span class="p">)</span> 		<span class="c1">#: Print out eligible variables for output.</span>
	<span class="k">def</span> <span class="nf">_get_nodelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span>
	<span class="k">def</span> <span class="nf">_set_nodelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">nodelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nodelist</span><span class="p">,</span> <span class="n">_set_nodelist</span><span class="p">)</span> <span class="c1">#: (*list[fnode]*) list of node objects for which history output requested.</span>
	<span class="k">def</span> <span class="nf">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">nd</span><span class="p">)</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
	<span class="n">node</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_node</span><span class="p">)</span> <span class="c1">#: (*dict[fnode]*) Dictionary of nodes, indexed by node number, for which history output requested.</span>
	<span class="k">def</span> <span class="nf">_get_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span>
	<span class="k">def</span> <span class="nf">_set_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zonelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zonelist</span><span class="p">,</span> <span class="n">_set_zonelist</span><span class="p">)</span> <span class="c1">#: (*lst[fzone]*) List of zone objects for which history output required.</span>
	<span class="k">def</span> <span class="nf">_get_zoneflux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zoneflux</span>
	<span class="k">def</span> <span class="nf">_set_zoneflux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zoneflux</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zoneflux</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zoneflux</span><span class="p">,</span> <span class="n">_set_zoneflux</span><span class="p">)</span> <span class="c1">#: (*lst[fzone,int]*) List of zone objects for which zone flux output required.</span>
	<span class="k">def</span> <span class="nf">_get_azonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_azonelist</span>
	<span class="k">def</span> <span class="nf">_set_azonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_azonelist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">azonelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_azonelist</span><span class="p">,</span> <span class="n">_set_azonelist</span><span class="p">)</span> <span class="c1">#: (*lst[fzone]*) List of zone objects for which zone history output required.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">zn</span><span class="p">)</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]</span><span class="o">+</span><span class="p">[(</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">zn</span><span class="p">)</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">])</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">)</span> <span class="c1">#: (*dict[fzone]*) Dictionary of zones, indexed by number and name, for which history output is required.</span>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="nb">print</span> <span class="s1">&#39;History output requested (&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39; format): &#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep_interval</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    every timestep&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep_interval</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; timesteps&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_interval</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="mf">1.e30</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; days&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    every &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_interval</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; days&#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;    for variables:&#39;</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variables</span><span class="p">)):</span>
			<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="n">var</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    at nodes:&#39;</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    for nodes in zones:&#39;</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> 
					<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">azonelist</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;    for zones:&#39;</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">azonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> 
					<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="nb">print</span> <span class="s1">&#39;         &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="nb">print</span> 
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span> 				<span class="c1">#: Print out information about the attribute.</span>
	<span class="k">def</span> <span class="nf">_get_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span>
	<span class="k">def</span> <span class="nf">_set_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variables</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">variables</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_variables</span><span class="p">,</span> <span class="n">_set_variables</span><span class="p">)</span> <span class="c1">#: (*lst[str]*)List of variables to write contour data for, e.g., [&#39;temperature&#39;,&#39;pressure&#39;]</span>
	<span class="k">def</span> <span class="nf">_get_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span>
	<span class="k">def</span> <span class="nf">_set_format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="n">value</span>
	<span class="nb">format</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_format</span><span class="p">,</span> <span class="n">_set_format</span><span class="p">)</span> <span class="c1">#: (*str*) File format for contour output: &#39;tecplot&#39;, &#39;csv&#39;, &#39;surfer&#39;</span>
	<span class="k">def</span> <span class="nf">_get_timestep_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span>
	<span class="k">def</span> <span class="nf">_set_timestep_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestep_interval</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">timestep_interval</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_timestep_interval</span><span class="p">,</span> <span class="n">_set_timestep_interval</span><span class="p">)</span> <span class="c1">#: (*int*) Time step interval to output data.</span>
	<span class="k">def</span> <span class="nf">_get_time_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span>
	<span class="k">def</span> <span class="nf">_set_time_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time_interval</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">time_interval</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time_interval</span><span class="p">,</span> <span class="n">_set_time_interval</span><span class="p">)</span> <span class="c1">#: (*flt*) Time interval to output data.</span></div>
<div class="viewcode-block" id="fboun"><a class="viewcode-back" href="../fdata.html#fdata.fboun">[docs]</a><span class="k">class</span> <span class="nc">fboun</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM boundary condition object.</span>
	<span class="sd">&#39;&#39;&#39;Boundary condition object.</span>
<span class="sd">	</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="p">[],</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ti&#39;</span><span class="p">,</span><span class="n">times</span><span class="o">=</span><span class="p">[],</span><span class="n">variable</span><span class="o">=</span><span class="p">[],</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="p">[]</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>				
		<span class="k">if</span> <span class="n">zone</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">=</span><span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span> 				
		<span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">=</span><span class="n">times</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="p">[]</span>			
		<span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">file</span>	
		<span class="k">if</span> <span class="n">variable</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">variable</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">retStr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s1">&#39; BC: variable = &#39;</span> 
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">:</span> <span class="n">retStr</span> <span class="o">+=</span> <span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
		<span class="k">return</span> <span class="n">retStr</span>
	<span class="k">def</span> <span class="nf">_get_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;Boundary condition for zones: &#39;</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> 
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="nb">print</span> <span class="n">prntStr</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_information</span><span class="p">)</span>	<span class="c1">#: Print information about the boundary condition object.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>	<span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">,]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span><span class="n">_set_zone</span><span class="p">)</span><span class="c1">#: (*lst[fzone]*) List of zones to which the boundary condition is to be applied.</span>
	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">value</span>
	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span><span class="n">_set_type</span><span class="p">)</span><span class="c1">#: (*str*) Boundary condition type, &#39;ti&#39; = step changes, &#39;ti_linear&#39; = linear changes.</span>
	<span class="k">def</span> <span class="nf">_get_n_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> 
	<span class="n">n_times</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_n_times</span><span class="p">)</span><span class="c1">#: (*int*) Length of time-series.</span>
	<span class="k">def</span> <span class="nf">_get_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span>
	<span class="k">def</span> <span class="nf">_set_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">variable</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_variable</span><span class="p">,</span><span class="n">_set_variable</span><span class="p">)</span><span class="c1">#: (*lst[lst[str,fl64,...]]*) List of lists of boundary data. Each list begins with a string denoting the boundary condition variable, and is followed by the time-series data, e.g., [&#39;sw&#39;,0.2,0.5,0.8].</span>
	<span class="k">def</span> <span class="nf">_get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span>
	<span class="k">def</span> <span class="nf">_set_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">=</span><span class="n">value</span>
	<span class="n">times</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_times</span><span class="p">,</span><span class="n">_set_times</span><span class="p">)</span><span class="c1">#: (*lst[fl64]*) Vector of times.</span>
	<span class="k">def</span> <span class="nf">_get_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span>
	<span class="k">def</span> <span class="nf">_set_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">file</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_file</span><span class="p">,</span><span class="n">_set_file</span><span class="p">)</span><span class="c1">#: (*str*) File string where information about the macro is stored. If file does not currently exist, it will be created and written to when the FEHM input file is written.</span>
	<span class="k">def</span> <span class="nf">_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># check length of variable vectors correspond to length of time vectors</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_variable</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Variable vector (&#39;</span><span class="o">+</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;) specified in BOUN macro shorter than time vector.&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Variable vector (&#39;</span><span class="o">+</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;) specified in BOUN macro longer than time vector.&#39;</span><span class="p">)</span></div>
<div class="viewcode-block" id="frlpm"><a class="viewcode-back" href="../fdata.html#fdata.frlpm">[docs]</a><span class="k">class</span> <span class="nc">frlpm</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1">#FEHM relative permeability object (different to rlp macro).</span>
	<span class="sd">&#39;&#39;&#39;Relative permeability model.</span>
<span class="sd">	</span>
<span class="sd">	Relative permeability models are applied to zones. Each model assigns the relative permeability characteristics</span>
<span class="sd">	for a particular phase (in attribute relperm) and capillary pressure relationships between phases (in attribute capillary).</span>
<span class="sd">	In contrast to other macros, one relative permeability model may be applied to multiple zones.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="p">[],</span><span class="n">group</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">relperm</span><span class="o">=</span><span class="p">[],</span><span class="n">capillary</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="k">if</span> <span class="n">zone</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">group</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">group</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_relperm</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="n">relperm</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_relperm</span><span class="p">(</span><span class="n">relperm</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">if</span> <span class="n">capillary</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_capillary</span><span class="p">(</span><span class="n">capillary</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;rlpm: &#39;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span> 
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; ,&#39;</span>
			<span class="n">prntStr</span> <span class="o">=</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span>
			<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span>	<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;)&#39;</span>
		<span class="k">return</span> <span class="n">prntStr</span>
	<span class="k">def</span> <span class="nf">_assign_relperm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">relperms</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">relperm</span> <span class="ow">in</span> <span class="n">relperms</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">relperm</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">relperm</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">relperm</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;relperms specified incorrectly&#39;</span><span class="p">;</span> <span class="k">continue</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add_relperm</span><span class="p">(</span><span class="n">relperm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">relperm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">relperm</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
	<span class="k">def</span> <span class="nf">_assign_capillary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">capillarys</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">capillary</span> <span class="ow">in</span> <span class="n">capillarys</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">capillary</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">capillary</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">capillary</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;capillarys specified incorrectly&#39;</span><span class="p">;</span> <span class="k">continue</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add_capillary</span><span class="p">(</span><span class="n">capillary</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">capillary</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">capillary</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<div class="viewcode-block" id="frlpm.add_relperm"><a class="viewcode-back" href="../fdata.html#fdata.frlpm.add_relperm">[docs]</a>	<span class="k">def</span> <span class="nf">add_relperm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">[]):</span>
		<span class="sd">&#39;&#39;&#39;Add a new relative permeability model for a given phase.</span>
<span class="sd">		</span>
<span class="sd">		:param phase: Phase for which the relperm model is being defined, e.g., &#39;air&#39;,&#39;water&#39;,&#39;co2_liquid&#39;,&#39;co2_gas&#39;,&#39;vapor&#39;.</span>
<span class="sd">		:type phase: str</span>
<span class="sd">		:param type: Type of model being assigned for that phase, e.g., &#39;constant&#39;,&#39;linear&#39;,&#39;exponential&#39;,&#39;corey&#39;,&#39;brooks-corey&#39;,&#39;vg&#39; (Van Genuchten).</span>
<span class="sd">		:type type: str</span>
<span class="sd">		:param param: List of parameters for the specified model. See table above for a list of parameter names for each model.</span>
<span class="sd">		:type param: list</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span>
			<span class="n">new_relperm</span> <span class="o">=</span> <span class="n">_relperm</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">param</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">new_relperm</span> <span class="o">=</span> <span class="n">_relperm</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_relperm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">new_relperm</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span><span class="n">new_relperm</span><span class="p">),)))</span></div>
<div class="viewcode-block" id="frlpm.add_capillary"><a class="viewcode-back" href="../fdata.html#fdata.frlpm.add_capillary">[docs]</a>	<span class="k">def</span> <span class="nf">add_capillary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">[]):</span>
		<span class="sd">&#39;&#39;&#39;Add a new capillary pressure relationship between two phases.</span>
<span class="sd">		</span>
<span class="sd">		:param phase: List or tuple of two phases for which the relationship is defined, e.g., [&#39;air&#39;,&#39;water&#39;].</span>
<span class="sd">		:type phase: list, tuple</span>
<span class="sd">		:param type: Type of model being assigned for that phase pair, e.g., &#39;linear_cap&#39;,&#39;vg_cap&#39;,&#39;brooks-corey_cap&#39;.</span>
<span class="sd">		:type type: str</span>
<span class="sd">		:param param: List of parameters for the specified model. See table above for a list of parameter names for each model.</span>
<span class="sd">		:type param: list</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span>
			<span class="n">new_capillary</span> <span class="o">=</span> <span class="n">_relperm</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">param</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">new_capillary</span> <span class="o">=</span> <span class="n">_relperm</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">new_capillary</span><span class="o">.</span><span class="n">phase</span><span class="p">,</span><span class="n">new_capillary</span><span class="p">),)))</span></div>
<div class="viewcode-block" id="frlpm.delete"><a class="viewcode-back" href="../fdata.html#fdata.frlpm.delete">[docs]</a>	<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Delete a previously defined relative permeability or capillary pressure model.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">_relperm</span><span class="p">):</span> <span class="n">model</span> <span class="o">=</span> <span class="n">relperm</span><span class="o">.</span><span class="n">phase</span>
		<span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relperm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relperm</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span><span class="o">.</span><span class="fm">__delitem__</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></div>
	<span class="k">def</span> <span class="nf">_get_relperm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_relperm</span>
	<span class="n">relperm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_relperm</span><span class="p">)</span> <span class="c1">#: (*dict*) Dictionary of relative permeability models for each phase, indexed by phase name, e.g., &#39;water&#39;. Each relperm model has a model type, and set of parameters for that type.</span>
	<span class="k">def</span> <span class="nf">_get_capillary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span>
	<span class="n">capillary</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_capillary</span><span class="p">)</span> <span class="c1">#: (*dict*) Dictionary of capillary pressure models, indexed by a tuple phase name pair, e.g., (&#39;water/air&#39;). Each capillary pressure model has a model type, and set of parameters for that type.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span> <span class="n">_set_zone</span><span class="p">)</span> <span class="c1">#: (*fzone*) Zone or list of zones to which the relative permeability model is assigned.</span>
	<span class="k">def</span> <span class="nf">_get_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span>
	<span class="k">def</span> <span class="nf">_set_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">group</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_group</span><span class="p">,</span> <span class="n">_set_group</span><span class="p">)</span> <span class="c1">#: (*int*) Group assignment for the relative permeability model.</span>
	<span class="k">def</span> <span class="nf">_get_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">relperm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="p">[]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">relperm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">phase</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">relperm</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
	<span class="n">phases</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phases</span><span class="p">)</span></div>
<span class="k">class</span> <span class="nc">_relperm</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> 						<span class="c1"># private class for relative permeability model</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">phase</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="nb">type</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">phase</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_assign_param</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">param</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_param</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> 	
	<span class="k">def</span> <span class="nf">_assign_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Assign parameters if supplied on initialisation.&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">rlpm_dicts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">])</span>
	<span class="k">def</span> <span class="nf">_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">param</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="k">return</span>		<span class="c1"># return if numbers don&#39;t match up</span>
		<span class="k">for</span> <span class="n">par</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">rlpm_dicts</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_param</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">par</span>
	<span class="k">def</span> <span class="nf">_get_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase</span>
	<span class="k">def</span> <span class="nf">_set_phase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rlpm_phases</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; not an available phase.&#39;</span><span class="p">);</span><span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">phase</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phase</span><span class="p">,</span> <span class="n">_set_phase</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
	<span class="k">def</span> <span class="nf">_set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rlpm_dicts</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; not an available model.&#39;</span><span class="p">);</span><span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_param</span> <span class="o">=</span> <span class="n">rlpm_dicts</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
	<span class="nb">type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_type</span><span class="p">,</span> <span class="n">_set_type</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param</span>
	<span class="n">param</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_param</span><span class="p">)</span> <span class="c1">#: (**)		</span>
<span class="k">class</span> <span class="nc">frlpm_table</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1"># different object for specifying tables</span>
	<span class="sd">&quot;&quot;&quot;Specify relative permeablity relationships using a lookup table. </span>
<span class="sd">	</span>
<span class="sd">	Lookup tables can offer computational time savings where the relative permeability function is difficult to calculate.</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="p">[],</span> <span class="n">group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">saturation</span><span class="o">=</span><span class="p">[],</span> <span class="n">phase1</span> <span class="o">=</span>  <span class="p">[],</span> <span class="n">phase2</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">capillary</span><span class="o">=</span><span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zone</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="k">if</span> <span class="n">zone</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">group</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">group</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">saturation</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span> <span class="o">=</span> <span class="n">saturation</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_phase1</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="s1">&#39;h2o_liquid&#39;</span><span class="p">,</span><span class="s1">&#39;air&#39;</span><span class="p">,</span><span class="s1">&#39;h2o_gas&#39;</span><span class="p">,</span><span class="s1">&#39;vapor&#39;</span><span class="p">,</span><span class="s1">&#39;co2_gas&#39;</span><span class="p">,</span><span class="s1">&#39;co2_liquid&#39;</span><span class="p">,</span><span class="s1">&#39;co2_sc&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">phase1</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">phase1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: first entry of phase1 must be one of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: no saturation data supplied&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: length of supplied phase1 relperm vector does not match saturation data&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_phase1</span> <span class="o">=</span> <span class="n">phase1</span>
		<span class="k">if</span> <span class="n">phase2</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">phase2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: first entry of phase2 must be one of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">vars</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: no saturation data supplied&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase1</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: length of supplied phase2 relperm vector does not match saturation data&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_phase2</span> <span class="o">=</span> <span class="n">phase2</span>
		<span class="k">if</span> <span class="n">capillary</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: no saturation data supplied&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">capillary</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span><span class="p">):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: length of supplied capillary vector does not match saturation data&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span> <span class="o">=</span> <span class="n">capillary</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>	
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span>
	<span class="k">def</span> <span class="nf">_set_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">,</span> <span class="n">_set_zone</span><span class="p">)</span> <span class="c1">#: (*fzone*) Zone or list of zones to which the relative permeability model is assigned.</span>
	<span class="k">def</span> <span class="nf">_get_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span>
	<span class="k">def</span> <span class="nf">_set_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_group</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">group</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_group</span><span class="p">,</span> <span class="n">_set_group</span><span class="p">)</span> <span class="c1">#: (*int*) Group assignment for the relative permeability model.</span>
	<span class="k">def</span> <span class="nf">_get_saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span>
	<span class="k">def</span> <span class="nf">_set_saturation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_saturation</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">saturation</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_saturation</span><span class="p">,</span> <span class="n">_set_saturation</span><span class="p">)</span> <span class="c1">#: (*lst*) List or array of saturation values for which relperm data are supplied.</span>
	<span class="k">def</span> <span class="nf">_get_phase1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase1</span>
	<span class="k">def</span> <span class="nf">_set_phase1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase1</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">phase1</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phase1</span><span class="p">,</span> <span class="n">_set_phase1</span><span class="p">)</span> <span class="c1">#: (*lst*) A two item list containing a string denoting the wetting phase, e.g., &#39;water&#39;,&#39;co2_liquid&#39;, and a vector of relperm data corresponding to the values in the saturation attribute.</span>
	<span class="k">def</span> <span class="nf">_get_phase2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase2</span>
	<span class="k">def</span> <span class="nf">_set_phase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phase2</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">phase2</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phase2</span><span class="p">,</span> <span class="n">_set_phase2</span><span class="p">)</span> <span class="c1">#: (*lst*) A two item list containing a string denoting the non-wetting phase, e.g., &#39;water&#39;,&#39;co2_liquid&#39;, and a vector of relperm data corresponding to the values in the saturation attribute.</span>
	<span class="k">def</span> <span class="nf">_get_capillary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span>
	<span class="k">def</span> <span class="nf">_set_capillary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_capillary</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">capillary</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_capillary</span><span class="p">,</span> <span class="n">_set_capillary</span><span class="p">)</span> <span class="c1">#: (*lst*) List or array of capillary pressure values corresponding to the supplied saturation data for the phase pair.def _get_phases:</span>
	<span class="k">def</span> <span class="nf">_get_phases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">phs</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase1</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">phs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase2</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">phs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phase2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">phs</span>
	<span class="n">phases</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_phases</span><span class="p">)</span> 	<span class="c1">#: (*lst*) List of phases for which relperm properties have been defined.</span>
<div class="viewcode-block" id="files"><a class="viewcode-back" href="../fdata.html#fdata.files">[docs]</a><span class="k">class</span> <span class="nc">files</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM file constructor.</span>
	<span class="sd">&#39;&#39;&#39;Class containing information necessary to write out fehmn.files.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_root&#39;</span><span class="p">,</span><span class="s1">&#39;_input&#39;</span><span class="p">,</span><span class="s1">&#39;_grid&#39;</span><span class="p">,</span><span class="s1">&#39;_incon&#39;</span><span class="p">,</span><span class="s1">&#39;_use_incon&#39;</span><span class="p">,</span><span class="s1">&#39;_rsto&#39;</span><span class="p">,</span><span class="s1">&#39;_use_rsto&#39;</span><span class="p">,</span><span class="s1">&#39;_outp&#39;</span><span class="p">,</span><span class="s1">&#39;_use_outp&#39;</span><span class="p">,</span><span class="s1">&#39;_check&#39;</span><span class="p">,</span>
		<span class="s1">&#39;_use_check&#39;</span><span class="p">,</span><span class="s1">&#39;_hist&#39;</span><span class="p">,</span><span class="s1">&#39;_use_hist&#39;</span><span class="p">,</span><span class="s1">&#39;_co2in&#39;</span><span class="p">,</span><span class="s1">&#39;_use_co2in&#39;</span><span class="p">,</span><span class="s1">&#39;_stor&#39;</span><span class="p">,</span><span class="s1">&#39;_use_stor&#39;</span><span class="p">,</span><span class="s1">&#39;_parent&#39;</span><span class="p">,</span><span class="s1">&#39;_exe&#39;</span><span class="p">,</span><span class="s1">&#39;_co2_inj_time&#39;</span><span class="p">,</span>
		<span class="s1">&#39;_nopf&#39;</span><span class="p">,</span><span class="s1">&#39;_use_nopf&#39;</span><span class="p">,</span><span class="s1">&#39;_error&#39;</span><span class="p">,</span><span class="s1">&#39;_use_error&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">root</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">incon</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">rsto</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">outp</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">hist</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">co2in</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">stor</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">exe</span><span class="o">=</span><span class="s1">&#39;fehm.exe&#39;</span><span class="p">,</span><span class="n">co2_inj_time</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_input</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_incon</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_incon</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rsto</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_rsto</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_outp</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_outp</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_check</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_hist</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_hist</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_co2in</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_co2in</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_stor</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_stor</span> <span class="o">=</span> <span class="kc">False</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_nopf</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_nopf</span> <span class="o">=</span> <span class="kc">False</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_error</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_error</span> <span class="o">=</span> <span class="kc">False</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_exe</span> <span class="o">=</span> <span class="n">exe</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_co2_inj_time</span> <span class="o">=</span> <span class="n">co2_inj_time</span>
		<span class="k">if</span> <span class="n">root</span><span class="p">:</span>  	<span class="c1"># if root specified assign as default for all inputs.</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_assign_root</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">input</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input</span> <span class="o">=</span> <span class="nb">input</span>
		<span class="k">if</span> <span class="n">grid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">grid</span>
		<span class="k">if</span> <span class="n">incon</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_incon</span> <span class="o">=</span> <span class="n">incon</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_incon</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">rsto</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rsto</span> <span class="o">=</span> <span class="n">rsto</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_rsto</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">outp</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outp</span> <span class="o">=</span> <span class="n">outp</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_outp</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">check</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="n">check</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_check</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">hist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hist</span> <span class="o">=</span> <span class="n">hist</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_hist</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">stor</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stor</span> <span class="o">=</span> <span class="n">stor</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_stor</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="s1">&#39;fehmn.files constructor&#39;</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_assign_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Use root name for all inputs.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">root</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_input</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.dat&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.inp&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rsto</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.fin&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_outp</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.out&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.chk&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_hist</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.his&#39;</span>
<div class="viewcode-block" id="files.write"><a class="viewcode-back" href="../fdata.html#fdata.files.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Write out *fehmn.files*.</span>
<span class="sd">		&#39;&#39;&#39;</span>		
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span>
			<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="s1">&#39;fehmn.files&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;fehmn.files&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
			
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;input: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">use_paths</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;grida: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;grida: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsto</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.rsto&#39;</span> 			<span class="c1"># default is to produce a restart file</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;rsto: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">rsto</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_outp</span><span class="p">:</span> 
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">outp</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">outp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.outp&#39;</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;outp: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">outp</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_check</span><span class="p">:</span> 
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.chk&#39;</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;check: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;rsti:&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_hist</span><span class="p">:</span> 
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.hst&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;hist: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2in</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_use_co2in</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="n">co2_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">()</span>
			<span class="n">co2_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">co2_interp_path</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">co2_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">):</span>
				<span class="n">co2_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">co2_interp_path_2</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">co2_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">):</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Cant find co2_interp.txt&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_use_co2in</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2in</span><span class="p">:</span>
			<span class="n">co2_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">()</span>
			<span class="n">co2_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2in</span>
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_co2in</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;co2in: &#39;</span><span class="o">+</span><span class="n">co2_path</span><span class="o">.</span><span class="n">full_path</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_nopf</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nopf: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_nopf</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_error</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;error: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_error</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_stor</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stor:&#39;</span><span class="p">)</span>	
			<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stor</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">stor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.stor&#39;</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">stor</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;root:&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
		
		<span class="c1"># level of print screen output</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">all</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">none</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

		<span class="c1"># Set secret flag to use co2_inj.txt file to specify time to stop injection</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2_inj_time</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: CO2 injection flag requested but no carb macro specified, CO2 injection flag will be ignored.&#39;</span><span class="p">)</span> 
			<span class="k">else</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;999</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span>
					<span class="n">co2_inj_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="s1">&#39;co2_inj.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;co2_inj.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

				<span class="n">co2_inj_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">co2_inj_time</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">co2_inj_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

		<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>
	<span class="k">def</span> <span class="nf">_get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input</span>
	<span class="k">def</span> <span class="nf">_set_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  
		<span class="bp">self</span><span class="o">.</span><span class="n">_input</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	<span class="nb">input</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_input</span><span class="p">,</span><span class="n">_set_input</span><span class="p">)</span> <span class="c1">#: (*str*) Name of input file. This is set automatically when reading an input file in PyFEHM or when running a simulation.</span>
	<span class="k">def</span> <span class="nf">_get_root</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_root</span>
	<span class="k">def</span> <span class="nf">_set_root</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  
		<span class="bp">self</span><span class="o">.</span><span class="n">_root</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">outp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">+</span><span class="s1">&#39;.outp&#39;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">+</span><span class="s1">&#39;.chk&#39;</span>
	<span class="n">root</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_root</span><span class="p">,</span><span class="n">_set_root</span><span class="p">)</span>	<span class="c1">#: (*str*) Default file name string. If not already specified, this is set automatically when running a simulation.</span>
	<span class="k">def</span> <span class="nf">_get_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
	<span class="k">def</span> <span class="nf">_set_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">grid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_grid</span><span class="p">,</span><span class="n">_set_grid</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of grid file. This is set automatically when reading an grid file in PyFEHM.</span>
	<span class="k">def</span> <span class="nf">_get_incon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_incon</span>
	<span class="k">def</span> <span class="nf">_set_incon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_incon</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_incon</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">incon</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_incon</span><span class="p">,</span><span class="n">_set_incon</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of restart file to read in (initial condition). This is set automatically when reading an incon file in PyFEHM.</span>
	<span class="k">def</span> <span class="nf">_get_rsto</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rsto</span>
	<span class="k">def</span> <span class="nf">_set_rsto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_rsto</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">rsto</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rsto</span><span class="p">,</span><span class="n">_set_rsto</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of restart file to write out.</span>
	<span class="k">def</span> <span class="nf">_get_outp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_outp</span>
	<span class="k">def</span> <span class="nf">_set_outp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_outp</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_outp</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">outp</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_outp</span><span class="p">,</span><span class="n">_set_outp</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of output file.</span>
	<span class="k">def</span> <span class="nf">_get_nopf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nopf</span>
	<span class="k">def</span> <span class="nf">_set_nopf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_nopf</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_nopf</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">nopf</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nopf</span><span class="p">,</span><span class="n">_set_nopf</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of nopf file.</span>
	<span class="k">def</span> <span class="nf">_get_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check</span>
	<span class="k">def</span> <span class="nf">_set_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_check</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">check</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_check</span><span class="p">,</span><span class="n">_set_check</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of check file.</span>
	<span class="k">def</span> <span class="nf">_get_co2in</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_co2in</span>
	<span class="k">def</span> <span class="nf">_set_co2in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_co2in</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_co2in</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="n">co2in</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2in</span><span class="p">,</span> <span class="n">_set_co2in</span><span class="p">)</span> <span class="c1">#: (*str*) Name or path to co2 properties file</span>
	<span class="k">def</span> <span class="nf">_get_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hist</span>
	<span class="k">def</span> <span class="nf">_set_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_hist</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">hist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hist</span><span class="p">,</span><span class="n">_set_hist</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of history file.</span>
	<span class="k">def</span> <span class="nf">_get_stor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stor</span>
	<span class="k">def</span> <span class="nf">_set_stor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  
		<span class="bp">self</span><span class="o">.</span><span class="n">_stor</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_use_stor</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
	<span class="n">stor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_stor</span><span class="p">,</span><span class="n">_set_stor</span><span class="p">)</span>	<span class="c1">#: (*str*) Name of store file.</span>
	<span class="k">def</span> <span class="nf">_get_exe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exe</span>
	<span class="k">def</span> <span class="nf">_set_exe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_exe</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">exe</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_exe</span><span class="p">,</span><span class="n">_set_exe</span><span class="p">)</span><span class="c1">#: (*str*) Path to FEHM executable. Default is &#39;fehm.exe&#39;.</span>
	<span class="k">def</span> <span class="nf">_get_co2_inj_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_co2_inj_time</span>	
	<span class="k">def</span> <span class="nf">_set_co2_inj_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>  <span class="bp">self</span><span class="o">.</span><span class="n">_co2_inj_time</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">co2_inj_time</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2_inj_time</span><span class="p">,</span><span class="n">_set_co2_inj_time</span><span class="p">)</span><span class="c1">#: (*fl64*) Number of years at which FEHM will terminate co2 injection</span></div>
<div class="viewcode-block" id="fdata"><a class="viewcode-back" href="../fdata.html#fdata.fdata">[docs]</a><span class="k">class</span> <span class="nc">fdata</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>						<span class="c1">#FEHM data file.</span>
	<span class="sd">&quot;&quot;&quot;Class for FEHM data file. </span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>		
	<span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_silent&#39;</span><span class="p">,</span><span class="s1">&#39;_gridfilename&#39;</span><span class="p">,</span><span class="s1">&#39;_inconfilename&#39;</span><span class="p">,</span><span class="s1">&#39;_sticky_zones&#39;</span><span class="p">,</span><span class="s1">&#39;_allMacro&#39;</span><span class="p">,</span><span class="s1">&#39;_allModel&#39;</span><span class="p">,</span><span class="s1">&#39;_associate&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_bounlist&#39;</span><span class="p">,</span><span class="s1">&#39;_cont&#39;</span><span class="p">,</span><span class="s1">&#39;_ctrl&#39;</span><span class="p">,</span><span class="s1">&#39;_grid&#39;</span><span class="p">,</span><span class="s1">&#39;_incon&#39;</span><span class="p">,</span><span class="s1">&#39;_hist&#39;</span><span class="p">,</span><span class="s1">&#39;_iter&#39;</span><span class="p">,</span><span class="s1">&#39;_nfinv&#39;</span><span class="p">,</span><span class="s1">&#39;_nobr&#39;</span><span class="p">,</span><span class="s1">&#39;_head&#39;</span><span class="p">,</span><span class="s1">&#39;_flxn&#39;</span><span class="p">,</span><span class="s1">&#39;_vapl&#39;</span><span class="p">,</span><span class="s1">&#39;_adif&#39;</span><span class="p">,</span><span class="s1">&#39;_rlpmlist&#39;</span><span class="p">,</span><span class="s1">&#39;_sol&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_time&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;_times&#39;</span><span class="p">,</span><span class="s1">&#39;_zonelist&#39;</span><span class="p">,</span><span class="s1">&#39;_writeSubFiles&#39;</span><span class="p">,</span><span class="s1">&#39;_strs&#39;</span><span class="p">,</span><span class="s1">&#39;_ngas&#39;</span><span class="p">,</span><span class="s1">&#39;_carb&#39;</span><span class="p">,</span><span class="s1">&#39;_trac&#39;</span><span class="p">,</span><span class="s1">&#39;_files&#39;</span><span class="p">,</span><span class="s1">&#39;_verbose&#39;</span><span class="p">,</span><span class="s1">&#39;_general_macrolist&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_tf&#39;</span><span class="p">,</span><span class="s1">&#39;_ti&#39;</span><span class="p">,</span><span class="s1">&#39;_dti&#39;</span><span class="p">,</span><span class="s1">&#39;_dtmin&#39;</span><span class="p">,</span><span class="s1">&#39;_dtmax&#39;</span><span class="p">,</span><span class="s1">&#39;_dtn&#39;</span><span class="p">,</span><span class="s1">&#39;_dtx&#39;</span><span class="p">,</span><span class="s1">&#39;_sections&#39;</span><span class="p">,</span><span class="s1">&#39;_help&#39;</span><span class="p">,</span><span class="s1">&#39;_running&#39;</span><span class="p">,</span><span class="s1">&#39;_unparsed_blocks&#39;</span><span class="p">,</span><span class="s1">&#39;keep_unknown&#39;</span><span class="p">,</span><span class="s1">&#39;_flxo&#39;</span><span class="p">,</span>
			<span class="s1">&#39;_output_times&#39;</span><span class="p">,</span><span class="s1">&#39;_path&#39;</span><span class="p">,</span><span class="s1">&#39;_vtk&#39;</span><span class="p">,</span><span class="s1">&#39;_diagnostic&#39;</span><span class="p">,</span><span class="s1">&#39;_storage&#39;</span><span class="p">,</span><span class="s1">&#39;_air&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">gridfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inconfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">sticky_zones</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">,</span><span class="n">associate</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">associate</span><span class="p">,</span><span class="n">work_dir</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
		<span class="n">full_connectivity</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">full_connectivity</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="p">[],</span><span class="n">keep_unknown</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">keep_unknown</span><span class="p">):</span>		<span class="c1">#Initialise data file</span>
		<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_gridfilename</span><span class="o">=</span><span class="n">gridfilename</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_inconfilename</span><span class="o">=</span><span class="n">inconfilename</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_sticky_zones</span> <span class="o">=</span> <span class="n">sticky_zones</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,[])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">key</span><span class="p">,[])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model_list</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_associate</span> <span class="o">=</span> <span class="n">associate</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_bounlist</span> <span class="o">=</span> <span class="p">[]</span>				
		<span class="bp">self</span><span class="o">.</span><span class="n">_cont</span> <span class="o">=</span> <span class="n">fcont</span><span class="p">()</span>				
		<span class="bp">self</span><span class="o">.</span><span class="n">_ctrl</span><span class="o">=</span><span class="n">copy</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">ctrl</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_grid</span><span class="o">=</span><span class="n">fgrid</span><span class="p">()</span>				
		<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_incon</span><span class="o">=</span><span class="n">fincon</span><span class="p">()</span> 			
		<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_storage</span> <span class="o">=</span> <span class="n">fstorage</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_storage</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_hist</span> <span class="o">=</span> <span class="n">fhist</span><span class="p">()</span>				
		<span class="bp">self</span><span class="o">.</span><span class="n">_iter</span><span class="o">=</span><span class="n">copy</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">iter</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nfinv</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_nobr</span> <span class="o">=</span> <span class="kc">False</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_head</span> <span class="o">=</span> <span class="kc">False</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_air</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_flxn</span> <span class="o">=</span> <span class="kc">False</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">_vapl</span> <span class="o">=</span> <span class="kc">False</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">_adif</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="o">=</span><span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_general_macrolist</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_sol</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">sol</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">=</span><span class="p">[]</span>					<span class="c1">#: (*str*) Information about the model printed at the top of the input file.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="o">=</span><span class="n">copy</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">=</span><span class="p">[]</span>					
		<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span><span class="o">=</span><span class="p">[]</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_flxo</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_writeSubFiles</span> <span class="o">=</span> <span class="kc">True</span> 		<span class="c1"># Boolean indicating macro and zone sub files should be written every time</span>
		<span class="c1"># additional modules</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_strs</span> <span class="o">=</span> <span class="n">fstrs</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_carb</span> <span class="o">=</span> <span class="n">fcarb</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_trac</span> <span class="o">=</span> <span class="n">ftrac</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_ngas</span> <span class="o">=</span> <span class="n">fngas</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_help</span> <span class="o">=</span> <span class="n">fhelp</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="c1"># run object</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="n">files</span><span class="p">()</span> 				
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_diagnostic</span> <span class="o">=</span> <span class="n">fdiagnostic</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_running</span> <span class="o">=</span> <span class="kc">False</span> 		<span class="c1"># boolean indicating whether a simulation is in progress</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_unparsed_blocks</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_sections</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">keep_unknown</span> <span class="o">=</span> <span class="n">keep_unknown</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span> <span class="o">=</span> <span class="n">work_dir</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">pass</span>
		<span class="c1"># time stepping shortcuts</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_tf</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_ti</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_day_INITTIME&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dti</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtmin</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtmax</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtn</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtx</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="c1"># add &#39;everything&#39; zone</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_add_zone</span><span class="p">(</span><span class="n">fzone</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
		
		<span class="c1"># OPTIONS</span>
		<span class="n">temp_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">();</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
		<span class="c1"># 1. fehmn.files was passed - assume that the directory in which this file sits is the work directory</span>
		<span class="k">if</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;fehmn.files&#39;</span><span class="p">:</span>
		
			<span class="k">if</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">absolute_to_file</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span> <span class="o">=</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">absolute_to_file</span>
			
			<span class="n">wd</span> <span class="o">=</span> <span class="n">temp_path</span><span class="o">.</span><span class="n">absolute_to_file</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span>
			<span class="n">inconfilename</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;rsti:&#39;</span><span class="p">):</span> 
						<span class="n">inconfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;rsti:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;grida:&#39;</span><span class="p">):</span> 
						<span class="n">gridfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;grida:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;grid:&#39;</span><span class="p">):</span> 
						<span class="n">gridfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;grid:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;gridf:&#39;</span><span class="p">):</span> 
						<span class="n">gridfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;gridf:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;input:&#39;</span><span class="p">):</span> 
						<span class="n">filename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;input:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stor:&#39;</span><span class="p">):</span> 
						<span class="n">storfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;stor:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">stor</span> <span class="o">=</span> <span class="n">storfilename</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stori:&#39;</span><span class="p">):</span> 
						<span class="n">storfilename</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;stori:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">stor</span> <span class="o">=</span> <span class="n">storfilename</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;root:&#39;</span><span class="p">):</span> 
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;root:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;error:&#39;</span><span class="p">):</span> 
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_error</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;error:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_error</span> <span class="o">=</span> <span class="kc">True</span>
					<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;nopf:&#39;</span><span class="p">):</span> 
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_nopf</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;nopf:&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_nopf</span> <span class="o">=</span> <span class="kc">True</span>
			
			<span class="c1"># set up  path objects then pass to read function</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">gridfilename</span>
			<span class="k">if</span> <span class="n">inconfilename</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">full_connectivity</span><span class="o">=</span><span class="n">full_connectivity</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">)</span>
			
		<span class="c1"># 2. nothing passed - no path objects to set up, no reading required</span>
		<span class="k">elif</span> <span class="ow">not</span> <span class="n">filename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">gridfilename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inconfilename</span><span class="p">:</span>
			<span class="k">return</span>
			
		<span class="c1"># 3. input and grid file passed</span>
		<span class="k">elif</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">gridfilename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inconfilename</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">gridfilename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">full_connectivity</span><span class="o">=</span><span class="n">full_connectivity</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">)</span>
			
		<span class="c1"># 4. all passed</span>
		<span class="k">elif</span> <span class="n">filename</span> <span class="ow">and</span> <span class="n">gridfilename</span> <span class="ow">and</span> <span class="n">inconfilename</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">gridfilename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">inconfilename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">full_connectivity</span><span class="o">=</span><span class="n">full_connectivity</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="n">skip</span><span class="p">)</span>
		
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: file configuration not recognized&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">return</span> <span class="s1">&#39;empty object&#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span>			<span class="c1">#Print out details</span>
	<span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">):</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
			<span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.read"><a class="viewcode-back" href="../fdata.html#fdata.fdata.read">[docs]</a>	<span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">gridfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">inconfilename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">full_connectivity</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">full_connectivity</span><span class="p">,</span><span class="n">skip</span><span class="o">=</span><span class="p">[]):</span>			<span class="c1">#Reads data from file.</span>
		<span class="sd">&#39;&#39;&#39;Read FEHM input file and construct fdata object.</span>
<span class="sd">		</span>
<span class="sd">		:param filename: Name of FEHM input file. Alternatively, supplying &#39;fehmn.files&#39; will cause PyFEHM to query this file for input, grid and restart file names if they are available.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param gridfilename: Name of FEHM grid file.</span>
<span class="sd">		:type gridfilename: str</span>
<span class="sd">		:param inconfilename: Name of FEHM restart file.</span>
<span class="sd">		:type inconfilename: str</span>
<span class="sd">		:param skip: List of macro strings to ignore when reading an input file.</span>
<span class="sd">		:type skip: list</span>
<span class="sd">		</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="c1"># set up paths</span>
		<span class="k">if</span> <span class="n">filename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
		<span class="k">if</span> <span class="n">gridfilename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
		<span class="k">if</span> <span class="n">inconfilename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
		
		<span class="c1"># THERE WILL ALWAYS BE A GRID PATH TO READ - INPUT FILES CANNOT BE READ WITHOUT A GRID</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="n">full_connectivity</span><span class="o">=</span><span class="n">full_connectivity</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_incon</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">P</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">number_nodes</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: grid and incon files contain different numbers of nodes&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="n">fincon</span><span class="p">()</span> 	<span class="c1"># empty incon</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>	
				<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_incon</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate_incon</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
			
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;reading input file&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
		<span class="c1">#infile = open(filename,&#39;r&#39;)</span>
		<span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">read_fn</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">fdata_sections</span><span class="p">,</span>
						<span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_cont</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span>
						 <span class="bp">self</span><span class="o">.</span><span class="n">_read_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_ctrl</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_iter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span>
						 <span class="bp">self</span><span class="o">.</span><span class="n">_read_boun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_strs</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_text</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_sol</span><span class="p">,</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_read_nfinv</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_hist</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_histnode</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_carb</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">,</span>
						 <span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_nobr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_flxz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_rlpm</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">,</span>
						 <span class="bp">self</span><span class="o">.</span><span class="n">_read_trac</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_vapl</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_adif</span><span class="p">,</span>
						 <span class="bp">self</span><span class="o">.</span><span class="n">_read_ngas</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_flxo</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_head</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_flxn</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_air</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_air</span><span class="p">]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">=</span><span class="p">[]</span>
		<span class="sd">&quot;&quot;&quot;Need to first establish dimensionality of input file. Requires initial read through.&quot;&quot;&quot;</span>
		<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="n">keyword</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">keyword</span><span class="o">==</span><span class="s1">&#39;ctrl&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_ctrl</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
				<span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>				
		<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		
		<span class="n">infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">precedingKey</span><span class="o">=</span><span class="s1">&#39;start&#39;</span>
		<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="n">keyword</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">fdata_sections</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;reading &#39;</span><span class="o">+</span><span class="n">keyword</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="n">fn</span><span class="o">=</span><span class="n">read_fn</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">keyword</span><span class="p">)</span>
					<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="kc">None</span>
				<span class="k">elif</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">model_list</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">keyword</span><span class="p">)</span>
					<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="kc">None</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">,</span><span class="s1">&#39;zonn&#39;</span><span class="p">]:</span>
						<span class="k">if</span> <span class="s1">&#39;rad&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
							<span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn_rad</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span>
							<span class="n">block</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
							<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">precedingKey</span><span class="p">)</span>
					<span class="k">elif</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;head&#39;</span><span class="p">,</span><span class="s1">&#39;flxn&#39;</span><span class="p">]:</span>
						<span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="n">line</span><span class="p">)</span>
						<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="kc">None</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
						<span class="n">precedingZoneKey</span> <span class="o">=</span> <span class="kc">None</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
				<span class="n">precedingKey</span> <span class="o">=</span> <span class="n">keyword</span>
			<span class="k">elif</span> <span class="n">keyword</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">fdata_sections</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
				<span class="n">keyword</span> <span class="o">=</span> <span class="n">keyword</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;reading &#39;</span><span class="o">+</span><span class="n">keyword</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="n">fn</span><span class="o">=</span><span class="n">read_fn</span><span class="p">[</span><span class="n">keyword</span><span class="p">]</span>
				<span class="n">fn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_sections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">keyword</span><span class="p">)</span>
				<span class="n">precedingKey</span> <span class="o">=</span> <span class="n">keyword</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stop&#39;</span><span class="p">):</span> <span class="n">more</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>
			<span class="k">else</span><span class="p">:</span> 
				<span class="c1"># start recording a code block</span>
				<span class="n">foundKey</span> <span class="o">=</span> <span class="kc">False</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">precedingZoneKey</span><span class="p">:</span> <span class="n">block</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">precedingKey</span> <span class="o">=</span> <span class="n">precedingZoneKey</span>
				<span class="k">while</span> <span class="ow">not</span> <span class="n">foundKey</span><span class="p">:</span>	
					<span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
					<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
					<span class="n">keyword</span><span class="o">=</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="k">if</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">fdata_sections</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span> 
						<span class="n">foundKey</span> <span class="o">=</span> <span class="kc">True</span>
						<span class="k">continue</span>
					<span class="k">elif</span> <span class="n">keyword</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="ow">in</span> <span class="n">fdata_sections</span> <span class="ow">and</span> <span class="n">keyword</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">skip</span><span class="p">:</span>
						<span class="n">foundKey</span> <span class="o">=</span> <span class="kc">True</span>
						<span class="k">continue</span>
					<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stop&#39;</span><span class="p">):</span>
						<span class="n">foundKey</span> <span class="o">=</span> <span class="kc">True</span>
						<span class="k">continue</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_unparsed_blocks</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">precedingKey</span><span class="p">,</span><span class="n">block</span><span class="p">),)))</span>
				<span class="k">continue</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_add_boundary_zones</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">self</span></div>
<div class="viewcode-block" id="fdata.write"><a class="viewcode-back" href="../fdata.html#fdata.fdata.write">[docs]</a>	<span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">writeSubFiles</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>	<span class="c1">#Writes data to a file.</span>
		<span class="sd">&#39;&#39;&#39;Write fdata object to FEHM input file and fehmn.files file.</span>
<span class="sd">		</span>
<span class="sd">		:param filename: Name of FEHM input file to write to.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param writeSubFiles: Boolean indicating whether macro and zone information, designated as contained within other input files, should be written out, regardless of its existence. Non-existant files will always be written out.</span>
<span class="sd">		:type writeSubFiles: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">writeSubFiles</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeSubFiles</span> <span class="o">=</span> <span class="n">writeSubFiles</span>
		<span class="k">if</span> <span class="n">filename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;default_INPUT.dat&#39;</span>
		<span class="n">out_flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_prep</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">out_flag</span><span class="p">:</span> <span class="k">return</span> <span class="kc">False</span>
		
		<span class="c1"># ensure directory is created</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">absolute_to_file</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">wd</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="c1"># open file</span>
		<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;# &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;start&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_text</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_sol</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;sol&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfinv</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_nfinv</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;nfinv&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobr</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_nobr</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;nobr&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">air</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_air</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;air&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_head</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;head&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flxn</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_flxn</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;flxn&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vapl</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_vapl</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;vapl&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adif</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_adif</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;adif&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flxo</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_flxo</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;flxo&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_all</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;zone&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_cont</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;cont&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_hist</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;hist&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gradlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;grad&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;pres&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;pres&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">dof</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_ngas</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;ngas&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_boun</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;boun&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flow</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hflx</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;hflx&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;hflx&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;perm&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;perm&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;rock&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;rock&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pporlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_model</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;ppor&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;ppor&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;cond&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;cond&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vconlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_model</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;vcon&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;vcon&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlplist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_model</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;rlp&#39;</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;rlp&#39;</span><span class="p">)</span>		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlpmlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_rlpm</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;rlpm&#39;</span><span class="p">)</span>		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_time</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_ctrl</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;ctrl&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_iter</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;iter&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_carb</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;carb&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_strs</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;strs&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">_on</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_trac</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;trac&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stop</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="fdata.add"><a class="viewcode-back" href="../fdata.html#fdata.fdata.add">[docs]</a>	<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>					<span class="c1">#Adds a new object to the file</span>
		<span class="sd">&#39;&#39;&#39;Attach a zone, boundary condition or macro object to the data file.</span>
<span class="sd">		</span>
<span class="sd">		:param obj: Object to be added to the data file.</span>
<span class="sd">		:type obj: fzone, fmacro, fmodel, fboun</span>
<span class="sd">		:param overwrite: Flag to overwrite macro if already exists for a particular zone.</span>
<span class="sd">		:type overwrite: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fmacro</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_macro</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">overwrite</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fmodel</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_model</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_zone</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">overwrite</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fboun</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_boun</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">frlpm</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rlpm</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">frlpm_table</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rlpm</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>
<div class="viewcode-block" id="fdata.delete"><a class="viewcode-back" href="../fdata.html#fdata.fdata.delete">[docs]</a>	<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span> 								<span class="c1">#Deletes an object from the file</span>
		<span class="sd">&#39;&#39;&#39;Delete a zone, boundary condition or macro object from the data file.</span>
<span class="sd">		</span>
<span class="sd">		:param obj: Object to be deleted from the data file. Can be a list of objects.</span>
<span class="sd">		:type obj: fzone, fmacro, fmodel, fboun, list</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fmacro</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_macro</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fmodel</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_model</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_zone</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">fboun</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_boun</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">frlpm</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_rlpm</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">frlpm_table</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_rlpm</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">obji</span> <span class="ow">in</span> <span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">fmacro</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_macro</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">fmodel</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_model</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_zone</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">fboun</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_boun</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">frlpm</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_rlpm</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obji</span><span class="p">,</span><span class="n">frlpm_table</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delete_rlpm</span><span class="p">(</span><span class="n">obji</span><span class="p">)</span></div>
<div class="viewcode-block" id="fdata.picklable"><a class="viewcode-back" href="../fdata.html#fdata.fdata.picklable">[docs]</a>	<span class="k">def</span> <span class="nf">picklable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Call before multi-processing simulations in Windows to ensure fdata is picklable.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">_nodelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">_index</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">zn</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
			<span class="n">nd</span><span class="o">.</span><span class="n">_connected_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndi</span><span class="o">.</span><span class="n">_index</span> <span class="k">for</span> <span class="n">ndi</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">_connected_nodes</span><span class="p">]</span>
			<span class="n">nd</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">el</span><span class="o">.</span><span class="n">_index</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">_elements</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">connlist</span><span class="p">:</span>
			<span class="n">con</span><span class="o">.</span><span class="n">_nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">con</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span><span class="n">con</span><span class="o">.</span><span class="n">_nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_index</span><span class="p">]</span></div>
	<span class="k">def</span> <span class="nf">_add_boundary_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 						<span class="c1">#Automatically creates zones corresponding to x,y,z boundaries</span>
		<span class="n">x0</span><span class="p">,</span><span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmax</span>
		<span class="n">y0</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymax</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">_position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">]))</span>
		<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">_position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_nodelist</span><span class="p">]))</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="n">ks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">999</span><span class="p">,</span><span class="mi">998</span><span class="p">,</span><span class="mi">997</span><span class="p">,</span><span class="mi">996</span><span class="p">,</span><span class="s1">&#39;XMIN&#39;</span><span class="p">,</span><span class="s1">&#39;XMAX&#39;</span><span class="p">,</span><span class="s1">&#39;YMIN&#39;</span><span class="p">,</span><span class="s1">&#39;YMAX&#39;</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			
			<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;XMIN&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">998</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;XMAX&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x1</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">997</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;YMIN&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">+</span><span class="n">dy</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			<span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">996</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;YMAX&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">-</span><span class="n">dy</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
			<span class="n">z0</span><span class="p">,</span><span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmax</span>
			<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">]))</span>
			
			<span class="n">ks</span> <span class="o">=</span> <span class="p">[</span><span class="mi">999</span><span class="p">,</span><span class="mi">998</span><span class="p">,</span><span class="mi">997</span><span class="p">,</span><span class="mi">996</span><span class="p">,</span><span class="mi">995</span><span class="p">,</span><span class="mi">994</span><span class="p">,</span><span class="s1">&#39;XMIN&#39;</span><span class="p">,</span><span class="s1">&#39;XMAX&#39;</span><span class="p">,</span><span class="s1">&#39;YMIN&#39;</span><span class="p">,</span><span class="s1">&#39;YMAX&#39;</span><span class="p">,</span><span class="s1">&#39;ZMIN&#39;</span><span class="p">,</span><span class="s1">&#39;ZMAX&#39;</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
			
			<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">999</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;XMIN&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x0</span><span class="o">+</span><span class="n">dx</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">998</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;XMAX&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x1</span><span class="o">-</span><span class="n">dx</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">997</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;YMIN&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">+</span><span class="n">dy</span><span class="p">,</span><span class="n">z1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">996</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;YMAX&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">-</span><span class="n">dy</span><span class="p">,</span><span class="n">z0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">995</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ZMIN&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z0</span><span class="o">+</span><span class="n">dz</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
			<span class="n">dz</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="mi">994</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ZMAX&#39;</span><span class="p">);</span> <span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z1</span><span class="o">-</span><span class="n">dz</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">z1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
			
		<span class="k">else</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: Unrecognized grid dimensionality&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_associate_incon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>							<span class="c1">#Associates initial condition data with nodes</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39;S_co2l&#39;</span><span class="p">,</span><span class="s1">&#39;S_co2g&#39;</span><span class="p">,</span><span class="s1">&#39;co2aq&#39;</span><span class="p">)</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">P</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">S</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">S_co2l</span><span class="p">,</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">S_co2g</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">co2aq</span><span class="p">]</span>
			
		<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="nb">vars</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)]</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_running</span><span class="p">:</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;i&#39;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)])</span>
		<span class="k">for</span> <span class="n">nd</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">,</span><span class="nb">vars</span><span class="o">.</span><span class="n">T</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
				<span class="n">nd</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">name</span><span class="p">,</span><span class="n">var</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			
		<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;strs&#39;</span><span class="p">,</span><span class="s1">&#39;disp&#39;</span><span class="p">]</span>
		<span class="n">strs2D</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">strs3D</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span> <span class="n">strs3D</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">strs2D</span> <span class="o">=</span> <span class="kc">True</span>
			
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_running</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">strs2D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_strs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xy</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">elif</span> <span class="n">strs3D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_strs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xz</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="k">if</span> <span class="n">strs2D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_disp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">elif</span> <span class="n">strs3D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_disp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_z</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">strs2D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_strsi</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xy</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">elif</span> <span class="n">strs3D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_strsi</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_zz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_yz</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">strs_xz</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="k">if</span> <span class="n">strs2D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_dispi</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_y</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
				<span class="k">elif</span> <span class="n">strs3D</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_dispi</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">disp_z</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
	<span class="k">def</span> <span class="nf">_write_unparsed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">,</span><span class="n">key</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">keep_unknown</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unparsed_blocks</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unparsed_blocks</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;# &#39;</span><span class="o">+</span><span class="n">line</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_adif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#ADIF: Reads ADIF macro.</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">adif</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adif</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">333.</span><span class="p">,</span><span class="mf">666.</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">adif</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adif</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_adif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes ADIF macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adif</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;adif</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adif</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;adif&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_air</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>								<span class="c1">#AIR: Reads AIR/AIRWATER macro.</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">ico2d</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;ERROR bro&quot;</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_air</span> <span class="o">=</span> <span class="p">[</span><span class="n">ico2d</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
	<span class="k">def</span> <span class="nf">_write_air</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes AIR/AIRWATER macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;air</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%i</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%8.7f</span><span class="s1"> </span><span class="si">%8.7f</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;air&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">set_air</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ico2d</span><span class="p">,</span> <span class="n">reference_temperature</span><span class="p">,</span> <span class="n">reference_pressure</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_air</span> <span class="o">=</span> <span class="p">[</span><span class="n">ico2d</span><span class="p">,</span> <span class="n">reference_temperature</span><span class="p">,</span> <span class="n">reference_pressure</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">_read_boun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#BOUN: Reads BOUN macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>	
		<span class="n">new_bouns</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">file_flag</span><span class="o">=</span><span class="kc">False</span>
		<span class="c1"># read models</span>
		<span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">):</span> <span class="n">file_flag</span> <span class="o">=</span> <span class="kc">True</span><span class="p">;</span> <span class="k">break</span> 		<span class="c1"># read file data	</span>
			<span class="n">new_boun</span> <span class="o">=</span> <span class="n">fboun</span><span class="p">()</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="n">new_boun</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">line</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">new_boun</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
			<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_boun</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">!=</span> <span class="n">N</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span> <span class="n">new_boun</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 			<span class="c1"># read next model</span>
			<span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)):</span>
				<span class="n">var</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">,]</span>
				<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_boun</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
					<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
					<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span> 
						<span class="n">var</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
				<span class="n">new_boun</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 			<span class="c1"># read next model</span>
			<span class="n">new_bouns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_boun</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">file_flag</span><span class="p">:</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
				<span class="c1"># check if in subdirectory with input file</span>
				<span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">fn0</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
					<span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">fname</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">fn0</span> <span class="o">+=</span> <span class="n">fn</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn0</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">line</span><span class="p">):</span>
						<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: cannot find macro file &#39;</span><span class="o">+</span><span class="n">line</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn0</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">line</span><span class="p">)</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">macrofile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_read_boun</span><span class="p">(</span><span class="n">macrofile</span><span class="p">)</span>
						<span class="n">macrofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">macrofile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_boun</span><span class="p">(</span><span class="n">macrofile</span><span class="p">)</span>
				<span class="n">macrofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="c1"># read zone assignments</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 			<span class="c1"># read next zone assignment</span>
			<span class="k">while</span> <span class="n">line</span><span class="p">:</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">):</span>
					<span class="n">new_bouns</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">_zone_ind</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">nds</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
					<span class="n">new_bouns</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nds</span><span class="p">)</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> 			<span class="c1"># read next zone assignment</span>
			<span class="k">for</span> <span class="n">new_boun</span> <span class="ow">in</span> <span class="n">new_bouns</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_add_boun</span><span class="p">(</span><span class="n">new_boun</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_boun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes BOUN macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;BOUNDARY CONDITIONS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="c1">#if self.sticky_zones:</span>
		<span class="c1">#	self._write_zonn_one(outfile,[bm.zone for bm in self.bounlist if bm.zone.index != 0])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>	
			<span class="n">allzns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">bm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">bm</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">allzns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">allzns</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;boun</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">boun</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;model &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">nm</span><span class="o">+=</span><span class="mi">1</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">boun</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">boun</span><span class="o">.</span><span class="n">n_times</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">boun</span><span class="o">.</span><span class="n">times</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
				<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="n">cnt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="c1">#outfile.write(&#39;\n&#39;)</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">boun</span><span class="o">.</span><span class="n">variable</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">var</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">cnt</span> <span class="o">+=</span><span class="mi">1</span>
					<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="k">if</span> <span class="n">cnt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1">#outfile.write(&#39;\n&#39;)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">nm</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">boun</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">boun</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> <span class="n">nm</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span> <span class="k">continue</span>
			<span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">boun</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">ind</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">ind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">nm</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;boun&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_add_boun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">boun</span><span class="o">=</span><span class="n">fboun</span><span class="p">()):</span>							<span class="c1">#Adds a BOUN model.</span>
		<span class="n">boun</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">boun</span><span class="o">.</span><span class="n">zone</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">tuple</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span> <span class="n">boun</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="p">[</span><span class="n">boun</span><span class="o">.</span><span class="n">zone</span><span class="p">]</span>
		<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">boun</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> 
				<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">zn</span><span class="p">]))</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
				<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
		<span class="n">boun</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="n">zns</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_bounlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">boun</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_delete_boun</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">boun</span><span class="o">=</span><span class="n">fboun</span><span class="p">()):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_bounlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">boun</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_carb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#CARB: Reads CARB and associated macros.</span>
		<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;endcarb&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end carb&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2end&#39;</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;brine&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">brine</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2frac&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;co2frac&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2flow&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;co2flow&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2pres&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;co2pres&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2diff&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;co2diff&#39;</span><span class="p">)</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_write_carb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes CARB and associated macros.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;CO2 MODULE&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;restart</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;co2frac&#39;</span><span class="p">,</span><span class="s1">&#39;co2flow&#39;</span><span class="p">,</span><span class="s1">&#39;co2pres&#39;</span><span class="p">,</span><span class="s1">&#39;co2diff&#39;</span><span class="p">]:</span>				
				<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
					<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
						<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span>
					<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
							<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">zns</span><span class="p">)))</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;carb</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">sz</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2fraclist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;co2frac&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2flowlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;co2flow&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;co2pres&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2difflist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;co2diff&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">brine</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;brine</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">sz</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;endcarb</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;carb&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_cont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#CONT: Reads CONT macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_cont</span> <span class="o">=</span> <span class="n">fcont</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;avs&#39;</span><span class="p">,</span><span class="s1">&#39;avsx&#39;</span><span class="p">,</span><span class="s1">&#39;fehm&#39;</span><span class="p">,</span><span class="s1">&#39;free&#39;</span><span class="p">,</span><span class="s1">&#39;surf&#39;</span><span class="p">,</span><span class="s1">&#39;tec&#39;</span><span class="p">,</span><span class="s1">&#39;sur&#39;</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">format</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">timestep_interval</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">time_interval</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">time_flag</span><span class="o">=</span><span class="kc">False</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">time_flag</span><span class="o">=</span><span class="kc">True</span>
			
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
			<span class="n">gotVar</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">):</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">num_zones</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
				<span class="n">moreZones</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="k">while</span> <span class="n">moreZones</span><span class="p">:</span>
					<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
					<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">zones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)])</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">zones</span><span class="p">)</span> <span class="o">==</span> <span class="n">num_zones</span><span class="p">:</span> <span class="n">moreZones</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">for</span> <span class="nb">vars</span><span class="p">,</span><span class="n">ln</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">contour_variables</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
				<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">line</span><span class="p">[:</span><span class="n">ln</span><span class="p">]</span><span class="o">==</span><span class="n">var</span><span class="p">[:</span><span class="n">ln</span><span class="p">]:</span>
						<span class="n">gotVar</span> <span class="o">=</span> <span class="kc">True</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var</span><span class="p">])</span>
					<span class="k">if</span> <span class="n">gotVar</span><span class="p">:</span> <span class="k">break</span>
				<span class="k">if</span> <span class="n">gotVar</span><span class="p">:</span> <span class="k">break</span>			
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_write_cont</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes CONT macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;CONTOUR OUTPUT REQUESTS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;cont</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">timestep_interval</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">time_interval</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">time_flag</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;time</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">zones</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;zone</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">zones</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">zones</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			
		<span class="c1"># ensure list is unique</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
		<span class="n">varsU</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">varsU</span><span class="p">:</span> <span class="n">varsU</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">varsU</span>
		
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;cont&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_ctrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#CTRL: Reads CTRL macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;max_newton_iterations_MAXIT&#39;</span><span class="p">,</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">,</span><span class="s1">&#39;number_orthogonalizations_NORTH&#39;</span><span class="p">,</span><span class="s1">&#39;max_solver_iterations_MAXSOLVE&#39;</span><span class="p">,</span><span class="s1">&#39;acceleration_method_ACCM&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span><span class="o">==</span><span class="s1">&#39;ACCM&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;JA&#39;</span><span class="p">,</span><span class="s1">&#39;JB&#39;</span><span class="p">,</span><span class="s1">&#39;JC&#39;</span><span class="p">,</span><span class="s1">&#39;order_gauss_elim_NAR&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;implicitness_factor_AAW&#39;</span><span class="p">,</span><span class="s1">&#39;gravity_direction_AGRAV&#39;</span><span class="p">,</span><span class="s1">&#39;upstream_weighting_UPWGT&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span><span class="o">==</span><span class="s1">&#39;UPWGT&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;max_multiply_iterations_IAMM&#39;</span><span class="p">,</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">,</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">,</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">,</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">dtmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">_write_ctrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes CTRL macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;SIMULATION CONTROL PARAMETERS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ctrl</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_newton_iterations_MAXIT&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_newton_iterations_MAXIT&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;number_orthogonalizations_NORTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;number_orthogonalizations_NORTH&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_solver_iterations_MAXSOLVE&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_solver_iterations_MAXSOLVE&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;acceleration_method_ACCM&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;acceleration_method_ACCM&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JA&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JA&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JB&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JB&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JC&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;JC&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;order_gauss_elim_NAR&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;order_gauss_elim_NAR&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;implicitness_factor_AAW&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;implicitness_factor_AAW&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;gravity_direction_AGRAV&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;gravity_direction_AGRAV&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;upstream_weighting_UPWGT&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;upstream_weighting_UPWGT&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_multiply_iterations_IAMM&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_multiply_iterations_IAMM&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;ctrl&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.print_ctrl"><a class="viewcode-back" href="../fdata.html#fdata.fdata.print_ctrl">[docs]</a>	<span class="k">def</span> <span class="nf">print_ctrl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>										<span class="c1">#Prints out variables contained in CTRL.</span>
		<span class="sd">&#39;&#39;&#39;Display contents of CTRL macro.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>	<span class="nb">print</span> <span class="n">k</span> <span class="o">+</span><span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>
	<span class="k">def</span> <span class="nf">_read_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#HIST: Reads HIST macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">2</span><span class="p">:</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">:</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1e30</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span><span class="s1">&#39;surf&#39;</span><span class="p">,</span><span class="s1">&#39;tec&#39;</span><span class="p">]:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">timestep_interval</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">time_interval</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>			
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
			<span class="n">gotVar</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">history_variables</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">var</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">var</span><span class="p">])</span>
					<span class="k">break</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>		
	<span class="k">def</span> <span class="nf">_read_histnode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#Reads NODE macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
			<span class="n">node_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="n">newind</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">numXYZ</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
					<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)])</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">numXYZ</span> <span class="o">+=</span> <span class="mi">1</span>
					<span class="n">newind</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">newind</span> <span class="o">==</span> <span class="n">node_num</span><span class="p">:</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numXYZ</span><span class="p">):</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node_nearest_point</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">]))</span>	
		<span class="k">elif</span> <span class="s1">&#39;block&#39;</span> <span class="o">==</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
			<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">nums_zone</span><span class="p">,</span><span class="n">nums_params</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums_zone</span><span class="p">))</span>
		<span class="k">elif</span> <span class="s1">&#39;azone&#39;</span> <span class="o">==</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
			<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">nums_zone</span><span class="p">,</span><span class="n">nums_params</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">azonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums_zone</span><span class="p">))</span>
	<span class="k">def</span> <span class="nf">_read_flxz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>								<span class="c1">#Reads ZFLX macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="c1">#		self._hist = fhist()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		
		<span class="n">node_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">newind</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="n">numXYZ</span> <span class="o">=</span> <span class="mi">0</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)])</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: zone &#39;</span> <span class="o">+</span><span class="n">num</span><span class="o">+</span><span class="s1">&#39; in FLXZ not defined.&#39;</span><span class="p">)</span>
				<span class="n">newind</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="k">if</span> <span class="n">newind</span> <span class="o">==</span> <span class="n">node_num</span><span class="p">:</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">def</span> <span class="nf">_read_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>						<span class="c1">#HEAD: Reads HEAD macro.</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_write_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes HEAD macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;head</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;head</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;head&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_flxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>						<span class="c1">#HEAD: Reads FLXN macro.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_write_flxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes FLXN macro.</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;flxn</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;flxn&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes HIST macro.</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zonelist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">azonelist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: no zones or nodes specified for history output&#39;</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: no variables requested in hist&#39;</span><span class="p">)</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;HISTORY OUTPUT REQUESTS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		
		<span class="c1"># ensure list is unique</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
		<span class="n">varsU</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">varsU</span><span class="p">:</span> <span class="n">varsU</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span> <span class="o">=</span> <span class="n">varsU</span>
			
		<span class="n">znlist</span> <span class="o">=</span> <span class="p">[]</span>	
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">))</span>			
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span> 		<span class="c1"># convert names and indices to zone objects</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span> <span class="o">=</span> <span class="n">zns</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">znsInds</span> <span class="o">=</span> <span class="p">[]</span>		<span class="c1"># remove duplicate zones</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">znsInds</span><span class="p">:</span> <span class="k">continue</span>
				<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">);</span> <span class="n">znsInds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span> <span class="o">=</span> <span class="n">zns</span>				
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;flxz</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="n">cnt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;flxz&#39;</span><span class="p">)</span>	
		
		<span class="n">znlist</span> <span class="o">=</span> <span class="p">[]</span>		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span> 
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;node</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;block</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">azonelist</span><span class="p">:</span> 
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">azonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;node</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;azone</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

		<span class="bp">self</span><span class="o">.</span><span class="n">_write_unparsed</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;node&#39;</span><span class="p">)</span>	
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">ndsInds</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">nd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ndsInds</span><span class="p">:</span>
						<span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">])</span>
						<span class="n">ndsInds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="n">fnode</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ndsInds</span><span class="p">:</span>
						<span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
						<span class="n">ndsInds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span> <span class="o">=</span> <span class="n">nds</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;node</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">);</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">if</span> <span class="n">cnt</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;hist</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">timestep_interval</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">time_interval</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="nb">vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">var</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;hist&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_flxo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span> 							<span class="c1">#FLXO: Reads FLXO macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
			<span class="n">node_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span>
			<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="n">newind</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">numXYZ</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">ndsXYZ</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span>
					<span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">))</span>
					<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
						<span class="n">numXYZ</span> <span class="o">+=</span> <span class="mi">1</span>
					<span class="n">newind</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">newind</span> <span class="o">==</span> <span class="n">node_num</span><span class="p">:</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numXYZ</span><span class="p">):</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node_nearest_point</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">])</span>
				<span class="n">nds</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nds</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node_nearest_point</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">])</span><span class="o">.</span><span class="n">index</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">nds</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i1</span><span class="p">,</span><span class="n">i2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">node_num</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">node_num</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">flxo</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">nds</span><span class="p">[</span><span class="n">i1</span><span class="p">],</span><span class="n">nds</span><span class="p">[</span><span class="n">i2</span><span class="p">]))</span>
	<span class="k">def</span> <span class="nf">_write_flxo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes FLXO macro.</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;flxo</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flxo</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">nd1</span><span class="p">,</span><span class="n">nd2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flxo</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span><span class="n">fnode</span><span class="p">):</span> <span class="n">nd1</span> <span class="o">=</span> <span class="n">nd1</span><span class="o">.</span><span class="n">index</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd2</span><span class="p">,</span><span class="n">fnode</span><span class="p">):</span> <span class="n">nd2</span> <span class="o">=</span> <span class="n">nd2</span><span class="o">.</span><span class="n">index</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nd1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;flxo&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#ITER: Reads ITER macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;linear_converge_NRmult_G1&#39;</span><span class="p">,</span><span class="s1">&#39;quadratic_converge_NRmult_G2&#39;</span><span class="p">,</span><span class="s1">&#39;stop_criteria_NRmult_G3&#39;</span><span class="p">,</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">,</span><span class="s1">&#39;overrelaxation_factor_OVERF&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>	
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;reduced_dof_IRDOF&#39;</span><span class="p">,</span><span class="s1">&#39;reordering_param_ISLORD&#39;</span><span class="p">,</span><span class="s1">&#39;IRDOF_param_IBACK&#39;</span><span class="p">,</span><span class="s1">&#39;number_SOR_iterations_ICOUPL&#39;</span><span class="p">,</span><span class="s1">&#39;max_machine_time_RNMAX&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> 
				<span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;RNMAX&#39;</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes ITER macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;SOLVER PARAMETERS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;iter</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;linear_converge_NRmult_G1&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;linear_converge_NRmult_G1&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;quadratic_converge_NRmult_G2&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;quadratic_converge_NRmult_G2&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;stop_criteria_NRmult_G3&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;stop_criteria_NRmult_G3&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;overrelaxation_factor_OVERF&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;overrelaxation_factor_OVERF&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;reduced_dof_IRDOF&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;reduced_dof_IRDOF&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;reordering_param_ISLORD&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;reordering_param_ISLORD&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;IRDOF_param_IBACK&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;IRDOF_param_IBACK&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;number_SOR_iterations_ICOUPL&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;number_SOR_iterations_ICOUPL&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;max_machine_time_RNMAX&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;max_machine_time_RNMAX&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;iter&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.print_iter"><a class="viewcode-back" href="../fdata.html#fdata.fdata.print_iter">[docs]</a>	<span class="k">def</span> <span class="nf">print_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>										<span class="c1">#Prints out variables contained in ITER.</span>
		<span class="sd">&#39;&#39;&#39;Display contents of ITER macro.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>	<span class="nb">print</span> <span class="n">k</span> <span class="o">+</span><span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>
	<span class="k">def</span> <span class="nf">_read_nfinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#NFINV: Reads NFINV macro.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nfinv</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_write_nfinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes NFINV macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nfinv</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nfinv</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;nfinv&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_nobr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#NOBR: Reads NOBR macro.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nobr</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_write_nobr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes NOBR macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nobr</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;nobr</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;nobr&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_rlpm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#RLPM: Reads RLPM macro.		</span>
		<span class="n">moreGroups</span><span class="o">=</span><span class="kc">True</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="c1"># first read the models</span>
		<span class="n">rlpms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">moreGroups</span><span class="p">:</span>		
			<span class="n">group</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">moreModels</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="n">relperms</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">capillarys</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">while</span> <span class="n">moreModels</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">moreModels</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span><span class="n">moreGroups</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>	
				<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span> <span class="n">moreModels</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span><span class="n">moreGroups</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>	
				<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="n">moreModels</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>	
				<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">rlpm_phases</span><span class="p">:</span> <span class="n">relperms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">:]])</span>
				<span class="k">elif</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">capillarys</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)),</span><span class="n">rlpm_cap2</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span><span class="n">line</span><span class="p">[</span><span class="mi">3</span><span class="p">:]])</span>
			<span class="n">newrlpm</span> <span class="o">=</span> <span class="n">frlpm</span><span class="p">(</span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="n">relperm</span><span class="o">=</span><span class="n">relperms</span><span class="p">,</span><span class="n">capillary</span><span class="o">=</span><span class="n">capillarys</span><span class="p">)</span>
			<span class="n">rlpms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newrlpm</span><span class="p">)</span>
		<span class="n">rlpms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">,</span><span class="n">rlpm</span><span class="p">)</span> <span class="k">for</span> <span class="n">rlpm</span> <span class="ow">in</span> <span class="n">rlpms</span><span class="p">])</span>
		<span class="c1"># next read the zones</span>
		<span class="n">moreZones</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">while</span> <span class="n">moreZones</span><span class="p">:</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">moreZones</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>
			<span class="n">rlpms</span><span class="p">[</span><span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">line</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span> <span class="o">=</span> <span class="n">rlpms</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>			
	<span class="k">def</span> <span class="nf">_write_rlpm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes RLPM macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="n">macro_titles</span><span class="p">[</span><span class="s1">&#39;rlpm&#39;</span><span class="p">],</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
				<span class="n">allzns</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">bm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlpmlist</span><span class="p">:</span>
					<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bm</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">bm</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="p">[</span><span class="n">bm</span><span class="o">.</span><span class="n">zone</span><span class="p">,]</span>	
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">bm</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">allzns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">allzns</span><span class="p">)</span>				
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;rlpm</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">group</span><span class="p">)</span>
		<span class="n">table_number</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">rlpm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rlpm</span><span class="p">,</span><span class="n">frlpm</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;group &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">relperm</span> <span class="ow">in</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">relperm</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">relperm</span><span class="o">.</span><span class="n">phase</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">relperm</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rlpm_dicts</span><span class="p">[</span><span class="n">relperm</span><span class="o">.</span><span class="n">type</span><span class="p">]:</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">relperm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">capillary</span> <span class="ow">in</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">capillary</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;cap</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">capillary</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">capillary</span><span class="o">.</span><span class="n">phase</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rlpm_cap1</span><span class="p">[</span><span class="n">capillary</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">rlpm_dicts</span><span class="p">[</span><span class="n">capillary</span><span class="o">.</span><span class="n">type</span><span class="p">]:</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">capillary</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1">#outfile.write(&#39;\n&#39;)</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">rlpm</span><span class="p">,</span><span class="n">frlpm_table</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;group &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1"># table number</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;table</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">table_number</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">table_number</span> <span class="o">+=</span><span class="mi">1</span>
				<span class="c1"># table width</span>
				<span class="n">wid</span> <span class="o">=</span> <span class="mi">3</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">capillary</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">wid</span> <span class="o">=</span> <span class="mi">4</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wid</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">wid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">wid</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">ph1</span><span class="p">,</span><span class="n">ph2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">saturation</span><span class="p">,</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase2</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ph1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ph2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">wid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">ph1</span><span class="p">,</span><span class="n">ph2</span><span class="p">,</span><span class="n">cap</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">saturation</span><span class="p">,</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">rlpm</span><span class="o">.</span><span class="n">phase2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">rlpm</span><span class="o">.</span><span class="n">capillary</span><span class="p">):</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ph1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ph2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cap</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">rlpm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">ind</span> <span class="o">=</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">ind</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">ind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;rlpm&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_add_rlpm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rlpm</span><span class="o">=</span><span class="n">frlpm</span><span class="p">()):</span>							
		<span class="n">rlpm</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">group</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
			<span class="n">gps</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">group</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">gps</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gps</span><span class="p">:</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="k">break</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rlpm</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_delete_rlpm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rlpm</span><span class="o">=</span><span class="n">frlpm</span><span class="p">()):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">rlpm</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_sol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>								<span class="c1">#SOL: Reads SOL macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;coupling_NTT&#39;</span><span class="p">,</span><span class="s1">&#39;element_integration_INTG&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_sol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes SOL macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;SOLUTION TYPE&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;sol</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;coupling_NTT&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;coupling_NTT&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;element_integration_INTG&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;element_integration_INTG&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;sol&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_strs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#STRS: Reads STRS and associated macros.</span>
		<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;IHMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stressend&#39;</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">):</span> 				<span class="c1"># bodyforce boolean</span>
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;force&#39;</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bodyforcelist</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="s1">&#39;force&#39;</span>
				<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;acceleration&#39;</span><span class="p">):</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bodyforcelist</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">subtype</span> <span class="o">=</span> <span class="s1">&#39;acceleration&#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">bodyforce</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;initcalc&#39;</span><span class="p">):</span>				<span class="c1"># initcalc boolean</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">initcalc</span> <span class="o">=</span> <span class="mi">1</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;fem&#39;</span><span class="p">):</span>					<span class="c1"># fem boolean</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">fem</span> <span class="o">=</span> <span class="mi">1</span>		
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;excess_she&#39;</span><span class="p">):</span> 			<span class="c1"># reporting on excess shear stress?</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR2&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR3&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;permmodel&#39;</span><span class="p">):</span>				<span class="c1"># read details of stress/permeability model</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;permmodel&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;plastic&#39;</span><span class="p">):</span>				<span class="c1"># read details of stress/permeability model</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_model</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;plastic&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;stressboun&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="s1">&#39;biot&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tolerance&#39;</span><span class="p">):</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;zonn&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;zone&#39;</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_write_strs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes STRS and associated macros.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;STRESS MODULE&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>                                
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;strs</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;IHMS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity_factor&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity_factor&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bodyforcelist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">bodyforce</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;bodyforce</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">initcalc</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;initcalc</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">fem</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;fem</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">]:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;excess_she</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR2&#39;</span><span class="p">]:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR2&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR3&#39;</span><span class="p">]:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR3&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_model</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;permmodel&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plasticmodellist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_model</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;plastic&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stressbounlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;stressboun&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elasticlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">biotlist</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="s1">&#39;biot&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;tolerance</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">tolerance</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stressend</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;strs&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_ngas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#NGAS: Reads NGAS and associated macros.</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">dof</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
		<span class="c1"># read initial pressures</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span><span class="p">:</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">add_init_pres</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="c1"># read ncg pressures</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span><span class="p">:</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">add_ncg_pres</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="c1"># read sources </span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span><span class="p">:</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_write_ngas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes NGAS and associated macros.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;NONCONDENSIBLE GAS MODULE&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">zns</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">zns</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">zns</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">zns2</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">zns2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span> 
					<span class="k">if</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
						<span class="n">zns2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: no zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39; found&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">zns2</span><span class="p">)))</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ngas</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">dof</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">init_pres</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">ncg_pres</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ngas</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;ngas&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#TEXT: Reads TEXT macro.</span>
		<span class="n">more</span><span class="o">=</span><span class="kc">True</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">new_text</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="n">new_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">more</span><span class="o">=</span><span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_text</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes TEXT macro.</span>
		<span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;text</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>			
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_trac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#TRAC: Reads TRAC and associated macros.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">_on</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="c1"># group 1</span>
		<span class="n">nums</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;init_solute_conc_ANO&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;implicit_factor_AWC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;tolerance_EPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;upstream_weight_UPWGTA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="c1"># group 2</span>
		<span class="n">nums</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;solute_start_DAYCS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;solute_end_DAYCF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;flow_end_DAYHF&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;flow_start_DAYHS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="c1"># group 3</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;max_iterations_IACCMX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_DAYCM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAYCMM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYCMX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;print_interval_NPRTTRC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
		<span class="c1"># groups 4 and 5 (if applicable)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tpor&#39;</span><span class="p">):</span>
			<span class="n">nums</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">transport_porosity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="c1"># group 6</span>
		<span class="n">num_species</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
		<span class="c1"># group 7</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ldsp&#39;</span><span class="p">):</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="c1"># groups 8, 9 and 10</span>
		<span class="n">sorptionOnly</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">keepReading</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dspl&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;dspv&#39;</span><span class="p">):</span>
			<span class="n">sorptionOnly</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="c1"># read models</span>
			<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">add_common_model</span><span class="p">(</span><span class="n">diffusion_model</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
							<span class="n">diffusion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
							<span class="n">dispersion</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">add_common_model</span><span class="p">(</span><span class="n">diffusion_model</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
							<span class="n">diffusion</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
							<span class="n">dispersion</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="kc">None</span><span class="p">])</span>
			<span class="c1"># read model-zone assignment</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">inds</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
				<span class="n">inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
			<span class="k">for</span> <span class="n">zn</span><span class="p">,</span><span class="n">ind</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">zns</span><span class="p">,</span><span class="n">inds</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">common_modellist</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="n">zn</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">common_modellist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="c1"># group 11 - 16</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_species</span><span class="p">):</span>
			<span class="n">nums</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">phase</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			
			<span class="k">if</span> <span class="n">phase</span><span class="p">:</span> 
				<span class="n">models1</span><span class="p">,</span><span class="n">models2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_model_trac</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span><span class="p">)</span>
				<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">				UNDER CONSTRUCTION !!!</span>
<span class="sd">				&#39;&#39;&#39;</span>
				<span class="c1">#nums=infile.readline().strip().split()</span>
				<span class="c1">#adsorption_model=None</span>
				<span class="c1">#adsorption=None</span>
				<span class="c1">#diffusion_model=None</span>
				<span class="c1">#diffusion=None</span>
				<span class="c1">#dispersion=None</span>
				<span class="c1">#adsorption_model = int(float(nums[0]))</span>
				<span class="c1">#adsorption = [float(nums[1]),float(nums[2]),float(nums[3])]</span>
				<span class="c1">#if not sorptionOnly:</span>
				<span class="c1">#	if len(nums) == 9: diffusion_model = int(float(nums[4])); nums = nums[5:]</span>
				<span class="c1">#	elif len(nums) == 8: diffusion_model = 0; nums = nums[4:]</span>
				<span class="c1">#	diffusion = float(nums[0])</span>
				<span class="c1">#	if self.trac.ldsp:</span>
				<span class="c1">#		dispersion = [float(nums[1]),float(nums[2]),None]</span>
				<span class="c1">#	else:</span>
				<span class="c1">#		dispersion = [float(nums[1]),float(nums[2]),float(nums[3])]</span>
				<span class="c1">#</span>
				<span class="c1">#line=infile.readline().strip()			</span>
				<span class="c1">#line=infile.readline().strip()			</span>
				<span class="c1">#line=infile.readline().strip()	</span>
			<span class="c1">#line=infile.readline().strip()	</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">add_species</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="n">adsorption_model</span><span class="p">,</span><span class="n">adsorption</span><span class="p">,</span><span class="n">diffusion_model</span><span class="p">,</span><span class="n">diffusion</span><span class="p">,</span><span class="n">dispersion</span><span class="p">)</span>
			<span class="c1"># read in initial concentrations</span>
			<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">specieslist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_tracer_concentration</span><span class="p">(</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">),</span>
					<span class="n">initial_concentration</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>	
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>		
			<span class="c1"># read in injection concentrations</span>
			<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">specieslist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_tracer_generator</span><span class="p">(</span><span class="n">zone</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">),</span>
					<span class="n">injection_concentration</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">time_start</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="n">time_end</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_write_trac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes TRAC and associated macros.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;TRACKING MODULE&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">file</span><span class="p">:</span>
				<span class="n">zns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">zonelist</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">specieslist</span><span class="p">:</span>
					<span class="n">zns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
					<span class="n">zns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">_tracer_generatorlist</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">zns</span><span class="p">)))</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> 				<span class="c1"># write trac in stupid mode</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">file</span><span class="p">):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: cannot find trac file at location &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">file</span><span class="o">+</span><span class="s1">&#39;. Aborting...&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="n">adsf</span>
			<span class="c1"># open the auxiliary file and write it</span>
			<span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;rU&#39;</span><span class="p">)</span>
			<span class="n">lns</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
			<span class="c1"># quality control</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ln</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lns</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">ln</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;trac&#39;</span><span class="p">):</span> <span class="k">break</span>
			<span class="n">lns</span> <span class="o">=</span> <span class="n">lns</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
			<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lns</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;trac</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 1</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;init_solute_conc_ANO&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;implicit_factor_AWC&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;tolerance_EPC&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;upstream_weight_UPWGTA&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 2</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;solute_start_DAYCS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;solute_end_DAYCF&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;flow_end_DAYHF&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;flow_start_DAYHS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 3</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;max_iterations_IACCMX&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_DAYCM&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAYCMM&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYCMX&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;print_interval_NPRTTRC&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># groups 4 and 5 (if applicable)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">transport_porosity</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;tpor</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1 0 0 &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">transport_porosity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 6</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">number_species</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 7</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span><span class="p">:</span> 
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ldsp</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># groups 8, 9 and 10</span>
		<span class="n">sorptionOnly</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">common_modellist</span><span class="p">:</span> <span class="n">sorptionOnly</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">keepReading</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">sorptionOnly</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;dspl</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">cm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">common_modellist</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">diffusion_model</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">diffusion</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>				
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">cm</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">common_modellist</span><span class="p">):</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">zone</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># group 11 - 16</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">specieslist</span><span class="p">):</span>
			<span class="c1"># group 11</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">phase</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			
			<span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">phase</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">adsorption_model</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">adsorption</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">adsorption</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">adsorption</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">sorptionOnly</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">diffusion_model</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">diffusion</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">ldsp</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">dispersion</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1 0 0 1 </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">_tracer_concentrationlist</span><span class="p">:</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">zone</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">initial_concentration</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">_tracer_generatorlist</span><span class="p">:</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">zone</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">injection_concentration</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">time_start</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ic</span><span class="o">.</span><span class="n">time_end</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="c1"># concentration dependent density - only the first will be written</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trac</span><span class="o">.</span><span class="n">specieslist</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">sp</span><span class="o">.</span><span class="n">density_modifier</span><span class="p">:</span> 
				<span class="n">poutfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;cden</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">density_modifier</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">break</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;trac&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#TIME: Reads TIME macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)):</span> <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">,</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">,</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">,</span><span class="s1">&#39;print_interval_IPRTOUT&#39;</span><span class="p">,</span><span class="s1">&#39;initial_year_YEAR&#39;</span><span class="p">,</span><span class="s1">&#39;initial_month_MONTH&#39;</span><span class="p">,</span><span class="s1">&#39;initial_day_INITTIME&#39;</span><span class="p">]):</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">num</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span>
			<span class="k">else</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">tf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dtn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">dti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">_write_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes TIME macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;TIME STEPPING PARAMETERS&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;time</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;print_interval_IPRTOUT&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;print_interval_IPRTOUT&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_year_YEAR&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_year_YEAR&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_month_MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_month_MONTH&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_day_INITTIME&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_day_INITTIME&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">t_cpt</span> <span class="ow">in</span> <span class="n">time</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">t_cpt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>					
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.print_time"><a class="viewcode-back" href="../fdata.html#fdata.fdata.print_time">[docs]</a>	<span class="k">def</span> <span class="nf">print_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>										<span class="c1">#Prints out variables contained in TIME.</span>
		<span class="sd">&#39;&#39;&#39;Display contents of TIME macro.</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>	<span class="nb">print</span> <span class="n">k</span> <span class="o">+</span><span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>
<div class="viewcode-block" id="fdata.change_timestepping"><a class="viewcode-back" href="../fdata.html#fdata.fdata.change_timestepping">[docs]</a>	<span class="k">def</span> <span class="nf">change_timestepping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">at_time</span><span class="p">,</span><span class="n">new_dti</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">new_dtmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">new_dtx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">new_implicitness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">new_print_out</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Change timestepping during a simulation. Note, if time stepping arguments are omitted, FEHM will force output</span>
<span class="sd">		to be written at the change time. The default for all optional arguments is no change.</span>
<span class="sd">			</span>
<span class="sd">		:param at_time: Simulation time to change time stepping behaviour.</span>
<span class="sd">		:type at_time: fl64</span>
<span class="sd">		:param new_dti: Initial time step at change time.</span>
<span class="sd">		:type new_dti: fl64</span>
<span class="sd">		:param new_dtmax: New maximum time step after change time.</span>
<span class="sd">		:type new_dtmax: fl64</span>
<span class="sd">		:param new_dtx: New time step multiplier at change time.</span>
<span class="sd">		:type new_dtx: fl64</span>
<span class="sd">		:param new_implicitness: New implicitness factor at change time.</span>
<span class="sd">		:type new_implicitness: fl64</span>
<span class="sd">		:param new_print_out: New time step interval at which to print information. </span>
<span class="sd">		:type new_print_out: int</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="c1"># load old parameters</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">:</span>
			<span class="n">DIT1</span><span class="p">,</span><span class="n">DIT2</span><span class="p">,</span><span class="n">DIT3</span><span class="p">,</span><span class="n">ITC</span><span class="p">,</span><span class="n">DIT4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">DIT2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">DIT2a</span> <span class="o">=</span> <span class="n">DIT2</span><span class="p">;</span> <span class="n">DIT2b</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dtx</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">DIT2b</span> <span class="o">=</span> <span class="n">DIT2</span><span class="p">;</span> <span class="n">DIT2a</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">DIT2b</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dtx</span>
			<span class="n">DIT3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;implicitness_factor_AAW&#39;</span><span class="p">]</span>
			<span class="n">ITC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;print_interval_IPRTOUT&#39;</span><span class="p">]</span>
			<span class="n">DIT4</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtmax</span>
		
		<span class="c1"># assign new parameters</span>
		<span class="n">DIT1</span> <span class="o">=</span> <span class="n">at_time</span>
		<span class="k">if</span> <span class="n">new_dti</span> <span class="ow">and</span> <span class="n">new_dtx</span><span class="p">:</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: you cannot specify BOTH a new time step size and time step multiplier. Ignoring the new multiplier...&#39;</span><span class="p">)</span>
			<span class="n">new_dtx</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">if</span> <span class="n">new_dti</span><span class="p">:</span> <span class="n">DIT2</span> <span class="o">=</span> <span class="n">new_dti</span>
		<span class="k">elif</span> <span class="n">new_dtx</span><span class="p">:</span> <span class="n">DIT2</span> <span class="o">=</span> <span class="o">-</span><span class="n">new_dtx</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">DIT2</span> <span class="o">=</span> <span class="n">DIT2b</span>
		<span class="k">if</span> <span class="n">new_implicitness</span><span class="p">:</span> <span class="n">DIT3</span> <span class="o">=</span> <span class="n">new_implicitness</span>
		<span class="k">if</span> <span class="n">new_print_out</span><span class="p">:</span> <span class="n">ITC</span> <span class="o">=</span> <span class="n">new_print_out</span>
		<span class="k">if</span> <span class="n">new_dtmax</span><span class="p">:</span> <span class="n">DIT4</span> <span class="o">=</span> <span class="n">new_dtmax</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">DIT1</span><span class="p">,</span><span class="n">DIT2</span><span class="p">,</span><span class="n">DIT3</span><span class="p">,</span><span class="n">ITC</span><span class="p">,</span><span class="n">DIT4</span><span class="p">])</span>		</div>
	<span class="k">def</span> <span class="nf">_read_vapl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>							<span class="c1">#VAPL: Reads VAPL macro.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">vapl</span><span class="o">=</span><span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_write_vapl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>								<span class="c1">#Writes VAPL macro.</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vapl</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;vapl</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="s1">&#39;vapl&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.new_zone"><a class="viewcode-back" href="../fdata.html#fdata.fdata.new_zone">[docs]</a>	<span class="k">def</span> <span class="nf">new_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">rect</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">nodelist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">from_file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span><span class="n">permeability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">conductivity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">specific_heat</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">porosity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">youngs_modulus</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">poissons_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">thermal_expansion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">pressure_coupling</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
		<span class="n">Pi</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Ti</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">Si</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39; Create and assign a new zone. Material properties are optionally specified, new macros will be created if required.</span>
<span class="sd">		</span>
<span class="sd">		:param index: Zone index.</span>
<span class="sd">		:type index: int</span>
<span class="sd">		:param name: Zone name.</span>
<span class="sd">		:type name: str</span>
<span class="sd">		:param rect: Two item list. Each item is itself a three item (or two for 2D) list containing [x,y,z] coordinates of zone bounding box.</span>
<span class="sd">		:type rect: lst</span>
<span class="sd">		:param nodelist: List of node objects or indices of zone. Only one of rect or nodelist should be specified (rect will be taken if both given).</span>
<span class="sd">		:type nodelist: lst</span>
<span class="sd">		:param file: Name of auxiliary file for zone</span>
<span class="sd">		:type file: str</span>
<span class="sd">		:param from_file: Name of auxiliary file in which to find zone information.</span>
<span class="sd">		:type from_file: str</span>
<span class="sd">		:param permeability: Permeability of zone. One float for isotropic, three item list [x,y,z] for anisotropic.</span>
<span class="sd">		:type permeability: fl64, list</span>
<span class="sd">		:param conductivity: Conductivity of zone. One float for isotropic, three item list [x,y,z] for anisotropic.</span>
<span class="sd">		:type conductivity: fl64, list</span>
<span class="sd">		:param density: Density of zone. If not specified, defaults will be used for specific heat and porosity.</span>
<span class="sd">		:type density: fl64</span>
<span class="sd">		:param specific_heat: Specific heat of zone. If not specified, defaults will be used for density and porosity.</span>
<span class="sd">		:type specific_heat: fl64</span>
<span class="sd">		:param porosity: Porosity of zone. If not specified, defaults will be used for density and specific heat.</span>
<span class="sd">		:type porosity: fl64</span>
<span class="sd">		:param youngs_modulus: Young&#39;s modulus of zone. If not specified, default will be used for Poisson&#39;s ratio.</span>
<span class="sd">		:type youngs_modulus: fl64</span>
<span class="sd">		:param poissons_ratio: Poisson&#39;s ratio of zone. If not specified, default will be used for Young&#39;s modulus.</span>
<span class="sd">		:type poissons_ratio: fl64</span>
<span class="sd">		:param thermal_expansion: Coefficient of thermal expansion for zone. If not specified, default will be used for pressure coupling term.</span>
<span class="sd">		:type thermal_expansion: fl64</span>
<span class="sd">		:param pressure_coupling: Pressure coupling term for zone. If not specified, default will be used for coefficient of thermal expansion.</span>
<span class="sd">		:type pressure_coupling: fl64</span>
<span class="sd">		:param Pi: Initial pressure in the zone. If not specified, default will be used for initial temperature and saturation calculated.</span>
<span class="sd">		:type Pi: fl64</span>
<span class="sd">		:param Ti: Initial temperature in the zone. If not specified, default will be used for initial pressure and saturation calculated.</span>
<span class="sd">		:type Ti: fl64</span>
<span class="sd">		:param Si: Initial saturation in the zone. If not specified, default will be used for initial pressure and the saturation temperature calculated.</span>
<span class="sd">		:type Si: fl64</span>
<span class="sd">		:param overwrite: If zone already exists, delete it and create the new one.</span>
<span class="sd">		:type overwrite: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">from_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
		<span class="c1"># from file zones</span>
		<span class="k">if</span> <span class="n">from_file</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">from_file</span><span class="p">):</span>
				<span class="nb">print</span> <span class="s1">&#39;ERROR: no such zone file &#39;</span><span class="o">+</span><span class="n">from_file</span>
				<span class="k">return</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn_file</span><span class="p">(</span><span class="n">from_file</span><span class="p">)</span>		
		<span class="c1"># if neither rect nor nodelist specified, not enough information to create the zone</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">rect</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nodelist</span><span class="p">:</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: either rect or nodelist must be specified&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="c1"># if both rect and nodelist are specified, proceed with rect, print warning</span>
		<span class="k">if</span> <span class="n">rect</span> <span class="ow">and</span> <span class="n">nodelist</span><span class="p">:</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: only one of rect or nodelist should be specified, proceeding with rect values&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">nodelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodelist</span><span class="p">,</span><span class="n">fnode</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nodelist</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nodelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodelist</span><span class="p">]</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">])</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
			<span class="n">nodelist</span> <span class="o">=</span> <span class="n">nds</span>
		<span class="c1"># determine if zone already exists, delete or exit</span>
		<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">overwrite</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;ERROR: specified zone already exists, overwrite flag set to false&#39;</span>
				<span class="k">return</span>
		
		<span class="c1"># assemble zone</span>
		<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">file</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">rect</span><span class="p">:</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">(</span><span class="n">rect</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rect</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">elif</span> <span class="n">nodelist</span><span class="p">:</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;nnum&#39;</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">nodelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
					<span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd</span><span class="p">])</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="p">,</span><span class="n">fnode</span><span class="p">):</span> 
					<span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">nodelist</span> <span class="o">=</span> <span class="n">nds</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
		<span class="c1"># add permeability property macros</span>
		<span class="k">if</span> <span class="n">permeability</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">permeability</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">permeability</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">permeability</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: permeability must be a single float (isotropic) or three item list ([x,y,z] anisotropic&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="c1"># unpack values</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">permeability</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span>
				<span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="p">[</span><span class="n">permeability</span><span class="p">,</span><span class="n">permeability</span><span class="p">,</span><span class="n">permeability</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="n">permeability</span>
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kx</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ky</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">perm</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kz</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="n">kx</span><span class="p">),(</span><span class="s1">&#39;ky&#39;</span><span class="p">,</span><span class="n">ky</span><span class="p">),(</span><span class="s1">&#39;kz&#39;</span><span class="p">,</span><span class="n">kz</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">=</span> <span class="n">permeability</span>
		<span class="c1"># add conductivity property macros</span>
		<span class="k">if</span> <span class="n">conductivity</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">conductivity</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">))</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">conductivity</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">conductivity</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)):</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: conductivity must be a single float (isotropic) or three item list ([x,y,z] anisotropic&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
			<span class="c1"># unpack values</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">conductivity</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span>
				<span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="p">[</span><span class="n">conductivity</span><span class="p">,</span><span class="n">conductivity</span><span class="p">,</span><span class="n">conductivity</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">kx</span><span class="p">,</span><span class="n">ky</span><span class="p">,</span><span class="n">kz</span> <span class="o">=</span> <span class="n">conductivity</span>
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kx</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ky</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kz</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;cond_x&#39;</span><span class="p">,</span><span class="n">kx</span><span class="p">),(</span><span class="s1">&#39;cond_y&#39;</span><span class="p">,</span><span class="n">ky</span><span class="p">),(</span><span class="s1">&#39;cond_z&#39;</span><span class="p">,</span><span class="n">kz</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">=</span> <span class="n">conductivity</span>
		<span class="c1"># add rock property macros</span>
		<span class="k">if</span> <span class="n">density</span> <span class="ow">or</span> <span class="n">specific_heat</span> <span class="ow">or</span> <span class="n">porosity</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">density</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No density specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">density</span><span class="p">))</span>
				<span class="n">density</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">density</span>
			
			<span class="k">if</span> <span class="ow">not</span> <span class="n">specific_heat</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No specific heat specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">specific_heat</span><span class="p">))</span>
				<span class="n">specific_heat</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">specific_heat</span>
			
			<span class="k">if</span> <span class="ow">not</span> <span class="n">porosity</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No porosity specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">porosity</span><span class="p">))</span>
				<span class="n">porosity</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">porosity</span>
						
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">density</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">specific_heat</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">porosity</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="n">density</span><span class="p">),(</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">,</span><span class="n">specific_heat</span><span class="p">),(</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="n">porosity</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_density</span> <span class="o">=</span> <span class="n">density</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_specific_heat</span> <span class="o">=</span> <span class="n">specific_heat</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_porosity</span> <span class="o">=</span> <span class="n">porosity</span>
		<span class="c1"># add elastic property macros</span>
		<span class="k">if</span> <span class="n">youngs_modulus</span> <span class="ow">or</span> <span class="n">poissons_ratio</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">youngs_modulus</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No Youngs modulus specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">youngs_modulus</span><span class="p">))</span>
				<span class="n">youngs_modulus</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">youngs_modulus</span>
			
			<span class="k">if</span> <span class="ow">not</span> <span class="n">poissons_ratio</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No Poissons ratio specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">poissons_ratio</span><span class="p">))</span>
				<span class="n">poissons_ratio</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">poissons_ratio</span>
			
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elastic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">elastic</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">youngs_modulus</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">elastic</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">poissons_ratio</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">,</span><span class="n">youngs_modulus</span><span class="p">),(</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">,</span><span class="n">poissons_ratio</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_youngs_modulus</span> <span class="o">=</span> <span class="n">youngs_modulus</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_poissons_ratio</span> <span class="o">=</span> <span class="n">poissons_ratio</span>
		<span class="c1"># add stress coupling property macros</span>
		<span class="k">if</span> <span class="n">thermal_expansion</span> <span class="ow">or</span> <span class="n">pressure_coupling</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">thermal_expansion</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No coefficient of thermal expansion specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">thermal_expansion</span><span class="p">))</span>
				<span class="n">thermal_expansion</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">thermal_expansion</span>
			
			<span class="k">if</span> <span class="ow">not</span> <span class="n">pressure_coupling</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No pressure coupling term specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">pressure_coupling</span><span class="p">))</span>
				<span class="n">pressure_coupling</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">pressure_coupling</span>
			
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biot</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">biot</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">thermal_expansion</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">biot</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pressure_coupling</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">,</span><span class="n">thermal_expansion</span><span class="p">),(</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">,</span><span class="n">pressure_coupling</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_thermal_expansion</span> <span class="o">=</span> <span class="n">thermal_expansion</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_pressure_coupling</span> <span class="o">=</span> <span class="n">pressure_coupling</span>
		<span class="c1"># add initial conditions macros</span>
		<span class="k">if</span> <span class="n">Pi</span> <span class="ow">or</span> <span class="n">Ti</span> <span class="ow">or</span> <span class="n">Si</span><span class="p">:</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">Si</span> <span class="ow">and</span> <span class="n">Pi</span> <span class="ow">and</span> <span class="n">Ti</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">Ti</span> <span class="o">&lt;</span> <span class="n">tsat</span><span class="p">(</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">3</span>
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Ti</span>
				
			<span class="k">elif</span> <span class="ow">not</span> <span class="n">Si</span> <span class="ow">and</span> <span class="n">Pi</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Ti</span><span class="p">:</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No initial temperature specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">Ti</span><span class="p">))</span>
				<span class="n">Ti</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">Ti</span>
				<span class="k">if</span> <span class="n">Ti</span> <span class="o">&lt;</span> <span class="n">tsat</span><span class="p">(</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">3</span>
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Ti</span>
			
			<span class="k">elif</span> <span class="ow">not</span> <span class="n">Si</span> <span class="ow">and</span> <span class="n">Ti</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Pi</span><span class="p">:</span>
				<span class="n">Pi</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No initial pressure specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">Ti</span> <span class="o">&lt;</span> <span class="n">tsat</span><span class="p">(</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">Si</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">si</span> <span class="o">=</span> <span class="mi">3</span>
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Ti</span>
				
			<span class="k">elif</span> <span class="n">Si</span> <span class="ow">and</span> <span class="n">Ti</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Pi</span><span class="p">:</span>
				<span class="n">Pi</span> <span class="o">=</span> <span class="n">sat</span><span class="p">(</span><span class="n">Ti</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;NOTE: For supplied saturation &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; and temperature &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, saturation pressure of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; will be used.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Si</span>
				<span class="n">si</span> <span class="o">=</span> <span class="mi">2</span>
			
			<span class="k">elif</span> <span class="n">Si</span> <span class="ow">and</span> <span class="n">Pi</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">Ti</span><span class="p">:</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: Ignoring Ti, using Pi to calculate saturation temperature.&#39;</span><span class="p">)</span>
				<span class="n">Ti</span> <span class="o">=</span> <span class="n">tsat</span><span class="p">(</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Si</span>
				<span class="n">si</span> <span class="o">=</span> <span class="mi">2</span>
			
			<span class="k">elif</span> <span class="n">Si</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Ti</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">Pi</span><span class="p">:</span>
				<span class="n">Pi</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span>
				<span class="n">Ti</span> <span class="o">=</span> <span class="n">tsat</span><span class="p">(</span><span class="n">Pi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: No initial pressure specified, assigning default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">Pi</span><span class="p">))</span>
				<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;NOTE: For supplied saturation &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Si</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; and default pressure &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Pi</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, saturation temperature of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; will be used.&#39;</span><span class="p">)</span>
				
				<span class="n">ti</span> <span class="o">=</span> <span class="n">Si</span>
				<span class="n">si</span> <span class="o">=</span> <span class="mi">2</span>
			
			<span class="c1"># assign</span>
			<span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pi</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ti</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">si</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macro</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">Pi</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">ti</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="n">si</span><span class="p">)))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
				
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">Pi</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">Ti</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="n">Si</span></div>
	<span class="k">def</span> <span class="nf">general_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">,</span> <span class="n">insert_after</span><span class="p">,</span> <span class="n">zonelist</span> <span class="o">=</span> <span class="p">[]):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_general_macrolist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fgeneral</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">insert_after</span><span class="p">,</span> <span class="n">zonelist</span><span class="p">,</span> <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="p">))</span>
	<span class="k">def</span> <span class="nf">_write_general_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="p">,</span> <span class="n">macro</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">general</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_general_macrolist</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">general</span><span class="o">.</span><span class="n">insert_after</span> <span class="o">==</span> <span class="n">macro</span><span class="p">:</span>
				<span class="c1"># write out zones if defined</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">general</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span>
				<span class="c1"># write out macro lines</span>
				<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">general</span><span class="o">.</span><span class="n">lines</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<div class="viewcode-block" id="fdata.run"><a class="viewcode-back" href="../fdata.html#fdata.fdata.run">[docs]</a>	<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">grid</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">incon</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">exe</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">fehm_path</span><span class="p">,</span><span class="n">files</span><span class="o">=</span><span class="n">dflt</span><span class="o">.</span><span class="n">files</span><span class="p">,</span><span class="n">verbose</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">until</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">autorestart</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">use_paths</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">no_paths</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">write_files_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span><span class="n">diagnostic</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">clean</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">writeSubFiles</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Run an fehm simulation. This command first writes out the input file, *fehmn.files* and this incon file</span>
<span class="sd">		if changes have been made. A command line call is then made to the FEHM executable at the specified path (defaults</span>
<span class="sd">		to *fehm.exe* in the working directory if not specified).</span>
<span class="sd">		</span>
<span class="sd">		:param input: Name of input file. This will be written out.</span>
<span class="sd">		:type input: str</span>
<span class="sd">		:param grid: Name of grid file. This will be written out.</span>
<span class="sd">		:type grid: str</span>
<span class="sd">		:param incon: Name of restart file.</span>
<span class="sd">		:type incon: str</span>
<span class="sd">		:param exe: Path to FEHM executable.</span>
<span class="sd">		:type exe: str</span>
<span class="sd">		:param files: List of additional files to output. Options include &#39;check&#39;, &#39;hist&#39; and &#39;outp&#39;.</span>
<span class="sd">		:type files: lst[str]</span>
<span class="sd">		:param until: Name of a function defined inside the script. The function returns a boolean indicating the simulation should be halted. See tutorial 4 for usage.</span>
<span class="sd">		:type until: func</span>
<span class="sd">		:param autorestart: Number of times FEHM should restart itself in attempting to find a solution.</span>
<span class="sd">		:type autorestart: int</span>
<span class="sd">		:param use_paths: Flag to indicate that PyFEHM should favour full paths in fehmn.files rather than duplication of source files.</span>
<span class="sd">		:type use_paths: bool</span>
<span class="sd">		:param write_files_only: Flag to indicate the PyFEHM should write out input, incon, grid, fehmn.files, etc. but should not execute a simulation.</span>
<span class="sd">		:type write_files_only: bool</span>
<span class="sd">		:param diagnostic: Flag to indicate PyFEHM should flash up a diagnostic window to monitor the simulation.</span>
<span class="sd">		:type diagnostic: bool</span>
<span class="sd">		:param clean: Delete files after simulation &#39;nop.temp&#39;</span>
<span class="sd">		:type clean: bool</span>
<span class="sd">		:param writeSubFiles: Write out subfiles when running</span>
<span class="sd">		:type clean: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		
		<span class="k">if</span> <span class="n">verbose</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="n">verbose</span>
		<span class="k">if</span> <span class="n">diagnostic</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="c1"># set up and check path to executable</span>
		<span class="n">exe_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">()</span>
		<span class="n">exe_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">exe</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">exe_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">):</span> 	<span class="c1"># if can&#39;t find the executable, halt</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">exe_path</span><span class="o">.</span><span class="n">full_path</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span> 	<span class="c1"># Also check if more complicated command is being used (e.g. mpirun -n 1 -H host xfehm)</span>
				<span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s1">&#39;No executable at location &#39;</span><span class="o">+</span><span class="n">exe</span><span class="p">)</span>
				<span class="k">return</span>
						
		<span class="c1"># option to write input, grid, incon files to new names</span>
		<span class="k">if</span> <span class="nb">input</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="nb">input</span>
		<span class="k">if</span> <span class="n">grid</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">grid</span>
		<span class="k">if</span> <span class="n">incon</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">incon</span>
		
		<span class="c1"># ASSEMBLE FILES IN CORRECT DIRECTORIES</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>
		<span class="n">returnFlag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span><span class="n">writeSubFiles</span><span class="o">=</span><span class="n">writeSubFiles</span><span class="p">)</span> 				<span class="c1"># ALWAYS write input file</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">returnFlag</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: writing files&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
		<span class="c1"># 1. Copy everything to working directory </span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">use_paths</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>	<span class="c1"># SOMETIMES write grid file</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_incon</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>	<span class="c1"># SOMETIMES write incon file</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_stor</span><span class="p">:</span>						<span class="c1"># SOMETIMES copy stor file</span>
				<span class="n">temp_path</span> <span class="o">=</span> <span class="n">fpath</span><span class="p">()</span>
				<span class="n">temp_path</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">stor</span>
				<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">temp_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">):</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">temp_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="n">wd</span><span class="o">+</span><span class="n">temp_path</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
					<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: cant find stor file at &#39;</span><span class="o">+</span><span class="n">temp_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
					<span class="k">return</span>
		<span class="k">else</span><span class="p">:</span>	
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_incon</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_writeOut</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span><span class="p">)</span>	<span class="c1"># SOMETIMES write incon file</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">full_path</span>
						
		<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span> 												<span class="c1"># extra files to be written</span>
			<span class="k">if</span> <span class="n">file</span> <span class="o">==</span> <span class="s1">&#39;chk&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_check</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">if</span> <span class="n">file</span> <span class="o">==</span> <span class="s1">&#39;check&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_check</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">if</span> <span class="n">file</span> <span class="o">==</span> <span class="s1">&#39;hist&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_hist</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">if</span> <span class="n">file</span> <span class="o">==</span> <span class="s1">&#39;outp&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_outp</span> <span class="o">=</span> <span class="kc">True</span>
			
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;stor_file_LDA&#39;</span><span class="p">]:</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">_use_stor</span> <span class="o">=</span> <span class="kc">True</span> 		<span class="c1"># stor file requested?</span>
			
		<span class="k">if</span> <span class="n">no_paths</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">filename</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">filename</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>				<span class="c1"># ALWAYS write fehmn.files</span>
		<span class="k">if</span> <span class="n">write_files_only</span><span class="p">:</span> <span class="k">return</span> 		<span class="c1"># return here if user requests only write out of files</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">exe</span> <span class="o">=</span> <span class="n">exe</span>
		<span class="c1"># RUN SIMULATION</span>
		<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
				
		<span class="c1"># summarize simulation</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_summary</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">incon</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_summary</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_summary</span><span class="p">()</span>		
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">)</span>
		
		<span class="c1"># remove restart file if left over from old simulation</span>
		<span class="k">if</span> <span class="n">until</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">time</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">rsto</span><span class="p">):</span>
			<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">rsto</span><span class="p">)</span>
			
		<span class="c1"># run the simulation</span>
		<span class="n">breakAutorestart</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">autorestart</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> 	<span class="c1"># restart execution</span>
			<span class="k">if</span> <span class="n">breakAutorestart</span><span class="p">:</span> <span class="k">break</span>
			<span class="n">untilFlag</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">if</span> <span class="n">diagnostic</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">refresh_nodes</span><span class="p">()</span>
			<span class="k">if</span> <span class="n">until</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">exe_path</span><span class="o">.</span><span class="n">full_path</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">stdout</span><span class="o">=</span><span class="n">PIPE</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">diagnostic</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">poll</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">poll</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_diagnostic</span><span class="o">.</span><span class="n">construct_viewer</span><span class="p">()</span> 			<span class="c1"># construct the diagnosis window</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
						<span class="nb">print</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> 	<span class="c1"># print remainder to screen	</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">exe_path</span><span class="o">.</span><span class="n">full_path</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_running</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_running</span><span class="p">:</span>					<span class="c1"># loop for checking if stop condition is met</span>
					<span class="n">sleep</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">sleep_time</span><span class="p">)</span> 					<span class="c1"># wait </span>
					<span class="n">untilFlag</span> <span class="o">=</span> <span class="n">until</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> 		
					<span class="n">p</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> 						<span class="c1"># check if run finished on its own</span>
					<span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>					<span class="c1"># IF run finshed on its own</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_running</span> <span class="o">=</span> <span class="kc">False</span>					<span class="c1"># break the loop</span>
					<span class="k">if</span> <span class="n">untilFlag</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_running</span><span class="p">:</span> 		<span class="c1"># IF stop condition met</span>
						<span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>							<span class="c1"># kill the process</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_running</span> <span class="o">=</span> <span class="kc">False</span>					<span class="c1"># break the loop</span>
						<span class="n">breakAutorestart</span> <span class="o">=</span> <span class="kc">True</span>

			<span class="k">if</span> <span class="n">autorestart</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">rsto</span><span class="p">)</span>        <span class="c1"># read fin file for autorestart</span>
				<span class="k">if</span> <span class="nb">abs</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">0.001</span><span class="p">:</span> <span class="n">breakAutorestart</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">breakAutorestart</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;nop.temp&#39;</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
			<span class="k">try</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;fort.97&#39;</span><span class="p">)</span>
			<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span></div>
<div class="viewcode-block" id="fdata.paraview"><a class="viewcode-back" href="../fdata.html#fdata.fdata.paraview">[docs]</a>	<span class="k">def</span> <span class="nf">paraview</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">exe</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">paraview_path</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;temp.vtk&#39;</span><span class="p">,</span><span class="n">contour</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="n">zones</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">zscale</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
		<span class="n">spatial_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">time_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">wells</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Exports the model object to VTK and loads in paraview.</span>
<span class="sd">		</span>
<span class="sd">		:param exe: Path to Paraview executable.</span>
<span class="sd">		:type exe: str</span>
<span class="sd">		:param filename: Name of VTK file to be output.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param contour: Contout output data object loaded using fcontour().</span>
<span class="sd">		:type contour: fcontour</span>
<span class="sd">		:param history: History output data object loaded using fhistory().</span>
<span class="sd">		:type history: fhistory</span>
<span class="sd">		:param show: Variable to show when Paraview starts up (default = &#39;kx&#39;).</span>
<span class="sd">		:type show: str</span>
<span class="sd">		:param zones: Zones to plot: &#39;user&#39; = user-defined zones, &#39;all&#39; = all zones except zone[0], &#39;none&#39; (default), or list of zone objects.</span>
<span class="sd">		:type zones: str</span>
<span class="sd">		:param diff: Flag to request PyFEHM to also plot differences of contour variables (from initial state) with time.</span>
<span class="sd">		:type diff: bool</span>
<span class="sd">		:param zscale: Factor by which to scale z-axis. Useful for visualising laterally extensive flow systems.</span>
<span class="sd">		:type zscale: fl64</span>
<span class="sd">		:param spatial_derivatives: Calculate new fields for spatial derivatives of contour data. </span>
<span class="sd">		:type spatial_derivatives: bool</span>
<span class="sd">		:param time_derivatives: Calculate new fields for time derivatives of contour data. For precision reasons, derivatives are calculated with units of &#39;per day&#39;.</span>
<span class="sd">		:type time_derivatives: bool</span>
<span class="sd">		:param nodes: Show node locations (default False).</span>
<span class="sd">		:type nodes: bool</span>
<span class="sd">		:param wells: Dictionary of well tracks ([x,y,z] column list), keyed by name.</span>
<span class="sd">		:type wells: dict</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="c1"># check for empty contour object</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_vtk</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">zscale</span><span class="o">=</span><span class="n">zscale</span><span class="p">,</span><span class="n">spatial_derivatives</span><span class="o">=</span><span class="n">spatial_derivatives</span><span class="p">,</span><span class="n">time_derivatives</span><span class="o">=</span><span class="n">time_derivatives</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">string</span> <span class="k">import</span> <span class="n">join</span>
			<span class="n">filename_csv</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename_csv</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">time_derivatives</span><span class="o">=</span><span class="n">time_derivatives</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">show_zones</span><span class="o">=</span><span class="n">zones</span>
		<span class="k">if</span> <span class="n">wells</span><span class="p">:</span> 
			<span class="c1"># check dictionary keys have no spaces, dashed</span>
			<span class="n">wells2</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">knew</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="n">knew</span> <span class="o">=</span> <span class="n">knew</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="n">wells2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">knew</span><span class="p">,</span><span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">write_wells</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">wells2</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">initial_display</span><span class="p">(</span><span class="n">show</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">startup_script</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span>
		
		<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">exe</span><span class="o">+</span><span class="s1">&#39; --script=pyfehm_paraview_startup.py&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">WINDOWS</span><span class="p">))</span>		</div>
<div class="viewcode-block" id="fdata.write_vtk"><a class="viewcode-back" href="../fdata.html#fdata.fdata.write_vtk">[docs]</a>	<span class="k">def</span> <span class="nf">write_vtk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;temp.vtk&#39;</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">zscale</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
			<span class="n">spatial_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">time_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Exports the model object to VTK.</span>
<span class="sd">		</span>
<span class="sd">		:param filename: Name of VTK file to be output.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param contour: Contout output data object loaded using fcontour().</span>
<span class="sd">		:type contour: fcontour</span>
<span class="sd">		:param diff: Flag to request PyFEHM to also plot differences of contour variables (from initial state) with time.</span>
<span class="sd">		:type diff: bool</span>
<span class="sd">		:param zscale: Factor by which to scale z-axis. Useful for visualising laterally extensive flow systems.</span>
<span class="sd">		:type zscale: fl64</span>
<span class="sd">		:param spatial_derivatives: Calculate new fields for spatial derivatives of contour data. </span>
<span class="sd">		:type spatial_derivatives: bool</span>
<span class="sd">		:param time_derivatives: Calculate new fields for time derivatives of contour data. For precision reasons, derivatives are calculated with units of &#39;per day&#39;.</span>
<span class="sd">		:type time_derivatives: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">contour</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">contour</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">contour</span> <span class="o">=</span> <span class="kc">None</span>		
		<span class="c1"># write vtk files for contour output data</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span> <span class="o">=</span> <span class="n">fvtk</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">zscale</span> <span class="o">=</span> <span class="n">zscale</span><span class="p">,</span><span class="n">spatial_derivatives</span> <span class="o">=</span> <span class="n">spatial_derivatives</span><span class="p">,</span> <span class="n">time_derivatives</span> <span class="o">=</span> <span class="n">time_derivatives</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">assemble</span><span class="p">()</span>
		<span class="n">fls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>	</div>
	<span class="k">def</span> <span class="nf">write_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;temp.csv&#39;</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>	<span class="n">time_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Exports the fhistory object to CSV for reading into paraview.</span>
<span class="sd">		</span>
<span class="sd">		:param filename: Name of CSV file to be output.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param history: History output data object loaded using fhistory().</span>
<span class="sd">		:type history: fhistory</span>
<span class="sd">		:param diff: Flag to request PyFEHM to also plot differences of contour variables (from initial state) with time.</span>
<span class="sd">		:type diff: bool</span>
<span class="sd">		:param time_derivatives: Calculate new fields for time derivatives of contour data. For precision reasons, derivatives are calculated with units of &#39;per day&#39;.</span>
<span class="sd">		:type time_derivatives: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="k">if</span> <span class="n">history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">history</span> <span class="o">=</span> <span class="kc">None</span>		
		<span class="c1"># write vtk files for contour output data</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">csv</span> <span class="o">=</span> <span class="n">fcsv</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">time_derivatives</span> <span class="o">=</span> <span class="n">time_derivatives</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">csv</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">exe</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">visit_path</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;temp.vtk&#39;</span><span class="p">,</span><span class="n">contour</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s1">&#39;kx&#39;</span><span class="p">,</span><span class="n">zones</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">diff</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span><span class="n">zscale</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span>
		<span class="n">spatial_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">time_derivatives</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">wells</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Exports the model object to VTK and loads in visit</span>
<span class="sd">		</span>
<span class="sd">		:param exe: Path to VisIt executable.</span>
<span class="sd">		:type exe: str</span>
<span class="sd">		:param filename: Name of VTK file to be output.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param contour: Contout output data object loaded using fcontour().</span>
<span class="sd">		:type contour: fcontour</span>
<span class="sd">		:param history: History output data object loaded using fhistory().</span>
<span class="sd">		:type history: fhistory</span>
<span class="sd">		:param show: Variable to show when Paraview starts up (default = &#39;kx&#39;).</span>
<span class="sd">		:type show: str</span>
<span class="sd">		:param zones: Zones to plot: &#39;user&#39; = user-defined zones, &#39;all&#39; = all zones except zone[0], &#39;none&#39; (default), or list of zone objects.</span>
<span class="sd">		:type zones: str</span>
<span class="sd">		:param diff: Flag to request PyFEHM to also plot differences of contour variables (from initial state) with time.</span>
<span class="sd">		:type diff: bool</span>
<span class="sd">		:param zscale: Factor by which to scale z-axis. Useful for visualising laterally extensive flow systems.</span>
<span class="sd">		:type zscale: fl64</span>
<span class="sd">		:param spatial_derivatives: Calculate new fields for spatial derivatives of contour data. </span>
<span class="sd">		:type spatial_derivatives: bool</span>
<span class="sd">		:param time_derivatives: Calculate new fields for time derivatives of contour data. For precision reasons, derivatives are calculated with units of &#39;per day&#39;.</span>
<span class="sd">		:type time_derivatives: bool</span>
<span class="sd">		:param nodes: Show node locations (default False).</span>
<span class="sd">		:type nodes: bool</span>
<span class="sd">		:param wells: Dictionary of well tracks ([x,y,z] column list), keyed by name.</span>
<span class="sd">		:type wells: dict</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="c1"># check for empty contour object</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_vtk</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span><span class="n">contour</span><span class="o">=</span><span class="n">contour</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">zscale</span><span class="o">=</span><span class="n">zscale</span><span class="p">,</span><span class="n">spatial_derivatives</span><span class="o">=</span><span class="n">spatial_derivatives</span><span class="p">,</span><span class="n">time_derivatives</span><span class="o">=</span><span class="n">time_derivatives</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="kn">from</span> <span class="nn">string</span> <span class="k">import</span> <span class="n">join</span>
			<span class="n">filename_csv</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">write_csv</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">filename_csv</span><span class="p">,</span><span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span><span class="n">diff</span><span class="o">=</span><span class="n">diff</span><span class="p">,</span><span class="n">time_derivatives</span><span class="o">=</span><span class="n">time_derivatives</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">show_zones</span><span class="o">=</span><span class="n">zones</span>
		<span class="k">if</span> <span class="n">wells</span><span class="p">:</span> 
			<span class="c1"># check dictionary keys have no spaces, dashed</span>
			<span class="n">wells2</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">wells</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">knew</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="n">knew</span> <span class="o">=</span> <span class="n">knew</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="n">wells2</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">knew</span><span class="p">,</span><span class="n">wells</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">write_wells</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">wells2</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">initial_display</span><span class="p">(</span><span class="n">show</span><span class="p">)</span>
		<span class="c1">#self._vtk.startup_script(nodes)</span>
		<span class="n">p</span> <span class="o">=</span> <span class="n">Popen</span><span class="p">(</span><span class="n">exe</span><span class="o">+</span><span class="s1">&#39; -o &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_vtk</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;*.vtk&#39;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="p">(</span><span class="ow">not</span> <span class="n">WINDOWS</span><span class="p">))</span>		
	<span class="k">def</span> <span class="nf">_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>		
		<span class="n">L</span> <span class="o">=</span> <span class="mi">62</span>
		<span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; ****---------------------------------------------------------****&#39;</span><span class="p">)</span>
		<span class="n">line</span> <span class="o">=</span> <span class="s1">&#39; **** FEHM input file </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> summary.&#39;</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span> <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;****&#39;</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; ****---------------------------------------------------------****&#39;</span><span class="p">)</span>
		
		<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; **** Zones:&#39;</span><span class="p">)</span>
		<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; **** Material properties:&#39;</span><span class="p">)</span>
		<span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; **** Generators:&#39;</span><span class="p">)</span>
		
		<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39; **&#39;</span><span class="p">):</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">)):</span> <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
				<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;****&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; **** -&#39;</span>
				<span class="n">keepGoing</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">while</span> <span class="n">keepGoing</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> 
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prntStr</span><span class="o">+</span><span class="s1">&#39;****&#39;</span><span class="p">)</span>
						<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; **** &#39;</span>
						<span class="k">break</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)</span><span class="o">&lt;</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span> 
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">prntStr</span><span class="p">)):</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prntStr</span><span class="o">+</span><span class="s1">&#39;****&#39;</span><span class="p">)</span>
						<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39; ****   &#39;</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39; ****---------------------------------------------------------****&#39;</span><span class="p">)</span>
		<span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
		<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_prep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>						<span class="c1">#Determine if data object fit for writing</span>
		<span class="k">global</span> <span class="n">buildWarnings</span>
		<span class="c1"># WARNING: if cont output specifies pressure, but not state, then no pressure data will be written</span>
		<span class="n">hasPres</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">hasState</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">checkWarnings</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;po&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pe&#39;</span><span class="p">):</span> <span class="n">hasPres</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;va&#39;</span><span class="p">):</span> <span class="n">hasState</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">if</span> <span class="n">hasPres</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">hasState</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;liquid&#39;</span><span class="p">,</span><span class="s1">&#39;vapor&#39;</span><span class="p">])</span>
		<span class="c1"># WARNING: stress perm module specified without calling excess_she</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">pm</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">22</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">25</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
					<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Perm model specified without accompanying excess_she macro - assigning defaults.&#39;</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR1&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.9</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR2&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">10.</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">excess_she</span><span class="p">[</span><span class="s1">&#39;PAR3&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">1.</span>
					
			<span class="k">if</span> <span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pm</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">pm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">]:</span>
				<span class="n">new_permmodel</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="s1">&#39;permmodel&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
				<span class="n">new_permmodel</span><span class="o">.</span><span class="n">zonelist</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">new_permmodel</span><span class="p">)</span>	
		<span class="k">for</span> <span class="n">boun</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span> <span class="n">boun</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span> <span class="n">zone</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span> <span class="n">macro</span><span class="o">.</span><span class="n">_check</span><span class="p">()</span>
		<span class="c1"># WARNING: conductivity not specified, FEHM simulation wont run - add default</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> 
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;No global conductivity set. Setting default &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">conductivity</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;cond_x&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">conductivity</span><span class="p">),(</span><span class="s1">&#39;cond_y&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">conductivity</span><span class="p">),(</span><span class="s1">&#39;cond_z&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">conductivity</span><span class="p">))))</span>
		<span class="c1"># WARNING: rock properties not specified, FEHM will run weirdly - add default</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">rock</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> 
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;No global rock properties set. Setting default density = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">density</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, specific heat = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">specific_heat</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, porosity=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">dflt</span><span class="o">.</span><span class="n">porosity</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;rock&#39;</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">density</span><span class="p">),(</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">specific_heat</span><span class="p">),(</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">porosity</span><span class="p">))))</span>
		<span class="c1"># WARNING: specifying zero pressure in co2pres has caused segfaults in the past</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
					<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Zero pressure  in CO2PRES can cause instability.&#39;</span><span class="p">)</span>
					<span class="k">break</span>
		<span class="c1"># WARNING: if stress gradients have been specified and bodyforce applied</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_stressgradCalled</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">bodyforce</span><span class="p">:</span>
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;When specifying stress gradients, bodyforce should be turned off.&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_strs_xx</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">bodyforce</span><span class="p">:</span>
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Bodyforce should be turned off when doing stress restarts.&#39;</span><span class="p">)</span>
		<span class="c1"># WARNING: if stress solution requested and second parameter in sol not -1</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">[</span><span class="s1">&#39;element_integration_INTG&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Gaussian integration scheme can cause spatial osciallations in pressure solution - try sol[</span><span class="se">\&#39;</span><span class="s1">element_integration_INTG</span><span class="se">\&#39;</span><span class="s1">] = 1 if this occurs.&#39;</span><span class="p">)</span>
		<span class="c1"># WARNING: instability if using zoneflux and surf output</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">zoneflux</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span> <span class="o">!=</span> <span class="s1">&#39;tec&#39;</span><span class="p">:</span>
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Use of history output format </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> may not be compatible with zoneflux output (fehm macro: flxz). Use </span><span class="se">\&#39;</span><span class="s1">tec</span><span class="se">\&#39;</span><span class="s1"> if problems experienced.&#39;</span><span class="p">)</span>
		<span class="c1"># WARNING: if a co2 relperm is specified without the carb macro, there will be issues</span>
		<span class="n">co2_rlpm_flag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">for</span> <span class="n">rlpm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rlpmlist</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">phase</span> <span class="ow">in</span> <span class="n">rlpm</span><span class="o">.</span><span class="n">phases</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">phase</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;co2&#39;</span><span class="p">):</span> <span class="n">co2_rlpm_flag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">co2_rlpm_flag</span><span class="p">:</span>
			<span class="n">checkWarnings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Specification of co2 relperm relationship without invoking the CARB module may cause crashes.&#39;</span><span class="p">)</span>
		<span class="c1"># ERROR: check to see no new dictionary keys have been defined</span>
		<span class="n">ctrlFlag</span> <span class="o">=</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">ctrl</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;ctrl&#39;</span><span class="p">)</span>
		<span class="n">iterFlag</span> <span class="o">=</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">iter</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;iter&#39;</span><span class="p">)</span>
		<span class="n">timeFlag</span> <span class="o">=</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
		<span class="n">solFlag</span> <span class="o">=</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">,</span><span class="n">dflt</span><span class="o">.</span><span class="n">sol</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;sol&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ctrlFlag</span> <span class="ow">or</span> <span class="n">iterFlag</span> <span class="ow">or</span> <span class="n">timeFlag</span> <span class="ow">or</span> <span class="n">solFlag</span><span class="p">:</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="c1"># print warnings</span>
		<span class="k">if</span> <span class="n">checkWarnings</span> <span class="ow">or</span> <span class="n">buildWarnings</span><span class="p">:</span>
			
			<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
			<span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">buildWarnings</span><span class="p">:</span>
				<span class="n">s</span> <span class="o">+=</span> <span class="n">warning</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">s</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
		
			<span class="n">L</span> <span class="o">=</span> <span class="mi">62</span>
			<span class="n">s</span><span class="o">+=</span> <span class="s1">&#39; !!!!---------------------------------------------------------!!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">s</span><span class="o">+=</span> <span class="s1">&#39; !!!! Possible errors detected in input file.                 !!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="n">s</span><span class="o">+=</span> <span class="s1">&#39; !!!!---------------------------------------------------------!!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">checkWarnings</span><span class="p">:</span>
				<span class="n">stri</span> <span class="o">=</span> <span class="s1">&#39; !!!! -&#39;</span>
				<span class="n">keepGoing</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">warning</span> <span class="o">=</span> <span class="n">warning</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="k">while</span> <span class="n">keepGoing</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">warning</span><span class="p">:</span> 
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">stri</span><span class="p">)):</span> <span class="n">stri</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">+=</span> <span class="n">stri</span><span class="o">+</span><span class="s1">&#39;!!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
						<span class="n">stri</span> <span class="o">=</span> <span class="s1">&#39; !!!! &#39;</span>
						<span class="k">break</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stri</span><span class="p">)</span><span class="o">&lt;</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">warning</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span> 
						<span class="n">stri</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">warning</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
						<span class="n">warning</span> <span class="o">=</span> <span class="n">warning</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">stri</span><span class="p">)):</span> <span class="n">stri</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span>
						<span class="n">s</span><span class="o">+=</span> <span class="n">stri</span><span class="o">+</span><span class="s1">&#39;!!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
						<span class="n">stri</span> <span class="o">=</span> <span class="s1">&#39; !!!!   &#39;</span>
			<span class="n">s</span><span class="o">+=</span> <span class="s1">&#39; !!!!---------------------------------------------------------!!!!</span><span class="se">\n</span><span class="s1">&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="s1">&#39;pyfehm.err&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;pyfehm.err&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
			<span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="n">checkWarnings</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">buildWarnings</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">return</span> <span class="kc">False</span>
<div class="viewcode-block" id="fdata.temperature_gradient"><a class="viewcode-back" href="../fdata.html#fdata.fdata.temperature_gradient">[docs]</a>	<span class="k">def</span> <span class="nf">temperature_gradient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">offset</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">first_zone</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span><span class="n">auxiliary_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">hydrostatic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">flip_depth_sign</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="sd">&#39;&#39;&#39;Assign initial temperature distribution to model based on supplied temperature profile.</span>
<span class="sd">		</span>
<span class="sd">		:param filename: Name of a file containing temperature gradient data. File should be two columns, comma or space separated, with elevation in the first column and temperature (degC) in the second.</span>
<span class="sd">		:type filename: str</span>
<span class="sd">		:param offset: Vertical offset added to the elevation in temperature gradient data. Useful if model limits don&#39;t correspond to data.</span>
<span class="sd">		:type offset: fl64</span>
<span class="sd">		:param first_zone: Index of first zone created. Zone index will be incremented by 1 thereafter.</span>
<span class="sd">		:type first_zone: int</span>
<span class="sd">		:param auxiliary_file: Name of auxiliary file in which to store **PRES** macros.</span>
<span class="sd">		:type auxiliary_file: str</span>
<span class="sd">		:param hydrostatic: Pressure at top of well profile. PyFEHM will calculate hydrostatic pressures consistent with the temperature profile. If left blank, default pressures will be used.</span>
<span class="sd">		:type hydrostatic: fl64</span>
<span class="sd">		:param flip_depth_sign: If sign of depths in file does not match z coordinate in simulation, flip the sign.</span>
<span class="sd">		:type flip_depth_sign: bool</span>
<span class="sd">		&#39;&#39;&#39;</span>
		<span class="c1"># check if file exists</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: cannot find temperature gradient file </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="c1"># determine uniqueness of z-coords - if less than 100, use zones, if more than 100, use nodes.</span>
		<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">100</span><span class="p">:</span> <span class="n">zoneFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">zoneFlag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="c1"># read temperature data, apply offset, extend or trim to vertical extent of model</span>
		<span class="n">tempfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">tempfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="n">commaFlag</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">spaceFlag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">commaFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">spaceFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">commaFlag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">spaceFlag</span><span class="p">:</span> 
			<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: incorrect formatting for </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">. Expect first column depth (m) and second column temperature (degC), either comma or space separated.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="n">commaFlag</span><span class="p">:</span> <span class="n">tempdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">tempdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
		<span class="n">zt</span> <span class="o">=</span> <span class="n">tempdat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">tt</span> <span class="o">=</span> <span class="n">tempdat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		<span class="n">zt</span> <span class="o">=</span> <span class="n">zt</span> <span class="o">+</span> <span class="n">offset</span>
		<span class="k">if</span> <span class="n">flip_depth_sign</span><span class="p">:</span> <span class="n">zt</span> <span class="o">=</span> <span class="o">-</span><span class="n">zt</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">zt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="n">zt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">zt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span> 
			<span class="n">zt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">zt</span><span class="p">)</span>
			<span class="n">tt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">tt</span><span class="p">)</span>
		<span class="c1"># calculate pressure to assign</span>
		<span class="k">if</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">p0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pres</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">p0</span> <span class="o">=</span> <span class="mf">1.</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: no pressure information, assigning default of 1 MPa. These pressures will be overwritten if GRAD macro used.&#39;</span><span class="p">)</span>
		<span class="c1"># assign zones or nodes</span>
		<span class="k">if</span> <span class="n">zoneFlag</span><span class="p">:</span>
			<span class="n">ind</span> <span class="o">=</span> <span class="n">first_zone</span>
			<span class="n">x0</span><span class="p">,</span><span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmax</span>
			<span class="n">y0</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymax</span>
			<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">z</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">zt</span><span class="p">),</span><span class="n">tt</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">zt</span><span class="p">)])</span>
			<span class="k">if</span> <span class="n">hydrostatic</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>				
				<span class="n">P</span> <span class="o">=</span> <span class="n">fluid_column</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">Tgrad</span> <span class="o">=</span> <span class="n">filename</span><span class="p">,</span> <span class="n">Tsurf</span> <span class="o">=</span> <span class="mf">25.</span><span class="p">,</span> <span class="n">Psurf</span> <span class="o">=</span> <span class="n">hydrostatic</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:,</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">P</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
			
			<span class="k">if</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
			
			<span class="k">for</span> <span class="n">zi</span><span class="p">,</span><span class="n">ti</span><span class="p">,</span><span class="n">pi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">):</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">ind</span><span class="p">)</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">rect</span><span class="p">([</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">zi</span><span class="o">-</span><span class="mf">0.1</span><span class="p">],[</span><span class="n">x1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y1</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="n">zi</span><span class="o">+</span><span class="mf">0.1</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span><span class="n">file</span> <span class="o">=</span> <span class="n">auxiliary_file</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">pi</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">ti</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span>
				<span class="n">ind</span> <span class="o">+=</span><span class="mi">1</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">nd</span><span class="p">,</span><span class="n">ti</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">],</span><span class="n">zt</span><span class="p">,</span><span class="n">tt</span><span class="p">)):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">fmacro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">file</span> <span class="o">=</span> <span class="n">auxiliary_file</span><span class="p">,</span> <span class="n">param</span><span class="o">=</span><span class="p">((</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="n">p0</span><span class="p">),(</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">ti</span><span class="p">),(</span><span class="s1">&#39;saturation&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span></div>
<span class="c1">################## ZONE FUNCTIONS</span>
	<span class="k">def</span> <span class="nf">_read_zonn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>					<span class="c1">#ZONE: Reads ZONE or ZONN macro.</span>
		<span class="n">block</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;zone</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn_file</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
				<span class="n">new_zone</span> <span class="o">=</span> <span class="n">fzone</span><span class="p">()</span>
				<span class="k">if</span> <span class="n">file</span><span class="p">:</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">file</span><span class="o">=</span><span class="n">file</span>
				<span class="c1"># assess whether zone has already been defined</span>
				<span class="n">zind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
				<span class="n">new_zone</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">zind</span>
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">new_zone</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;list&#39;</span><span class="p">:</span>
					<span class="n">new_zone</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;list&#39;</span>
					<span class="n">morePoints</span> <span class="o">=</span> <span class="kc">True</span>
					<span class="k">while</span> <span class="n">morePoints</span><span class="p">:</span>
						<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="n">pts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">pts</span><span class="p">:</span> <span class="n">morePoints</span> <span class="o">=</span> <span class="kc">False</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">nodelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node_nearest_point</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">]))</span>
				<span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;nnum&#39;</span><span class="p">:</span>
					<span class="n">new_zone</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;nnum&#39;</span>					
					<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
					<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
					<span class="n">number_nodes</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>		
					<span class="n">new_zone</span><span class="o">.</span><span class="n">nodelist</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span><span class="o">*</span><span class="n">number_nodes</span>
					<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
					<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> 
						<span class="n">new_zone</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
						<span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
					<span class="k">while</span> <span class="n">i</span><span class="o">!=</span><span class="n">number_nodes</span><span class="p">:</span>
						<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
						<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">:</span> 
							<span class="n">new_zone</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
							<span class="n">i</span> <span class="o">+=</span><span class="mi">1</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">new_zone</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 		<span class="c1"># 3-D geometry</span>
						<span class="n">numPts</span> <span class="o">=</span> <span class="mi">24</span> 						<span class="c1"># number of points to define rect</span>
					<span class="k">else</span><span class="p">:</span> 									<span class="c1"># 2-D geometry</span>
						<span class="n">numPts</span> <span class="o">=</span> <span class="mi">8</span>							<span class="c1"># number of points to define rect</span>
					<span class="n">iPts</span> <span class="o">=</span> <span class="mi">0</span>
					<span class="n">pts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
					<span class="n">allpts</span> <span class="o">=</span> <span class="p">[]</span>
					<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">:</span> <span class="n">allpts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>
					<span class="n">iPts</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span> 
					<span class="k">while</span> <span class="n">iPts</span> <span class="o">!=</span> <span class="n">numPts</span><span class="p">:</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="n">pts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
						<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">:</span> <span class="n">allpts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">pt</span><span class="p">))</span>
						<span class="n">iPts</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span> 
					<span class="n">new_zone</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">allpts</span><span class="p">)))</span>
					<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">)</span><span class="o">==</span><span class="mi">24</span><span class="p">:</span> 
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> 
							<span class="n">new_zone</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
						<span class="k">else</span><span class="p">:</span> 
							<span class="n">new_zone</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
				<span class="c1"># zone already defined, check if definitions match</span>
				<span class="k">if</span> <span class="n">zind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">zn_old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zind</span><span class="p">]</span>
					<span class="k">if</span> <span class="n">zn_old</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
						<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; was defined earlier in the input file. PyFEHM assumes unique zone definitions. This zone will be ignored.&#39;</span><span class="p">)</span>
					<span class="k">elif</span> <span class="n">new_zone</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
						<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
							<span class="n">x0n</span><span class="p">,</span><span class="n">x1n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
							<span class="n">y0n</span><span class="p">,</span><span class="n">y1n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
							<span class="n">z0n</span><span class="p">,</span><span class="n">z1n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
							<span class="n">x0o</span><span class="p">,</span><span class="n">x1o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
							<span class="n">y0o</span><span class="p">,</span><span class="n">y1o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
							<span class="n">z0o</span><span class="p">,</span><span class="n">z1o</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
							
							<span class="k">if</span> <span class="p">(</span><span class="n">x0n</span> <span class="o">!=</span> <span class="n">x0o</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">x1n</span> <span class="o">!=</span> <span class="n">x1o</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">y0n</span> <span class="o">!=</span> <span class="n">y0o</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">y1n</span> <span class="o">!=</span> <span class="n">y1o</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">z0n</span> <span class="o">!=</span> <span class="n">z0o</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">z1n</span> <span class="o">!=</span> <span class="n">z1o</span><span class="p">):</span>
								<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; was defined earlier in the input file. PyFEHM assumes unique zone definitions. This zone will be ignored.&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">different_zone</span> <span class="o">=</span> <span class="kc">False</span>
						<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">zn_old</span><span class="o">.</span><span class="n">nodelist</span><span class="p">)</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">new_zone</span><span class="o">.</span><span class="n">nodelist</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
							<span class="n">different_zone</span> <span class="o">=</span> <span class="kc">True</span>
						
						<span class="k">if</span> <span class="n">different_zone</span><span class="p">:</span>
							<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; was defined earlier in the input file. PyFEHM assumes unique zone definitions. This zone will be ignored.&#39;</span><span class="p">)</span>
				
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_zone</span><span class="p">(</span><span class="n">new_zone</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>		
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">();</span> <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">return</span> <span class="n">block</span>
	<span class="k">def</span> <span class="nf">_read_zonn_rad</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>					<span class="c1">#ZONE: Reads ZONE or ZONN macro.</span>
		<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">more</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="c1"># assess whether zone has already been defined</span>
			<span class="n">zind</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;geometry_ICNL&#39;</span><span class="p">]:</span> <span class="k">return</span>
			
			<span class="n">r_pts</span> <span class="o">=</span> <span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">r_pts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">r_pts</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
			<span class="n">z_pts</span> <span class="o">=</span> <span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">z_pts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span> <span class="k">for</span> <span class="n">pi</span> <span class="ow">in</span> <span class="n">z_pts</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
			
			<span class="n">r_min</span><span class="p">,</span><span class="n">r_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">r_pts</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_pts</span><span class="p">)</span>
			<span class="n">z_min</span><span class="p">,</span><span class="n">z_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z_pts</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z_pts</span><span class="p">)</span>
			
			<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">])</span>
			<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">pts</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
			<span class="n">z</span> <span class="o">=</span> <span class="n">pts</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
			
			<span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">z</span><span class="o">&gt;</span><span class="n">z_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">z</span><span class="o">&lt;</span><span class="n">z_max</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">&gt;</span><span class="n">r_min</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">r</span><span class="o">&lt;</span><span class="n">r_max</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">new_zone</span><span class="p">(</span><span class="n">zind</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">nodelist</span> <span class="o">=</span> <span class="n">nds</span><span class="p">)</span>

			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span> <span class="n">more</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">def</span> <span class="nf">_read_zonn_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">file</span><span class="p">):</span>								<span class="c1">#Reads ZONN from specified file.</span>
		<span class="n">zone_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">zone_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_read_zonn</span><span class="p">(</span><span class="n">zone_file</span><span class="p">,</span><span class="n">file</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_zonn_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>							<span class="c1">#Writes ZONE or ZONN macro.</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="s1">&#39;ZONES&#39;</span><span class="p">,</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="c1"># check for zones specified in external files - write these first</span>
		<span class="n">filezone</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">file_zns</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">file_nms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> 
				<span class="n">filezone</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">file_zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_nms</span><span class="p">:</span> <span class="n">file_nms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">filezone</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">file_nm</span> <span class="ow">in</span> <span class="n">file_nms</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;zonn</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_nm</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>			
				<span class="c1"># if filename does not exist, write file</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">file_nm</span><span class="p">):</span>
					<span class="n">zonefile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_nm</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
					<span class="n">zns</span> <span class="o">=</span> <span class="p">[</span><span class="n">zn</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="o">==</span><span class="n">file_nm</span><span class="p">]</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">zonefile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file_nm</span>
					<span class="n">zonefile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stop</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">zonefile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>	
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;zonn</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">#&#39;</span><span class="o">+</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">ptarray</span> <span class="ow">in</span> <span class="n">zn</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">ptarray</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
	<span class="k">def</span> <span class="nf">_write_zonn_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="o">=</span><span class="p">[]):</span>					<span class="c1">#Writes out a single zone when using sticky</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">zns</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">uniqueZns</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">uniqueZns_inds</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">uniqueZns_inds</span><span class="p">:</span> <span class="n">uniqueZns_inds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">);</span> <span class="n">uniqueZns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
		<span class="n">zns</span> <span class="o">=</span> <span class="n">uniqueZns</span>
		<span class="c1"># check for zones specified in external files - write these first</span>
		<span class="n">filezone</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">regzone</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">file_zns</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">file_nms</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> 
				<span class="n">filezone</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">file_zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">file_nms</span><span class="p">:</span> <span class="n">file_nms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">regzone</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">if</span> <span class="n">filezone</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">file_nm</span> <span class="ow">in</span> <span class="n">file_nms</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;zone</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_nm</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
				<span class="c1"># if filename does not exist, write file</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">file_nm</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeSubFiles</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span>
						<span class="n">zonefile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">file_nm</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">zonefile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_nm</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
					<span class="n">zns</span> <span class="o">=</span> <span class="p">[</span><span class="n">zn</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="o">==</span><span class="n">file_nm</span><span class="p">]</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">zonefile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file_nm</span>
					<span class="n">zonefile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stop</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">zonefile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="k">return</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">regzone</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;zone</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="k">continue</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t\t</span><span class="s1">#&#39;</span><span class="o">+</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">type</span> <span class="o">!=</span> <span class="s1">&#39;rect&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">type</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">for</span> <span class="n">ptarray</span> <span class="ow">in</span> <span class="n">zn</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">ptarray</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
	<span class="k">def</span> <span class="nf">_add_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">fzone</span><span class="p">(),</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>			<span class="c1">#Adds a ZONE object.</span>
		<span class="c1"># check if zone already exists</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: A zone with index &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; already exists. Zone will not be defined, use overwrite = True in add() to overwrite the old zone.&#39;</span><span class="p">)</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
		
			<span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: A zone with name </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> already exists. Zone will not be defined, use overwrite = True in add() to overwrite the old zone.&#39;</span><span class="p">)</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
		
		<span class="n">zone</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="n">zone</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_associate_zone</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_associate_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="p">):</span> 							<span class="c1">#Associates nodes contained within a ZONE, with that zone</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">zone</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>	
			<span class="n">nd</span><span class="o">.</span><span class="n">_zone</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="n">zone</span><span class="p">})</span>
	<span class="k">def</span> <span class="nf">_delete_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zone</span><span class="o">=</span><span class="n">fzone</span><span class="p">()):</span>
		<span class="k">if</span> <span class="n">zone</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">999</span><span class="p">,</span><span class="mi">998</span><span class="p">,</span><span class="mi">997</span><span class="p">,</span><span class="mi">996</span><span class="p">,</span><span class="mi">995</span><span class="p">,</span><span class="mi">994</span><span class="p">]:</span> <span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_is_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>		 								<span class="c1">#Corrects index zone specification to object</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zone_indices</span><span class="p">:</span> 
				<span class="n">obj</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">zone</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Error: zone &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; does not exist.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span> 		
		<span class="k">return</span> <span class="n">obj</span>
	<span class="k">def</span> <span class="nf">_get_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 										<span class="c1">#Prints out information about the data file</span>
		<span class="c1"># grid dimensions</span>
		<span class="kn">import</span> <span class="nn">itertools</span>
		<span class="nb">print</span> <span class="s1">&#39;***********************************************************************&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> 
			<span class="nb">print</span> <span class="s1">&#39;***** &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39; *****&#39;</span> 	<span class="c1"># file name</span>
			<span class="nb">print</span> <span class="s1">&#39;***********************************************************************&#39;</span>		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>												<span class="c1"># grid properties</span>
			<span class="nb">print</span> <span class="s1">&#39;Model domain: x = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">xmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
			<span class="nb">print</span> <span class="s1">&#39;              y = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">ymax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
			<span class="nb">print</span> <span class="s1">&#39;              z = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmin</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">zmax</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
			<span class="nb">print</span> <span class="s1">&#39;          nodes = &#39;</span> <span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">number_nodes</span><span class="p">)</span>
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no grid associated </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> 										<span class="c1"># zones</span>
			<span class="nb">print</span> <span class="s1">&#39;No user defined zones&#39;</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;One user defined zone: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">printStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; user defined zones: &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span> <span class="n">printStr</span><span class="o">+=</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="nb">print</span> <span class="n">printStr</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">permlist</span><span class="p">:</span>												<span class="c1"># permeablities</span>
			<span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permlist</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">perm</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
			<span class="nb">print</span> <span class="s1">&#39;Permeability: </span><span class="se">\n</span><span class="s1">    background - kx, ky, kz = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>
			<span class="k">for</span> <span class="n">perm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permlist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">perm</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="nb">print</span> <span class="s1">&#39;    zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - kx, ky, kz = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>			
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no permeability properties assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">condlist</span><span class="p">:</span>												<span class="c1"># conductivities</span>
			<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">condlist</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
			<span class="nb">print</span> <span class="s1">&#39;Conductivity: </span><span class="se">\n</span><span class="s1">    background - Kx, Ky, Kz = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_y&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_z&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>
			<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">condlist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">cond</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="nb">print</span> <span class="s1">&#39;    zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - Kx, Ky, Kz = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_y&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_z&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;]&#39;</span>
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no conductivity properties assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rocklist</span><span class="p">:</span>												<span class="c1"># rock properties</span>
			<span class="k">for</span> <span class="n">rock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rocklist</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">rock</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
			<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Rock properties: </span><span class="se">\n</span><span class="s1">    background - density = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, specific heat = &#39;</span>
				<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, porosity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity&#39;</span><span class="p">]))</span>
			<span class="k">for</span> <span class="n">rock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rocklist</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">rock</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
				<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;    zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - density = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, specific heat = &#39;</span>
				<span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;, porosity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rock</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity&#39;</span><span class="p">]))</span>
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no rock properties assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowlist</span><span class="p">:</span>												<span class="c1"># generators</span>
			<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;Generators: </span><span class="se">\n</span><span class="s1">    zone &#39;</span>
			<span class="k">for</span> <span class="n">flow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowlist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - &#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;(&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="s1">&#39;) - &#39;</span>
				<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;SKD = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
				<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;EFLOW = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
				<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;AIPED = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">])</span>
				<span class="nb">print</span> <span class="n">prntStr</span>
				<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>	
					<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;            mass production at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
						<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;            mass production against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span> <span class="o">+</span> <span class="s1">&#39; MPa&#39;</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;            mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MJ/kg fluid at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
						<span class="k">else</span><span class="p">:</span><span class="nb">print</span> <span class="s1">&#39;            mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MJ/kg fluid against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; MPa&#39;</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;            mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; degC fluid at fixed rate of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; kg/s&#39;</span>
						<span class="k">else</span><span class="p">:</span><span class="nb">print</span> <span class="s1">&#39;            mass injection of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; degC fluid against specified WHP of &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39; MPa&#39;</span>
				<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;    zone &#39;</span>
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span><span class="p">:</span>											<span class="c1"># flow boundary conditions</span>
			<span class="nb">print</span> <span class="s1">&#39;Flow boundary conditions: zone INCOMPLETE&#39;</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">flowlist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounlist</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2flowlist</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no boundary conditions assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>		 								<span class="c1"># co2 module</span>
			<span class="n">co2model</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Water only&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;CO2 only&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;CO2-water, no solubility&#39;</span><span class="p">),</span>
			<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;CO2-water, with solubility&#39;</span><span class="p">),(</span><span class="mi">5</span><span class="p">,</span><span class="s1">&#39;CO2-water-air, with solubility&#39;</span><span class="p">)])</span>
			<span class="nb">print</span> <span class="s1">&#39;CO2 module: &#39;</span> <span class="o">+</span> <span class="n">co2model</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span><span class="p">]</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2flowlist</span><span class="p">:</span>
				<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;....CO2 generators: zone &#39;</span>
				<span class="k">for</span> <span class="n">co2flow</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2flowlist</span><span class="p">:</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">co2flow</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - SKTMP = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, ESKTMP = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">])</span>
								<span class="o">+</span> <span class="s1">&#39;, AIPED = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">co2flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;, FLAG = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2flow</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;bc_flag&#39;</span><span class="p">]))</span>
					<span class="nb">print</span> <span class="n">prntStr</span>
					<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;                  : zone &#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2fraclist</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">co2frac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2fraclist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">co2frac</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
				<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;....Initial CO2 fractions: </span><span class="se">\n</span><span class="s1">        background - water saturation = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;water_rich_sat&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, CO2 saturation = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;co2_rich_sat&#39;</span><span class="p">])</span>
				<span class="o">+</span><span class="s1">&#39;, CO2 mass fraction = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;co2_mass_frac&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, CO2 initial salt concentration = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;init_salt_conc&#39;</span><span class="p">]))</span>
				<span class="k">for</span> <span class="n">co2frac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2fraclist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">co2frac</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
					<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;                          zone - water saturation = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;water_rich_sat&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, CO2 saturation = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;co2_rich_sat&#39;</span><span class="p">])</span>
				<span class="o">+</span><span class="s1">&#39;, CO2 mass fraction = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;co2_mass_frac&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, CO2 initial salt concentration = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2frac</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;init_salt_conc&#39;</span><span class="p">]))</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span>
				<span class="n">phase</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;liquid&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;two phase&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;vapour&#39;</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;super-critical&#39;</span><span class="p">)])</span>
				<span class="k">for</span> <span class="n">co2pres</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">co2pres</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
				<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;....Initial CO2 conditions: </span><span class="se">\n</span><span class="s1">        background - pressure = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MPa, temperature = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">])</span>
				<span class="o">+</span><span class="s1">&#39; degC, phase = &#39;</span><span class="o">+</span><span class="n">phase</span><span class="p">[</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]])</span>
				<span class="k">for</span> <span class="n">co2pres</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">co2preslist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">co2pres</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>					
					<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;                            zone - pressure = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MPa, temperature = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">])</span>
					<span class="o">+</span><span class="s1">&#39; degC, phase = &#39;</span><span class="o">+</span><span class="n">phase</span><span class="p">[</span><span class="n">co2pres</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;phase&#39;</span><span class="p">]])</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]:</span> 								<span class="c1"># stress module</span>
			<span class="nb">print</span> <span class="s1">&#39;Stress module:&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elasticlist</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">elastic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elasticlist</span><span class="p">:</span> 
					<span class="k">if</span> <span class="n">elastic</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
				<span class="nb">print</span> <span class="s1">&#39;....Elastic properties: </span><span class="se">\n</span><span class="s1">        background - E = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MPa, nu = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">])</span>
				<span class="k">for</span> <span class="n">elastic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elasticlist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">elastic</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
					<span class="nb">print</span> <span class="s1">&#39;        zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - E = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; MPa, nu = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">elastic</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;    </span><span class="si">%%%%</span><span class="s1">% no elastic properties assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">biotlist</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">biot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biotlist</span><span class="p">:</span> 
					<span class="k">if</span> <span class="n">biot</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
				<span class="nb">print</span> <span class="s1">&#39;....Thermo and poroelastic properties: </span><span class="se">\n</span><span class="s1">        background - thermal = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">biot</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, pressure = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">biot</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">])</span>
				<span class="k">for</span> <span class="n">biot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">biotlist</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">biot</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="k">continue</span>
					<span class="nb">print</span> <span class="s1">&#39;        zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">biot</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; - thermal = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">biot</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, pressure = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">biot</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;    </span><span class="si">%%%%</span><span class="s1">% no pore pressure (biot) properties assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stressbounlist</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;....Stress boundary conditions: &#39;</span>
				<span class="n">strsDirs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;x-dir&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;y-dir&#39;</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;z-dir&#39;</span><span class="p">)])</span>
				<span class="k">for</span> <span class="n">strs_boun</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stressbounlist</span><span class="p">:</span> 
					<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;        zone &#39;</span>
					<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; - &#39;</span>
					<span class="k">if</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">subtype</span><span class="o">==</span><span class="s1">&#39;lithograd&#39;</span><span class="p">:</span> 
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;lithograd, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;stress grad = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39; MPa/m&#39;</span>
					<span class="k">elif</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;distributed&#39;</span><span class="p">:</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">subtype</span> <span class="o">+</span><span class="s1">&#39; force, &#39;</span>	
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39; MPa&#39;</span>
					<span class="k">elif</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;lithostatic&#39;</span><span class="p">:</span>
						<span class="n">prntStr</span> <span class="o">+=</span><span class="s1">&#39;not done!&#39;</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;fixed disp, &#39;</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;fixed force, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="n">strsDirs</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])]</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span>
						<span class="k">if</span> <span class="n">strs_boun</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;m&#39;</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;MPa&#39;</span>
					<span class="nb">print</span> <span class="n">prntStr</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;    </span><span class="si">%%%%</span><span class="s1">% no stress boundary conditions assigned </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;....Stress-permeability relationships:&#39;</span>
				<span class="k">for</span> <span class="n">perm_model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">permmodellist</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">perm_model</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span> <span class="k">continue</span>
					<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;        model &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">perm_model</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">perm_model</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; - zone &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">perm_model</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39; - zones &#39;</span> 
						<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">perm_model</span><span class="o">.</span><span class="n">zone</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span>
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">perm_model</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">par</span><span class="p">,</span><span class="n">unit</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">permDicts</span><span class="p">[</span><span class="n">perm_model</span><span class="o">.</span><span class="n">index</span><span class="p">],</span><span class="n">permUnits</span><span class="p">[</span><span class="n">perm_model</span><span class="o">.</span><span class="n">index</span><span class="p">]):</span>
						<span class="k">if</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">perm_model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
							<span class="n">prntStr</span> <span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">            &#39;</span><span class="o">+</span><span class="n">par</span><span class="o">+</span><span class="s1">&#39; = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">perm_model</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">par</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">unit</span>
					<span class="k">if</span> <span class="n">perm_model</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span> 
						<span class="n">prntStr</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">            no permeability modification&#39;</span>
					<span class="nb">print</span> <span class="n">prntStr</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="nb">print</span> <span class="s1">&#39;    </span><span class="si">%%%%</span><span class="s1">% no stress-permeability models specified </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
			<span class="nb">print</span> <span class="s1">&#39; &#39;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>											<span class="c1"># contour output</span>
			<span class="nb">print</span> <span class="s1">&#39;Contour output (&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39; format) requested for - &#39;</span>
			<span class="c1">#vars = list(itertools.chain(*self.cont.variables))</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>											<span class="c1"># history output</span>
			<span class="nb">print</span> <span class="s1">&#39;History output (&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">format</span><span class="o">+</span><span class="s1">&#39; format) requested for - &#39;</span>			
			<span class="nb">vars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">))</span>
			<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;    &#39;</span><span class="o">+</span><span class="n">var</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">cont</span><span class="o">.</span><span class="n">variables</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%%%%</span><span class="s1">% no output requested </span><span class="si">%%%%</span><span class="s1">%&#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;***********************************************************************&#39;</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_info</span><span class="p">)</span>
<span class="c1">################## MACRO FUNCTIONS</span>
	<span class="k">def</span> <span class="nf">_read_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">macroName</span><span class="p">,</span><span class="n">second</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>	<span class="c1">#MACRO: Reads general format macros</span>
		<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">copy</span><span class="p">,</span><span class="n">deepcopy</span>
		<span class="n">more</span><span class="o">=</span><span class="kc">True</span>
		<span class="n">file_flag</span><span class="o">=</span><span class="kc">False</span>
		<span class="n">grad_flag</span><span class="o">=</span><span class="kc">True</span>
		<span class="k">while</span> <span class="n">more</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">macroName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;permmodel&#39;</span><span class="p">,</span><span class="s1">&#39;rlp&#39;</span><span class="p">]:</span>
				<span class="n">m</span> <span class="o">=</span> <span class="n">fmacro</span><span class="p">(</span><span class="n">macroName</span><span class="p">)</span>
				<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span> <span class="n">more</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="k">continue</span>		
				<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">):</span> <span class="n">more</span><span class="o">=</span><span class="kc">False</span><span class="p">;</span> <span class="n">file_flag</span> <span class="o">=</span> <span class="kc">True</span><span class="p">;</span> <span class="k">continue</span> 		<span class="c1"># read file data</span>
<span class="c1">#				params = copy(dict(macro_list[macroName]))</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for stressboun vvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="c1"># assess boundary condition type									  #v</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;stressboun&#39;</span><span class="p">:</span>											  <span class="c1">#v</span>
					<span class="n">m</span><span class="o">.</span><span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;fixed&#39;</span>													  <span class="c1">#v</span>
					<span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;distributed&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;lithostatic&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;lithograd&#39;</span><span class="p">):</span>
						<span class="n">m</span><span class="o">.</span><span class="n">subtype</span><span class="o">=</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>										  <span class="c1">#v</span>
						<span class="n">oldline</span> <span class="o">=</span> <span class="n">line</span><span class="p">;</span> <span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>					  <span class="c1">#^</span>
					<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">subtype</span><span class="o">==</span><span class="s1">&#39;lithograd&#39;</span><span class="p">:</span>											  <span class="c1">#^</span>
						<span class="n">m</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;sdepth&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">oldline</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>						  <span class="c1">#^</span>
						<span class="n">m</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;gdepth&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">oldline</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">])</span>						  <span class="c1">#^</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="c1"># turn boolean &#39;more&#39; into countdown								  #v</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span>													  <span class="c1">#v</span>
					<span class="k">if</span> <span class="n">grad_flag</span><span class="p">:</span>														  <span class="c1">#v</span>
						<span class="n">more</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>										  <span class="c1">#v</span>
						<span class="n">grad_flag</span><span class="o">=</span><span class="kc">False</span>													  <span class="c1">#^</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>								  <span class="c1">#^</span>
					<span class="n">more</span> <span class="o">-=</span> <span class="mi">1</span>															  <span class="c1">#^</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
				<span class="n">nums_zone</span><span class="p">,</span><span class="n">nums_params</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">nums_zone</span><span class="p">,</span><span class="n">nums_params</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[:</span><span class="mi">1</span><span class="p">],</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
				<span class="n">m</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums_zone</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">second</span><span class="p">:</span> 
					<span class="n">m</span><span class="o">.</span><span class="n">file</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">name</span>
				<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">macro_list</span><span class="p">[</span><span class="n">macroName</span><span class="p">]):</span> <span class="n">m</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">nums_params</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>			
				<span class="bp">self</span><span class="o">.</span><span class="n">_add_macro</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">file_flag</span><span class="p">:</span>
			<span class="n">line</span><span class="o">=</span><span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
				<span class="c1"># check if in subdirectory with input file</span>
				<span class="n">fname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
					<span class="n">fn0</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
					<span class="k">for</span> <span class="n">fn</span> <span class="ow">in</span> <span class="n">fname</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">fn0</span> <span class="o">+=</span> <span class="n">fn</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fn0</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">line</span><span class="p">):</span>
						<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: cannot find macro file &#39;</span><span class="o">+</span><span class="n">line</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn0</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">line</span><span class="p">)</span>
						<span class="n">line</span> <span class="o">=</span> <span class="n">macrofile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
						<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">macrofile</span><span class="p">,</span><span class="n">macroName</span><span class="p">,</span><span class="n">second</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
						<span class="n">macrofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">macrofile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_read_macro</span><span class="p">(</span><span class="n">macrofile</span><span class="p">,</span><span class="n">macroName</span><span class="p">,</span><span class="n">second</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
				<span class="n">macrofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_add_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">macro</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>					<span class="c1">#Adds the macro to data file</span>
		<span class="c1"># check macro zone definition</span>
		<span class="n">macro</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 	<span class="c1"># assign everywhere zone</span>
		<span class="c1">#elif isinstance(macro.zone,fnode): macro.zone = tuple([macro.zone.index, 1, 1])</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">])</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: Specified zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; for macro &#39;</span><span class="o">+</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39; does not exist.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
		
		<span class="c1"># check if macro already exists</span>
		<span class="n">exclusions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span><span class="s1">&#39;stressboun&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">)</span> <span class="ow">and</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclusions</span><span class="p">:</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span>
			<span class="n">keys</span> <span class="o">=</span>  <span class="p">[]</span>
			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">]:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
					<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
			
			<span class="n">keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: A &#39;</span><span class="o">+</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39; macro for zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; already exists. Macro will not be defined, use overwrite = True in add() to overwrite the old macro.&#39;</span><span class="p">)</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>
		
			<span class="n">keys</span> <span class="o">=</span>  <span class="p">[]</span>
			<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">]:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
					<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
				<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">m</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
			
			<span class="n">keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite</span><span class="p">:</span>
					<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: A macro for zone </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1"> already exists. Macro will not be defined, use overwrite = True in add() to overwrite the old macro.&#39;</span><span class="p">)</span>
					<span class="k">return</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
	
		<span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_associate_macro</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_associate_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">macro</span><span class="p">):</span>							<span class="c1">#Associates macro properties with nodes</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">zn</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>	
					<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;rlp&#39;</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_rlpmodel</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">index</span>
					<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;permmodel&#39;</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">_permmodel</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">index</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
			<span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
			<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;pres&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="mf">1.</span>
				<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">tsat</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">])</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
				<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Ti</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_Si</span> <span class="o">=</span> <span class="mf">0.</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rock&#39;</span><span class="p">:</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_density</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_specific_heat</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">]</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_porosity</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;elastic&#39;</span><span class="p">:</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_youngs_modulus</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">]</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_poissons_ratio</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;biot&#39;</span><span class="p">:</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_thermal_expansion</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">]</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_pressure_coupling</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;cond&#39;</span><span class="p">:</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_conductivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">]])</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;perm&#39;</span><span class="p">:</span>
				<span class="n">nd</span><span class="o">.</span><span class="n">_permeability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">]])</span>
			
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> <span class="n">zn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="n">zn</span><span class="o">.</span><span class="n">nodelist</span><span class="p">:</span>	
				<span class="c1"># add generator properties</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;flow&#39;</span><span class="p">:</span>
					<span class="n">addToNode</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">addToNode</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;co2flow&#39;</span><span class="p">:</span>
					<span class="n">addToNode</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;co2rate&#39;</span><span class="p">:</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;rate&#39;</span><span class="p">],</span><span class="s1">&#39;co2energy&#39;</span><span class="p">:</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span><span class="s1">&#39;co2impedance&#39;</span><span class="p">:</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;impedance&#39;</span><span class="p">],</span><span class="s1">&#39;co2bc_flag&#39;</span><span class="p">:</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;bc_flag&#39;</span><span class="p">]}</span>
					<span class="n">nd</span><span class="o">.</span><span class="n">_generator</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">addToNode</span><span class="p">)</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">_updateFlag</span> <span class="o">=</span> <span class="kc">False</span>
			<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;pres&#39;</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Ti</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Si</span> <span class="o">=</span> <span class="mf">1.</span>
				<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Ti</span> <span class="o">=</span> <span class="n">tsat</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">])</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Si</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
				<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;saturation&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Pi</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Ti</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;temperature&#39;</span><span class="p">]</span>
					<span class="n">zn</span><span class="o">.</span><span class="n">Si</span> <span class="o">=</span> <span class="mf">0.</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;rock&#39;</span><span class="p">:</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">density</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">specific_heat</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;specific_heat&#39;</span><span class="p">]</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">porosity</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;porosity&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;elastic&#39;</span><span class="p">:</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">youngs_modulus</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;youngs_modulus&#39;</span><span class="p">]</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">poissons_ratio</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;poissons_ratio&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;biot&#39;</span><span class="p">:</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">thermal_expansion</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;thermal_expansion&#39;</span><span class="p">]</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">pressure_coupling</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;pressure_coupling&#39;</span><span class="p">]</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;cond&#39;</span><span class="p">:</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;cond_x&#39;</span><span class="p">]])</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;perm&#39;</span><span class="p">:</span>
				<span class="n">zn</span><span class="o">.</span><span class="n">permeability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kx&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ky&#39;</span><span class="p">],</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">]])</span>
			<span class="n">zn</span><span class="o">.</span><span class="n">_updateFlag</span> <span class="o">=</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_delete_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">macro</span><span class="p">):</span>								<span class="c1">#Deletes macro from data file</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_macro_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">nums</span><span class="p">):</span>									<span class="c1">#Assigns zone to macro dictionary</span>
		<span class="c1"># assumes object has members &#39;zone&#39; and &#39;node&#39;</span>
		<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
		<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>													  <span class="c1">#v</span>
			<span class="k">if</span> <span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>				  <span class="c1">#v</span>
			<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span>						  <span class="c1">#^</span>
		<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
		<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="ow">and</span> <span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">):</span>
			<span class="n">k</span> <span class="o">=</span> <span class="n">_zone_ind</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; has not been defined&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">);</span> <span class="k">return</span> <span class="kc">None</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
	<span class="k">def</span> <span class="nf">_write_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">,</span><span class="n">macroName</span><span class="p">):</span>					<span class="c1">#Writes macro dictionary to output file</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="n">macro_titles</span><span class="p">[</span><span class="n">macroName</span><span class="p">],</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">printToFile</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="n">filemacros</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">textmacros</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">singlemacros</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">nul</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="p">[</span><span class="n">macroName</span><span class="p">]]</span>
		<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">]:</span>
			<span class="c1"># check no additional parameters defined</span>
			<span class="k">if</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;macro &#39;</span><span class="o">+</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;macro &#39;</span><span class="o">+</span><span class="n">macro</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="n">printToFile</span> <span class="o">=</span> <span class="kc">True</span><span class="p">;</span> <span class="n">textmacros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="n">filemacros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">_write_one_macro</span><span class="p">:</span> <span class="n">singlemacros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">textmacros</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="p">)</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">printToFile</span><span class="p">:</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
				<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="p">(</span><span class="n">textmacros</span><span class="o">+</span><span class="n">filemacros</span><span class="p">):</span>
					<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
						<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span>
					<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
						<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">:</span>
							<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">textmacros</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;bodyforce&#39;</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">textmacros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subtype</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
			<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="c1">#for macro in self._allMacro[macroName]:</span>
			<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="n">textmacros</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">printToFile</span><span class="p">:</span>
					<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span> <span class="o">!=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span> <span class="k">continue</span>
				<span class="k">elif</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span><span class="p">:</span> <span class="k">continue</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for stressboun vvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="k">if</span> <span class="n">macroName</span><span class="o">==</span><span class="s1">&#39;stressboun&#39;</span><span class="p">:</span>											  <span class="c1">#v</span>
					<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">subtype</span> <span class="o">!=</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>									  <span class="c1">#v</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">subtype</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>							  <span class="c1">#v</span>
						<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;lithograd&#39;</span><span class="p">:</span>							  <span class="c1">#^</span>
							<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;sdepth&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;gdepth&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>									  <span class="c1">#^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span>											  <span class="c1">#v</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;all</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>						  <span class="c1">#v</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 					  <span class="c1">#v</span>
						<span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])</span>		  <span class="c1">#^</span>
						<span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">])</span>		  <span class="c1">#^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="p">[</span><span class="n">macroName</span><span class="p">]:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span> <span class="ow">and</span> <span class="n">macro</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span> 
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for stressboun vvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="k">if</span> <span class="n">macroName</span><span class="o">==</span><span class="s1">&#39;stressboun&#39;</span> <span class="ow">and</span> <span class="n">macro</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span><span class="c1">#v</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">stressboun</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>									  <span class="c1">#^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>		
<span class="c1">##########################################	</span>
			
<span class="c1">##########################################		</span>
		<span class="k">if</span> <span class="n">singlemacros</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="n">singlemacros</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,[</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">])</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;bodyforce&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">singlemacros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subtype</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">]))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for stressboun vvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="k">if</span> <span class="n">macroName</span><span class="o">==</span><span class="s1">&#39;stressboun&#39;</span><span class="p">:</span>											  <span class="c1">#v</span>
					<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">subtype</span> <span class="o">!=</span> <span class="s1">&#39;fixed&#39;</span><span class="p">:</span>									  <span class="c1">#v</span>
						<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">subtype</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>							  <span class="c1">#v</span>
						<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">subtype</span> <span class="o">==</span> <span class="s1">&#39;lithograd&#39;</span><span class="p">:</span>							  <span class="c1">#^</span>
							<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;sdepth&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;gdepth&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>									  <span class="c1">#^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="n">zn</span> <span class="o">=</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
				<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvv exception for grad vvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
					<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span><span class="p">:</span>											  <span class="c1">#v</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;all</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>						  <span class="c1">#v</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 					  <span class="c1">#v</span>
						<span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;direction&#39;</span><span class="p">])</span>		  <span class="c1">#^</span>
						<span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">])</span>		  <span class="c1">#^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
				<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
					<span class="k">else</span><span class="p">:</span>
						<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
						<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">macro_list</span><span class="p">[</span><span class="n">macroName</span><span class="p">]:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;grad&#39;</span> <span class="ow">and</span> <span class="n">macro</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span> 
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				
<span class="c1">##########################################	</span>
			
<span class="c1">##########################################		</span>
		<span class="k">if</span> <span class="n">filemacros</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">printToFile</span><span class="p">:</span>
			<span class="n">unique_fnames</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="n">filemacros</span><span class="p">:</span> 
				<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_fnames</span><span class="p">:</span> <span class="n">unique_fnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">file_nm</span> <span class="ow">in</span> <span class="n">unique_fnames</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">macroName</span> <span class="o">==</span> <span class="s1">&#39;bodyforce&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">filemacros</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subtype</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">macroName</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;file</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_nm</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
				<span class="c1"># if filename does not exist, write file</span>
				<span class="n">file_nm</span> <span class="o">=</span> <span class="n">file_nm</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">file_nm</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeSubFiles</span><span class="p">:</span>
					<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span><span class="o">+</span><span class="n">file_nm</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">macrofile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_nm</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
					<span class="n">macros</span> <span class="o">=</span> <span class="p">[</span><span class="n">macro</span> <span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macroName</span><span class="p">]</span> <span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span><span class="o">==</span><span class="n">file_nm</span><span class="p">]</span>
					<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="n">macros</span><span class="p">:</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_write_macro</span><span class="p">(</span><span class="n">macrofile</span><span class="p">,</span><span class="n">macroName</span><span class="p">)</span>
					<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="n">macros</span><span class="p">:</span> <span class="n">macro</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file_nm</span>
					<span class="n">macrofile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;stop</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="n">macrofile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">macroName</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">_get_macro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">macro</span><span class="p">):</span>									<span class="c1">#Constructs macro lists and dictionaries</span>
		<span class="n">tempDict</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">macro</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="n">macro</span><span class="p">]:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
				<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">),</span><span class="n">macro</span><span class="p">))</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
				<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">macro</span><span class="p">))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">macro</span><span class="p">))</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span>
					<span class="k">if</span> <span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
						<span class="n">tempDict</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">macro</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">macro</span><span class="p">))</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">tempDict</span><span class="p">)</span>
<span class="c1">################## MODEL FUNCTIONS</span>
	<span class="k">def</span> <span class="nf">_read_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">modelName</span><span class="p">):</span> 				<span class="c1">#MODEL: Reads general format models</span>
		<span class="c1"># redirect of special cases</span>
		<span class="k">if</span> <span class="n">modelName</span> <span class="o">==</span> <span class="s1">&#39;ppor&#39;</span><span class="p">:</span>	<span class="bp">self</span><span class="o">.</span><span class="n">_read_model_ppor</span><span class="p">(</span><span class="n">infile</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">modelName</span> <span class="o">==</span> <span class="s1">&#39;plastic&#39;</span><span class="p">:</span>	<span class="bp">self</span><span class="o">.</span><span class="n">_read_model_plastic</span><span class="p">(</span><span class="n">infile</span><span class="p">);</span> <span class="k">return</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">models</span><span class="o">=</span><span class="p">[]</span>
		<span class="k">while</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>									<span class="c1"># perm model specification</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">parVector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> 	<span class="c1"># parameter values</span>
			<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
			<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for rlp model 16 vvvvvvvvvvvvvvvvvvvvvvv</span>
			<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;rlp&#39;</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span><span class="mi">16</span><span class="p">:</span>									  <span class="c1">#v</span>
				<span class="n">parVector</span> <span class="o">=</span> <span class="n">parVector</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="n">parVector</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>						  <span class="c1">#^</span>
			<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">][</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parVector</span><span class="p">))]</span>
			<span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parList</span><span class="p">,</span><span class="n">parVector</span><span class="p">))</span> 	<span class="c1"># make dictionary</span>
			<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>		
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> 								<span class="c1"># perm model zone assignments</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">models</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_model</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_model_plastic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span> 		
		<span class="c1"># redirect of special cases</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
		<span class="n">m</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">parVector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span> 	<span class="c1"># parameter values</span>
		<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">parList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">][</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
		<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
			<span class="n">parList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parVector</span><span class="p">))]</span>
		<span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parList</span><span class="p">,</span><span class="n">parVector</span><span class="p">))</span> 	<span class="c1"># make dictionary</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_add_model</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_model_trac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">,</span><span class="n">transverseFlag</span><span class="p">):</span> 
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">models1</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">models2</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>									<span class="c1"># perm model specification</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">i1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">nums1</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">transverseFlag</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span> <span class="n">i2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span> <span class="n">nums2</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
				<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nums2</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span> <span class="n">i2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span> <span class="n">nums2</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
				<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span> <span class="n">i2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nums2</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
			<span class="c1"># create adsorption model</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="s1">&#39;adsorption&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">i1</span><span class="p">)</span>
			<span class="n">parVector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums1</span><span class="p">]</span> 	<span class="c1"># parameter values</span>
			<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">][</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parVector</span><span class="p">))]</span>
			<span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parList</span><span class="p">,</span><span class="n">parVector</span><span class="p">))</span> 	<span class="c1"># make dictionary</span>
			<span class="n">models1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
			<span class="c1"># create diffusion model</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="s1">&#39;diffusion&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">i2</span><span class="p">)</span>
			<span class="n">parVector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums2</span><span class="p">]</span> 	<span class="c1"># parameter values</span>
			<span class="k">if</span> <span class="n">transverseFlag</span><span class="p">:</span> <span class="n">parVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">][</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">parList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parVector</span><span class="p">))]</span>
			<span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parList</span><span class="p">,</span><span class="n">parVector</span><span class="p">))</span> 	<span class="c1"># make dictionary</span>
			<span class="n">models2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>		
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> 								<span class="c1"># perm model zone assignments</span>
			<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">models1</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
			<span class="n">models2</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">zonelist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">))</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">models1</span><span class="p">,</span><span class="n">models2</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_read_model_ppor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">infile</span><span class="p">):</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>		
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">m</span> <span class="o">=</span> <span class="n">fmodel</span><span class="p">(</span><span class="s1">&#39;ppor&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">nums</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
		
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
		<span class="n">nums</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">m</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_macro_zone</span><span class="p">(</span><span class="n">nums</span><span class="p">[:</span><span class="mi">3</span><span class="p">])]</span>
		<span class="n">parVector</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span> 	<span class="c1"># parameter values</span>
		<span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">parList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">][</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
		<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
			<span class="n">parList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">parVector</span><span class="p">))]</span>
		<span class="n">m</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parList</span><span class="p">,</span><span class="n">parVector</span><span class="p">))</span> 	<span class="c1"># make dictionary</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_add_model</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_add_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
		<span class="n">model</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> 	<span class="c1"># assign everywhere zone</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span> <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">])]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">str</span><span class="p">)):</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
				<span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]]</span>
			<span class="k">else</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: Specified zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; for model &#39;</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39; does not exist.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]</span>
		<span class="n">newlist</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,(</span><span class="nb">tuple</span><span class="p">,</span><span class="n">fzone</span><span class="p">)):</span> <span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="n">newlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zone</span><span class="p">[</span><span class="n">zn</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span> 
				<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;ERROR: Specified zone &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; for model &#39;</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39; does not exist.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
				<span class="k">return</span>
		<span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="n">newlist</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_associate_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_associate_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
		<span class="s1">&#39;placeholder&#39;</span>
	<span class="k">def</span> <span class="nf">_delete_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">,</span><span class="n">modelName</span><span class="p">):</span>
		<span class="c1"># redirect of special cases</span>
		<span class="k">if</span> <span class="n">modelName</span> <span class="o">==</span> <span class="s1">&#39;ppor&#39;</span><span class="p">:</span>	<span class="bp">self</span><span class="o">.</span><span class="n">_write_model_ppor</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">modelName</span> <span class="o">==</span> <span class="s1">&#39;plastic&#39;</span><span class="p">:</span>	<span class="bp">self</span><span class="o">.</span><span class="n">_write_model_plastic</span><span class="p">(</span><span class="n">outfile</span><span class="p">);</span> <span class="k">return</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="n">model_titles</span><span class="p">[</span><span class="n">modelName</span><span class="p">],</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">modelName</span><span class="p">]:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
		
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">modelName</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">itemgetter</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">modelName</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">modelName</span><span class="p">]:</span>
			<span class="c1"># check no additional parameters defined</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">keys</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">][</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">dict_key_check</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">,</span><span class="n">keys</span><span class="p">,</span><span class="s1">&#39;macro &#39;</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">):</span> <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;model &#39;</span><span class="o">+</span><span class="n">model</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="n">modelName</span><span class="p">][</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
			<span class="c1">#vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
			<span class="c1">#vvvvvvvvvvvvvvvvvvvv exception for rlp model 16 vvvvvvvvvvvvvvvvvvvvvvv</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span><span class="s1">&#39;rlp&#39;</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span><span class="mi">16</span><span class="p">:</span>							  <span class="c1">#v</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="p">(</span><span class="n">parVector</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;write0&#39;</span><span class="p">,</span><span class="s1">&#39;write0&#39;</span><span class="p">,</span><span class="s1">&#39;write0&#39;</span><span class="p">,</span><span class="s1">&#39;write0&#39;</span><span class="p">]</span><span class="o">+</span>
				<span class="n">parVector</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;write0&#39;</span><span class="p">,</span><span class="s1">&#39;write0&#39;</span><span class="p">])</span>	  							  <span class="c1">#^</span>
			<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^ end exception ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="c1">#^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>
			<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">paramList</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">key</span> <span class="o">==</span><span class="s1">&#39;write0&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0 &#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">model_count</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">modelName</span><span class="p">]:</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">0</span><span class="p">],]</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span> <span class="n">macro_count</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span> <span class="k">continue</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,</span><span class="n">fzone</span><span class="p">):</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">,]</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
					<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model_count</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">model_count</span><span class="o">+=</span><span class="mi">1</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
		<span class="bp">self</span><span class="o">.</span><span class="n">_write_general_macro</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">modelName</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_write_model_ppor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="n">model_titles</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">],</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sticky_zones</span><span class="p">:</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">:</span>
						<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span> <span class="p">:</span> <span class="n">zns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_write_zonn_one</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span><span class="n">zns</span><span class="p">)</span>
		
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ppor&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">itemgetter</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]:</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">][</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="n">zn</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">zonelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">zn</span><span class="p">,</span><span class="nb">tuple</span><span class="p">):</span>
				<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="ow">not</span> <span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;0</span><span class="se">\t</span><span class="s1">0</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span> 
			<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">paramList</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">key</span> <span class="o">==</span><span class="s1">&#39;write0&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0 &#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_write_model_plastic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">outfile</span><span class="p">):</span>
		<span class="n">ws</span> <span class="o">=</span> <span class="n">_title_string</span><span class="p">(</span><span class="n">model_titles</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">],</span><span class="mi">72</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
		<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">itemgetter</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;plastic</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;1</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">]:</span>
			<span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="n">model_list</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">][</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> 		<span class="c1"># parameter names</span>
			<span class="k">else</span><span class="p">:</span> 	<span class="c1"># enumerate generic parameter names</span>
				<span class="n">paramList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;param&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">paramList</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="n">key</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">key</span> <span class="o">==</span><span class="s1">&#39;write0&#39;</span><span class="p">:</span>
					<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;0 &#39;</span><span class="p">)</span>
			<span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">model</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">m</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="n">model</span><span class="p">]])</span>
<span class="c1">################## MACRO, ZONE, BOUN LISTS</span>
	<span class="k">def</span> <span class="nf">_get_pres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;pres&#39;</span><span class="p">)</span>
	<span class="n">pres</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_pres</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_preslist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;pres&#39;</span><span class="p">]</span>
	<span class="n">preslist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_preslist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_perm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;perm&#39;</span><span class="p">)</span>
	<span class="n">perm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_perm</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_permlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;perm&#39;</span><span class="p">]</span>
	<span class="n">permlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_permlist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_rock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;rock&#39;</span><span class="p">)</span>
	<span class="n">rock</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rock</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_rocklist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;rock&#39;</span><span class="p">]</span>
	<span class="n">rocklist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rocklist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">)</span>
	<span class="n">cond</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_cond</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_condlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">]</span>
	<span class="n">condlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_condlist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;grad&#39;</span><span class="p">)</span>
	<span class="n">grad</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_grad</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_gradlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;grad&#39;</span><span class="p">]</span>
	<span class="n">gradlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_gradlist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;flow&#39;</span><span class="p">)</span>
	<span class="n">flow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_flow</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_flowlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span>
	<span class="n">flowlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_flowlist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_hflx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;hflx&#39;</span><span class="p">)</span>
	<span class="n">hflx</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hflx</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_hflxlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;hflx&#39;</span><span class="p">]</span>
	<span class="n">hflxlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hflxlist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_biot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;biot&#39;</span><span class="p">)</span>
	<span class="n">biot</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_biot</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_biotlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;biot&#39;</span><span class="p">]</span>
	<span class="n">biotlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_biotlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_elastic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;elastic&#39;</span><span class="p">)</span>
	<span class="n">elastic</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_elastic</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_elasticlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;elastic&#39;</span><span class="p">]</span>
	<span class="n">elasticlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_elasticlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_bodyforce</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">)</span>
	<span class="n">bodyforce</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bodyforce</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_bodyforcelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;bodyforce&#39;</span><span class="p">]</span>
	<span class="n">bodyforcelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bodyforcelist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2frac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;co2frac&#39;</span><span class="p">)</span>
	<span class="n">co2frac</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2frac</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2fraclist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;co2frac&#39;</span><span class="p">]</span>
	<span class="n">co2fraclist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2fraclist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2flow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;co2flow&#39;</span><span class="p">)</span>
	<span class="n">co2flow</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2flow</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_co2flowlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;co2flow&#39;</span><span class="p">]</span>
	<span class="n">co2flowlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2flowlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2pres</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;co2pres&#39;</span><span class="p">)</span>
	<span class="n">co2pres</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2pres</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2preslist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;co2pres&#39;</span><span class="p">]</span>
	<span class="n">co2preslist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2preslist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2diff</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;co2diff&#39;</span><span class="p">)</span>
	<span class="n">co2diff</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2diff</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_co2difflist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;co2diff&#39;</span><span class="p">]</span>
	<span class="n">co2difflist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_co2difflist</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_stressboun</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;stressboun&#39;</span><span class="p">)</span>
	<span class="n">stressboun</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_stressboun</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_stressbounlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;stressboun&#39;</span><span class="p">]</span>
	<span class="n">stressbounlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_stressbounlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_permmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model</span><span class="p">(</span><span class="s1">&#39;permmodel&#39;</span><span class="p">)</span>
	<span class="n">permmodel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_permmodel</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_permmodellist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;permmodel&#39;</span><span class="p">]</span>
	<span class="n">permmodellist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_permmodellist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_plasticmodel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model</span><span class="p">(</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">)</span>
	<span class="n">plasticmodel</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_plasticmodel</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_plasticmodellist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;plasticmodel&#39;</span><span class="p">]</span>
	<span class="n">plasticmodellist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_plasticmodellist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_tpor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_macro</span><span class="p">(</span><span class="s1">&#39;tpor&#39;</span><span class="p">)</span>
	<span class="n">tpor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tpor</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_tporlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allMacro</span><span class="p">[</span><span class="s1">&#39;tpor&#39;</span><span class="p">]</span>
	<span class="n">tporlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tporlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_rlp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model</span><span class="p">(</span><span class="s1">&#39;rlp&#39;</span><span class="p">)</span>
	<span class="n">rlp</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rlp</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_rlplist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;rlp&#39;</span><span class="p">]</span>
	<span class="n">rlplist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rlplist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_vcon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model</span><span class="p">(</span><span class="s1">&#39;vcon&#39;</span><span class="p">)</span>
	<span class="n">vcon</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_vcon</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_vconlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;vcon&#39;</span><span class="p">]</span>
	<span class="n">vconlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_vconlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_ppor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model</span><span class="p">(</span><span class="s1">&#39;ppor&#39;</span><span class="p">)</span>
	<span class="n">ppor</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ppor</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_pporlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_allModel</span><span class="p">[</span><span class="s1">&#39;ppor&#39;</span><span class="p">]</span>
	<span class="n">pporlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_pporlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get__zone_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">z</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]</span>
	<span class="n">_zone_indices</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get__zone_indices</span><span class="p">)</span>	
	<span class="k">def</span> <span class="nf">_get_flxo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">node_pair</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flxo</span><span class="p">):</span>
			<span class="n">nd1</span><span class="p">,</span><span class="n">nd2</span> <span class="o">=</span> <span class="n">node_pair</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd1</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nd1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd1</span><span class="p">]</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd2</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span> <span class="n">nd2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">nd2</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flxo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nd1</span><span class="p">,</span><span class="n">nd2</span><span class="p">)</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flxo</span>
	<span class="k">def</span> <span class="nf">_set_flxo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flxo</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">flxo</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_flxo</span><span class="p">,</span> <span class="n">_set_flxo</span><span class="p">)</span> <span class="c1">#: (*lst*) List containing two-item tuples of nodal pairs for which mass flow flux to be output.</span>
	<span class="k">def</span> <span class="nf">_get_zonelist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_zonelist</span>
	<span class="n">zonelist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zonelist</span><span class="p">)</span><span class="c1">#: (*lst[fzone]*) List of zone objects in the model.</span>
	<span class="k">def</span> <span class="nf">_get_zone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="nb">dict</span><span class="p">([[</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">zn</span><span class="p">]</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span><span class="p">]</span><span class="o">+</span><span class="p">[[</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">zn</span><span class="p">]</span> <span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zonelist</span> <span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
	<span class="n">zone</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_zone</span><span class="p">)</span><span class="c1">#: (*dict[fzone]*) Dictionary of zone objects, indexed by zone number or name.</span>
	<span class="k">def</span> <span class="nf">_get_bounlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bounlist</span>
	<span class="n">bounlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_bounlist</span><span class="p">)</span><span class="c1">#: (*lst[fzone]*) List of boundary condition objects in the model.</span>
	<span class="k">def</span> <span class="nf">_get_rlpmlist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span>
	<span class="n">rlpmlist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rlpmlist</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_rlpm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">rlpm</span><span class="o">.</span><span class="n">group</span><span class="p">,</span><span class="n">rlpm</span><span class="p">)</span> <span class="k">for</span> <span class="n">rlpm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rlpmlist</span><span class="p">])</span>
	<span class="n">rlpm</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_rlpm</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">_get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_filename</span><span class="p">)</span><span class="c1">#: (*str*) File name for reading and writing FEHM input text file.</span>
	<span class="k">def</span> <span class="nf">_get_gridfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">filename</span>
	<span class="c1">#def _set_gridfilename(self,value): self._gridfilename = value</span>
	<span class="n">gridfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_gridfilename</span><span class="p">)</span> <span class="c1">#: (*str*) File name of FEHM grid file.</span>
	<span class="k">def</span> <span class="nf">_get_inconfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inconfilename</span>
	<span class="k">def</span> <span class="nf">_set_inconfilename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inconfilename</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">inconfilename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_inconfilename</span><span class="p">,</span> <span class="n">_set_inconfilename</span><span class="p">)</span> <span class="c1">#: (*str*) File name of FEHM restart file.</span>
	<span class="k">def</span> <span class="nf">_get_verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span>
	<span class="k">def</span> <span class="nf">_set_verbose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">bool</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span> <span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Boolean values only&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">);</span> <span class="k">return</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="nb">int</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">True</span>
			<span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">value</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_verbose</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">verbose</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_verbose</span><span class="p">,</span><span class="n">_set_verbose</span><span class="p">)</span><span class="c1">#: (*bool*) Boolean signalling if simulation output to be printed to screen.</span>
	<span class="k">def</span> <span class="nf">_get_sticky_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticky_zones</span>
	<span class="k">def</span> <span class="nf">_set_sticky_zones</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sticky_zones</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">sticky_zones</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_sticky_zones</span><span class="p">,</span> <span class="n">_set_sticky_zones</span><span class="p">)</span> <span class="c1">#: (*bool*) If ``True`` zone definitions will be written to the input file immediately before they are used inside a macro.</span>
	<span class="k">def</span> <span class="nf">_get_nfinv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfinv</span>
	<span class="k">def</span> <span class="nf">_set_nfinv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nfinv</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">nfinv</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nfinv</span><span class="p">,</span> <span class="n">_set_nfinv</span><span class="p">)</span> <span class="c1">#: (*int*) Boolean integer calling for generation of finite element coefficients (not recommended, see macro **NFINV**).</span>
	<span class="k">def</span> <span class="nf">_get_nobr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nobr</span>
	<span class="k">def</span> <span class="nf">_set_nobr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nobr</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">nobr</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nobr</span><span class="p">,</span> <span class="n">_set_nobr</span><span class="p">)</span> <span class="c1">#: (*int*) Boolean integer calling for no breaking of connections between boundary condition nodes.</span>
	<span class="k">def</span> <span class="nf">_get_head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head</span>
	<span class="k">def</span> <span class="nf">_set_head</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_head</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">head</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_head</span><span class="p">,</span> <span class="n">_set_head</span><span class="p">)</span> <span class="c1">#: (*int*,*fl64*) Boolean integer calling for head inputs (instead of pressure) in FEHM. If assigned a float, then all input heads will be incremented by this amount.</span>
	<span class="k">def</span> <span class="nf">_get_air</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span>
	<span class="k">def</span> <span class="nf">_set_air</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_air</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">air</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_air</span><span class="p">,</span> <span class="n">_set_air</span><span class="p">)</span> <span class="c1">#: (*lst*) Three item list assigning (1) integer specifying type of airwater model, (2) reference temperature, (3) reference pressure.</span>
	<span class="k">def</span> <span class="nf">_get_general_macrolist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_general_macrolist</span>
	<span class="n">general_macrolist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_general_macrolist</span><span class="p">)</span> <span class="c1">#: (*lst*) List of general macros. A general macro is one that has no explicit PyFEHM definition but is recognized by FEHM. General macros are written to the input file verbatim.</span>
	<span class="k">def</span> <span class="nf">_get_flxn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flxn</span>
	<span class="k">def</span> <span class="nf">_set_flxn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flxn</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">flxn</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_flxn</span><span class="p">,</span> <span class="n">_set_flxn</span><span class="p">)</span> <span class="c1">#: (*int*,*fl64*) Boolean integer calling for non-zero source/sink fluxes to be output to file source_sink.flux</span>
	<span class="k">def</span> <span class="nf">_get_vapl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vapl</span>
	<span class="k">def</span> <span class="nf">_set_vapl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vapl</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">vapl</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_vapl</span><span class="p">,</span> <span class="n">_set_vapl</span><span class="p">)</span> <span class="c1">#: (*int*) Boolean integer calling for vapor pressure lowering.</span>
	<span class="k">def</span> <span class="nf">_get_adif</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adif</span>
	<span class="k">def</span> <span class="nf">_set_adif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_adif</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">adif</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_adif</span><span class="p">,</span> <span class="n">_set_adif</span><span class="p">)</span> <span class="c1">#: (*int*) Air-water diffusion coefficient, used in conjuction with macro **TRAC**.</span>
	<span class="k">def</span> <span class="nf">_get_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter</span>
	<span class="nb">iter</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_iter</span><span class="p">)</span> <span class="c1">#: (*dict[fl64,int]*) Iteration parameters (see macro **ITER**).</span>
	<span class="k">def</span> <span class="nf">_get_ctrl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ctrl</span>
	<span class="n">ctrl</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ctrl</span><span class="p">)</span> <span class="c1">#: (*dict[fl64,int]*) Control parameters (see macro **CTRL**).</span>
	<span class="k">def</span> <span class="nf">_get_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>
	<span class="n">time</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time</span><span class="p">)</span> <span class="c1">#: (*dict[fl64,int]*) Time stepping parameters (see macro **TIME**).</span>
	<span class="k">def</span> <span class="nf">_get_sol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sol</span>
	<span class="n">sol</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_sol</span><span class="p">)</span> <span class="c1">#: (*dict[fl64,int]*) Solution parameters (see macro **SOL**).</span>
	<span class="k">def</span> <span class="nf">_get_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span>
	<span class="n">files</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_files</span><span class="p">)</span> <span class="c1">#: (*files*) Simulation execution object.</span>
	<span class="k">def</span> <span class="nf">_get_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid</span>
	<span class="n">grid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_grid</span><span class="p">)</span> <span class="c1">#: (*fgrid*) Grid object associated with the model.</span>
	<span class="k">def</span> <span class="nf">_get_cont</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cont</span>
	<span class="n">cont</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_cont</span><span class="p">)</span> <span class="c1">#: (*fcont*) Contour output for the model.</span>
	<span class="k">def</span> <span class="nf">_get_strs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strs</span>
	<span class="n">strs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_strs</span><span class="p">)</span> <span class="c1">#: (*fstrs*) Stress module object.</span>
	<span class="k">def</span> <span class="nf">_get_ngas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ngas</span>
	<span class="n">ngas</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ngas</span><span class="p">)</span> <span class="c1">#: (*fngas*) Noncondensible gas module.</span>
	<span class="k">def</span> <span class="nf">_get_carb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_carb</span>
	<span class="n">carb</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_carb</span><span class="p">)</span> <span class="c1">#: (*fcarb*) CO2 module object.</span>
	<span class="k">def</span> <span class="nf">_get_trac</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trac</span>
	<span class="n">trac</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_trac</span><span class="p">)</span> <span class="c1">#: (*ftrac*) Species transport module object.</span>
	<span class="k">def</span> <span class="nf">_get_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hist</span>
	<span class="n">hist</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hist</span><span class="p">)</span> <span class="c1">#: (*fhist*) History output for the model.</span>
	<span class="k">def</span> <span class="nf">_get_incon</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_incon</span>
	<span class="n">incon</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_incon</span><span class="p">)</span> <span class="c1">#: (*fincon*) Initial conditions (restart file) associated with the model.</span>
	<span class="k">def</span> <span class="nf">_get_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span>
	<span class="k">def</span> <span class="nf">_set_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">storage</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_storage</span><span class="p">,</span> <span class="n">_set_storage</span><span class="p">)</span> <span class="c1">#: (*fstorage*) Storage object. No restrictions on creating, setting attributes. Created attributes will not be used by PyFEHM.</span>
	<span class="k">def</span> <span class="nf">_get_work_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">absolute_to_workdir</span><span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">absolute_to_workdir</span>
		<span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>
	<span class="k">def</span> <span class="nf">_set_work_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">incon</span><span class="o">.</span><span class="n">_path</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">work_dir</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>
	<span class="n">work_dir</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_work_dir</span><span class="p">,</span> <span class="n">_set_work_dir</span><span class="p">)</span> <span class="c1">#: (*str*) Directory in which to store files and run simulation.</span>
	<span class="k">def</span> <span class="nf">_get_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span>
	<span class="k">def</span> <span class="nf">_set_tf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_tf</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_time_TIMS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Maximum simulation time set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; days.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">tf</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_tf</span><span class="p">,</span> <span class="n">_set_tf</span><span class="p">)</span> <span class="c1">#: (*fl64*) Final simulation time (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_ti</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ti</span>
	<span class="k">def</span> <span class="nf">_set_ti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_ti</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_day_INITTIME&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_year_YEAR&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_month_MONTH&#39;</span><span class="p">]</span><span class="o">=</span><span class="mf">0.</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Initial simulation time set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span> <span class="s1">&#39;days.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">ti</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ti</span><span class="p">,</span> <span class="n">_set_ti</span><span class="p">)</span> <span class="c1">#: (*fl64*) Initial simulation time (shortcut), defaults to zero.</span>
	<span class="k">def</span> <span class="nf">_get_dti</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dti</span>
	<span class="k">def</span> <span class="nf">_set_dti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_dti</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;initial_timestep_DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Initial time step size set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; days.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">dti</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dti</span><span class="p">,</span> <span class="n">_set_dti</span><span class="p">)</span> <span class="c1">#: (*fl64*) Initial time step size (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_dtmin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtmin</span>
	<span class="k">def</span> <span class="nf">_set_dtmin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtmin</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;min_timestep_DAYMIN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Minimum time step size set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; days.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">dtmin</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dtmin</span><span class="p">,</span> <span class="n">_set_dtmin</span><span class="p">)</span> <span class="c1">#: (*fl64*) Minimum time step size (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_dtmax</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtmax</span>
	<span class="k">def</span> <span class="nf">_set_dtmax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtmax</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;max_timestep_DAYMAX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Maximum time step size set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; days.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">dtmax</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dtmax</span><span class="p">,</span> <span class="n">_set_dtmax</span><span class="p">)</span> <span class="c1">#: (*fl64*) Maximum time step size (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_dtn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtn</span>
	<span class="k">def</span> <span class="nf">_set_dtn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtn</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="s1">&#39;max_timestep_NSTEP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Maximum time step number set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">dtn</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dtn</span><span class="p">,</span> <span class="n">_set_dtn</span><span class="p">)</span> <span class="c1">#: (*int*) Maximum number of time steps (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_dtx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dtx</span>
	<span class="k">def</span> <span class="nf">_set_dtx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_dtx</span> <span class="o">=</span> <span class="n">value</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;timestep_multiplier_AIAA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
		<span class="n">pyfehm_print</span><span class="p">(</span><span class="s1">&#39;Time step multiplier set to &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_silent</span><span class="p">)</span>
	<span class="n">dtx</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_dtx</span><span class="p">,</span> <span class="n">_set_dtx</span><span class="p">)</span> <span class="c1">#: (*fl64*) Time step multiplier, acceleration (shortcut).</span>
	<span class="k">def</span> <span class="nf">_get_help</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help</span>
	<span class="k">def</span> <span class="nf">_set_help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_help</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">help</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_help</span><span class="p">,</span> <span class="n">_set_help</span><span class="p">)</span> <span class="c1">#: (*fhelp*) Module for interactive assistance.</span>
	<span class="k">def</span> <span class="nf">_get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span>
	<span class="k">def</span> <span class="nf">_set_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">times</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_times</span><span class="p">,</span> <span class="n">_set_times</span><span class="p">)</span> <span class="c1">#: array of additional timestepping information</span>
	<span class="k">def</span> <span class="nf">_get_output_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span>
	<span class="k">def</span> <span class="nf">_set_output_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> 
		<span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">,(</span><span class="nb">int</span><span class="p">,</span><span class="nb">float</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">]</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">,(</span><span class="nb">list</span><span class="p">,</span><span class="nb">tuple</span><span class="p">)):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">change_timestepping</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span> <span class="o">=</span> <span class="n">value</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_times</span><span class="p">)</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">tf</span><span class="p">:</span>
			<span class="n">_buildWarnings</span><span class="p">(</span><span class="s1">&#39;WARNING: output requested for times after the simulation end time.&#39;</span><span class="p">)</span>
	<span class="n">output_times</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_output_times</span><span class="p">,</span> <span class="n">_set_output_times</span><span class="p">)</span> <span class="c1">#: (*lst*) List of times at which FEHM should produce output.</span></div>

<span class="k">class</span> <span class="nc">fdiagdata</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Class for diagnostic data object.&quot;&quot;&quot;</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">lim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.e-9</span><span class="p">,</span><span class="mf">1.e-9</span><span class="p">],</span><span class="n">label_color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;ko-&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="n">lim</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">label_color</span> <span class="o">=</span> <span class="n">label_color</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">linestyle</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">markersize</span> <span class="o">=</span> <span class="n">markersize</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">defaulting</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">defaulting</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Some defaults to assign&quot;&quot;&quot;</span>
		<span class="c1"># if its a node, default coloring, units</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="p">):</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;pressure&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;P / MPa&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label_color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;bs-&#39;</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;temperature&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;T / degC&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label_color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;r^-&#39;</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;flow&#39;</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;source / kg/s&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">label_color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;ko-&#39;</span>
	<span class="k">def</span> <span class="nf">_get_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="n">time</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_time</span><span class="p">)</span> 
<span class="k">class</span> <span class="nc">fdiagax</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">slot1</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_plot0</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_plot1</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bg0</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bg1</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot2</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot3</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">def</span> <span class="nf">add_empty_plots</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">fdd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
				<span class="n">ls</span> <span class="o">=</span> <span class="n">fdd</span><span class="o">.</span><span class="n">linestyle</span>
				<span class="n">ms</span> <span class="o">=</span> <span class="n">fdd</span><span class="o">.</span><span class="n">markersize</span>
			<span class="k">except</span><span class="p">:</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;ko-&#39;</span><span class="p">;</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">3</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_plot0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="n">ls</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
			<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">:</span>
				<span class="n">tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span>
				<span class="n">tol2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">tol2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tol2</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">,[</span><span class="n">tol</span><span class="p">,</span><span class="n">tol</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;r*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;k*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="n">fdd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span>
				<span class="n">ls</span> <span class="o">=</span> <span class="n">fdd</span><span class="o">.</span><span class="n">linestyle</span>
				<span class="n">ms</span> <span class="o">=</span> <span class="n">fdd</span><span class="o">.</span><span class="n">markersize</span>
			<span class="k">except</span><span class="p">:</span> <span class="n">ls</span> <span class="o">=</span> <span class="s1">&#39;ko-&#39;</span><span class="p">;</span> <span class="n">ms</span> <span class="o">=</span> <span class="mi">3</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_plot1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="n">ls</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="n">ms</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
			
			<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">:</span>
				<span class="n">tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span>
				<span class="n">tol2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">tol2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tol2</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">,[</span><span class="n">tol</span><span class="p">,</span><span class="n">tol</span><span class="p">],</span><span class="s1">&#39;k:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;b*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;r*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">([],[],</span><span class="s1">&#39;k*&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">def</span> <span class="nf">reset_bg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># remove any plots</span>
		<span class="k">for</span> <span class="n">plt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot0</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot1</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],[])</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
		
		<span class="n">replotResidual</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="o">.</span><span class="n">set_data</span><span class="p">([],[])</span>
			<span class="n">replotResidual</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="c1"># save bbox</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bg0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">copy_from_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">bg1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">copy_from_bbox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
		
		<span class="c1"># re add data</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">plot0</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">),</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">[</span><span class="n">slot</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">),</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
			
		<span class="k">if</span> <span class="n">replotResidual</span><span class="p">:</span>
			<span class="n">tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span>
			<span class="n">tol2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">tol2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tol2</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">,[</span><span class="n">tol</span><span class="p">,</span><span class="n">tol</span><span class="p">])</span>
	<span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">restore_region</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg0</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">restore_region</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bg1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">plt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">plt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>	
		<span class="c1"># show residuals</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span><span class="p">:</span>
			<span class="n">k</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">break</span>
			<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">break</span>
			<span class="k">if</span> <span class="n">k</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">ax</span><span class="p">:</span> 
					<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot2</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot3</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot1</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot2</span><span class="p">)</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">draw_artist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR_plot3</span><span class="p">)</span>
				
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">legend</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">redraw_legend</span><span class="p">()</span>	
		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">blit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">make_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>	
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span> <span class="o">==</span> <span class="p">[]:</span> <span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">legend</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="n">entries</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">([</span><span class="n">slot</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">],[</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="s1">&#39;k-.&#39;</span><span class="p">,</span><span class="s1">&#39;k:&#39;</span><span class="p">])</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">lp</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="o">.</span><span class="mi">02</span><span class="p">,</span><span class="o">.</span><span class="mi">04</span><span class="p">,</span><span class="o">.</span><span class="mi">02</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">))</span>
				
		<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()),</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">legend_bg</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="n">x</span><span class="o">+.</span><span class="mi">01</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="o">+.</span><span class="mi">01</span><span class="o">*</span><span class="n">dy</span><span class="p">),</span> <span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_bg</span><span class="p">)</span>
		
		<span class="n">text_size</span> <span class="o">=</span> <span class="s1">&#39;x-small&#39;</span>
		<span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">dy</span>
		<span class="n">ln_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">txt_gap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
		<span class="n">dyi</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">dy</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">legend_plts</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">legend_txts</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">legend_plts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x1</span><span class="o">+</span><span class="n">ln_len</span><span class="o">*</span><span class="n">dx</span><span class="p">],[</span><span class="n">y1</span><span class="p">,</span><span class="n">y1</span><span class="p">],</span><span class="n">entry</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">zorder</span><span class="o">=</span><span class="mi">300</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">legend_txts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="p">(</span><span class="n">ln_len</span><span class="o">+</span><span class="n">txt_gap</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">text_size</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">300</span><span class="p">))</span>
			<span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dyi</span>
	<span class="k">def</span> <span class="nf">redraw_legend</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">dx</span><span class="p">,</span><span class="n">dy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()),</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">legend_bg</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">x</span><span class="o">+.</span><span class="mi">01</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="o">+.</span><span class="mi">01</span><span class="o">*</span><span class="n">dy</span><span class="p">,</span><span class="n">dx</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dy</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		
		<span class="n">x1</span><span class="p">,</span><span class="n">y1</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">dy</span>
		<span class="n">ln_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
		<span class="n">txt_gap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
		<span class="n">dyi</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">lp</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span><span class="n">dy</span>
		
		<span class="k">for</span> <span class="n">plt</span><span class="p">,</span><span class="n">txt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_plts</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">legend_txts</span><span class="p">):</span>
			<span class="n">plt</span><span class="o">.</span><span class="n">set_data</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">x1</span><span class="o">+</span><span class="n">ln_len</span><span class="o">*</span><span class="n">dx</span><span class="p">],[</span><span class="n">y1</span><span class="p">,</span><span class="n">y1</span><span class="p">])</span>
			<span class="n">txt</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="n">x1</span><span class="o">+</span><span class="p">(</span><span class="n">ln_len</span><span class="o">+</span><span class="n">txt_gap</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span><span class="p">,</span><span class="n">y1</span><span class="p">))</span>
			<span class="n">y1</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dyi</span>	
	<span class="k">def</span> <span class="nf">_get_lim0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">lim0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lim</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
			<span class="n">lim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span>
			<span class="n">lim0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">lim0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
			<span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
			<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">:</span>
					<span class="n">tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span>
					<span class="n">tol2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span>
					<span class="k">if</span> <span class="n">tol2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tol2</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">tol</span><span class="o">&gt;</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> 
						<span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tol</span><span class="o">*</span><span class="mf">10.</span>
				<span class="n">NRdat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_data</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NRdat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>	
					<span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">NRdat</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">lim0</span>
	<span class="n">ylim0</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_lim0</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_lim1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">lim1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">lim</span>
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
			<span class="n">lim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span>
			<span class="n">lim1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="n">lim1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lim</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
			<span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
			<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual_plot</span><span class="p">:</span>
					<span class="n">tol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">ctrl</span><span class="p">[</span><span class="s1">&#39;newton_cycle_tolerance_EPM&#39;</span><span class="p">]</span>
					<span class="n">tol2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">iter</span><span class="p">[</span><span class="s1">&#39;machine_tolerance_TMCH&#39;</span><span class="p">]</span>
					<span class="k">if</span> <span class="n">tol2</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span> <span class="n">tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tol2</span><span class="p">)</span>
					<span class="k">if</span> <span class="n">tol</span><span class="o">&gt;</span><span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> 
						<span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">tol</span><span class="o">*</span><span class="mf">10.</span>
				<span class="n">NRdat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_data</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NRdat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>	
					<span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">lim1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">NRdat</span><span class="p">)</span><span class="o">*</span><span class="mi">10</span><span class="p">])</span>
		<span class="k">return</span> <span class="n">lim1</span>
	<span class="n">ylim1</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_lim1</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_logflag0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
		<span class="k">return</span> <span class="kc">False</span>
	<span class="n">logflag0</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_logflag0</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_logflag1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
		<span class="k">return</span> <span class="kc">False</span>
	<span class="n">logflag1</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_logflag1</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_ylabel0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">label</span>
		<span class="k">return</span> <span class="s1">&#39;&#39;</span>
	<span class="n">ylabel0</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ylabel0</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_ylabel1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">label</span>
		<span class="k">return</span> <span class="s1">&#39;&#39;</span>
	<span class="n">ylabel1</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_ylabel1</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_plot0</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slot0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot0</span><span class="p">))</span>
	<span class="n">plot0</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_plot0</span><span class="p">)</span> 
	<span class="k">def</span> <span class="nf">_get_plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slot1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_plot1</span><span class="p">))</span>
	<span class="n">plot1</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_plot1</span><span class="p">)</span> 
<span class="k">class</span> <span class="nc">fdiagNR</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R1_data</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R1_node</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R2_data</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R2_node</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R3_data</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">R3_node</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">R_time</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">def</span> <span class="nf">new_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">node</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span> <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="n">node</span><span class="p">]</span>
		<span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
		<span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R1_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R1_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>		
			<span class="bp">self</span><span class="o">.</span><span class="n">R_time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R2_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R2_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>			
		<span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R3_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">R3_node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>			
		<span class="k">else</span><span class="p">:</span>
			<span class="nb">print</span> <span class="s1">&#39;Invalid type&#39;</span>
	<span class="k">def</span> <span class="nf">redraw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="c1"># search for plot of residuals, if found, plot as stars</span>
		<span class="n">k</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span> <span class="n">ax</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="k">break</span>
			<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">slot</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;residual&#39;</span><span class="p">):</span> <span class="n">ax</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="k">break</span>
		<span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">nr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
		<span class="n">nr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span>
		<span class="n">nr3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_time</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R_type</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">3</span><span class="p">])</span>
		
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nr1</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">largest_NR_plot1</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">nr1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nr1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nr2</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">largest_NR_plot2</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">nr2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nr2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nr3</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">largest_NR_plot3</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">nr3</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">nr3</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">retext</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
		
		<span class="c1">#cnts = bincount</span>
		<span class="c1">#cnts = heapq.nlargest(2,np.unique())</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">R_node</span><span class="p">]))</span>
		<span class="n">cnts</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">nd_max</span> <span class="o">=</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_node</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">nd_max</span><span class="p">:</span> <span class="k">break</span>
				
		<span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>		
		<span class="n">txt2</span> <span class="o">=</span> <span class="s1">&#39;(1) &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; appearance&#39;</span>
		<span class="k">if</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;s&#39;</span>
		<span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="n">txt</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">+</span><span class="n">txt</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnts</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">nd_max</span> <span class="o">=</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_node</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">nd_max</span><span class="p">:</span> <span class="k">break</span>
					
			<span class="n">txt1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>		
			<span class="n">txt2</span> <span class="o">=</span> <span class="s1">&#39;(2) &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; appearance&#39;</span>
			<span class="k">if</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;s&#39;</span>
			<span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>				
		
			<span class="n">txt</span> <span class="o">+=</span> <span class="n">txt2</span><span class="o">+</span><span class="n">txt1</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
		
		<span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">texts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">text_R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">more</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
		<span class="n">nd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R_node</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="n">txt</span> <span class="o">=</span>  <span class="s1">&#39;EQ&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R_type</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;R = </span><span class="si">%3.2E</span><span class="s1">, &#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">R_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;nd = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;x = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;y = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;z = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;In zones: &#39;</span>
			<span class="n">zns</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">zonelist</span><span class="p">)</span>
			<span class="n">zns</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">zn</span> <span class="ow">in</span> <span class="n">zns</span><span class="p">:</span>
				<span class="n">txt</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">zn</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">zn</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
				<span class="n">txt</span><span class="o">+=</span> <span class="s1">&#39;, &#39;</span>
			<span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;Unzoned&#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>		
		
		<span class="k">if</span> <span class="n">more</span><span class="p">:</span>
			<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;Connected nodes: &#39;</span>
			<span class="k">for</span> <span class="n">ndi</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">connected_nodes</span><span class="p">:</span> <span class="n">txt</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ndi</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
			<span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
			
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">permeability</span><span class="p">,(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">)):</span>
			<span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">nd</span><span class="o">.</span><span class="n">permeability</span><span class="p">,</span><span class="n">nd</span><span class="o">.</span><span class="n">permeability</span><span class="p">,</span><span class="n">nd</span><span class="o">.</span><span class="n">permeability</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">permeability</span>
		<span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
			<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;k = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;k = [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;, &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;], &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>	
		
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;Pi = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">Pi</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, Ti = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="o">.</span><span class="n">Ti</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="n">txt</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>			
		<span class="k">return</span> <span class="n">txt</span>
	<span class="k">def</span> <span class="nf">_get_R_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r3</span><span class="p">])</span> <span class="k">for</span> <span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R2_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R3_data</span><span class="p">)]</span>
	<span class="n">R_data</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_R_data</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_R_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">nd</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">r1</span><span class="p">,</span><span class="n">n1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">r3</span><span class="p">,</span><span class="n">n3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R1_node</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R2_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R2_node</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R3_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R3_node</span><span class="p">):</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="o">&gt;</span><span class="n">r2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r1</span><span class="o">&gt;</span><span class="n">r3</span><span class="p">):</span>	<span class="n">nd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n1</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">r2</span><span class="o">&gt;</span><span class="n">r3</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">nd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>				
		<span class="k">return</span> <span class="n">nd</span>
	<span class="n">R_node</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_R_node</span><span class="p">)</span> <span class="c1">#: (**)</span>
	<span class="k">def</span> <span class="nf">_get_R_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">tp</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">r3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R1_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R2_data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">R3_data</span><span class="p">):</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">r1</span><span class="o">&gt;</span><span class="n">r2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">r1</span><span class="o">&gt;</span><span class="n">r3</span><span class="p">):</span>	<span class="n">tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">r2</span><span class="o">&gt;</span><span class="n">r3</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span> <span class="n">tp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>				
		<span class="k">return</span> <span class="n">tp</span>
	<span class="n">R_type</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_R_type</span><span class="p">)</span> <span class="c1">#: (**)</span>
<span class="k">class</span> <span class="nc">fdiagnostic</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Class for FEHM real-time diagnosis </span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>		
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1"># write out information collected by diagnostic tool</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span> <span class="o">=</span> <span class="kc">None</span> 		<span class="c1"># write out information collected by diagnostic tool</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span> <span class="o">=</span> <span class="kc">None</span> 		<span class="c1"># write out information collected by diagnostic tool</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nds</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">nd_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">hide</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">silent</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">_job</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;time / days&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">timestep</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;time step / days&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;total_mass&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Net water discharge / kg&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">total_energy</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;total_energy&#39;</span><span class="p">,</span>
			<span class="n">label</span><span class="o">=</span><span class="s1">&#39;Net energy discharge / MJ&#39;</span><span class="p">,</span><span class="n">label_color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;rs-&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual1</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;residuals (log10)&#39;</span><span class="p">,</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.e-30</span><span class="p">,</span><span class="mf">1.e-29</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;b^-&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual2</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;residual2&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;residuals (log10)&#39;</span><span class="p">,</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.e-30</span><span class="p">,</span><span class="mf">1.e-29</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;rs-&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual3</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;residual3&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;residuals (log10)&#39;</span><span class="p">,</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.e-30</span><span class="p">,</span><span class="mf">1.e-29</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;ko-&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span> <span class="o">=</span> <span class="n">fdiagNR</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_input_rate</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mass_input_rate&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mass input rate / kg s$^{-1}$&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_output_rate</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mass_output_rate&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mass discharge rate / kg s$^{-1}$&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">enthalpy_input_rate</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;enthalpy_input_rate&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;enthalpy input rate / MJ s$^{-1}$&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">enthalpy_output_rate</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;enthalpy_output_rate&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;enthalpy output rate / MJ s$^{-1}$&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_error</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;mass_error&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mass conservation error&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">energy_error</span> <span class="o">=</span> <span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;energy_error&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;energy conservation error&#39;</span><span class="p">)</span>
						
		<span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span> <span class="o">=</span> <span class="mf">20.</span>		<span class="c1"># maintain frame at 20x current size</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax0</span> <span class="o">=</span> <span class="n">fdiagax</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fdiagax</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fdiagax</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span> <span class="o">=</span> <span class="n">fdiagax</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;timestep&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="o">.</span><span class="n">slot1</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;total_mass&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">slot1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;total_energy&#39;</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="s1">&#39;residual2&#39;</span><span class="p">]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">slot1</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span> <span class="o">=</span> <span class="p">[]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;gas&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;tracer1&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">),(</span><span class="s1">&#39;tracer2&#39;</span><span class="p">,</span><span class="kc">None</span><span class="p">)])</span>
	<span class="k">def</span> <span class="nf">refresh_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">ndN</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">)</span>
		<span class="n">varN</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_nd</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="n">ndN</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">varN</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_nd</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="n">ndN</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="k">if</span> <span class="n">varN</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
		<span class="k">if</span> <span class="n">ndN</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;--&#39;</span>
			<span class="k">if</span> <span class="n">varN</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
				<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;--&#39;</span>
		<span class="k">if</span> <span class="n">ndN</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-.&#39;</span>
			<span class="k">if</span> <span class="n">varN</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
				<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-.&#39;</span>
		<span class="k">if</span> <span class="n">ndN</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
			<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;:&#39;</span>
			<span class="k">if</span> <span class="n">varN</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">nodelist</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">fdiagdata</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="p">[],</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">hist</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
				<span class="n">ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">slot1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">linestyle</span> <span class="o">=</span> <span class="n">ls</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;:&#39;</span>
	<span class="k">def</span> <span class="nf">split_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">line</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Splits a line from command output stream, returns list of string or floats.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="n">ln2</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">lni</span> <span class="ow">in</span> <span class="n">ln</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span> <span class="n">ln2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">lni</span><span class="p">))</span>
			<span class="k">except</span><span class="p">:</span> <span class="n">ln2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lni</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
		
		<span class="k">return</span> <span class="n">ln2</span>
	<span class="k">def</span> <span class="nf">printout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">silent</span><span class="p">:</span> <span class="nb">print</span> <span class="n">ln</span>
	<span class="k">def</span> <span class="nf">parse_line</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> <span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ln</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_timestep</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mass</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_energy</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mass_input</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_mass_output</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_enthalpy_input</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_enthalpy_output</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="c1">#elif self.update_node(ln): pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_node2</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_errors</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>			
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_residuals</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>			
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_largestNR</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>			
			<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_files</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">pass</span>		
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_line</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">construct_viewer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Assembles axes on the screen.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="c1"># set residual slots</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">carb</span><span class="o">.</span><span class="n">iprtype</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="s1">&#39;residual2&#39;</span><span class="p">,</span><span class="s1">&#39;residual3&#39;</span><span class="p">]</span>
		<span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">strs</span><span class="o">.</span><span class="n">param</span><span class="p">[</span><span class="s1">&#39;ISTRS&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="s1">&#39;residual2&#39;</span><span class="p">,</span><span class="s1">&#39;residual3&#39;</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">slot0</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="s1">&#39;residual2&#39;</span><span class="p">]</span>
		
		<span class="c1"># create figure window</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">wm_title</span><span class="p">(</span><span class="s1">&#39;PyFEHM diagnostic window: &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s1">&#39;WM_DELETE_WINDOW&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">has_ctypes</span><span class="p">:</span>
			<span class="n">user32</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span>
			<span class="n">screensize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">user32</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">user32</span><span class="o">.</span><span class="n">GetSystemMetrics</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="n">screensize</span><span class="o">/</span><span class="mf">120.</span><span class="p">,</span><span class="n">dpi</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
			<span class="c1">#mng = plt.get_current_fig_manager()</span>
			<span class="c1">#mng.window.wm_geometry(&#39;+%04i+%04i&#39;%(screensize[0]/20.,screensize[1]/20.))</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

		<span class="n">x1</span><span class="p">,</span><span class="n">x2</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.55</span>
		<span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.7</span>
		<span class="n">dx</span> <span class="o">=</span> <span class="mf">0.35</span>
		<span class="n">dy</span> <span class="o">=</span> <span class="mf">0.25</span>
		
		<span class="n">text_size</span> <span class="o">=</span> <span class="mi">9</span>
		
		<span class="c1"># create the four twinned axes, generic naming convention</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="o">.</span><span class="n">sub0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">y3</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="o">.</span><span class="n">sub1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">sub0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">sub1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">sub0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">sub1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">sub0</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x2</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">sub1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
		
		<span class="c1"># set up text axes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="o">+</span><span class="p">(</span><span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">texts</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="s1">&#39;Summary of largest N-R corrections&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="s1">&#39;First..............................................................................&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="n">fontstyle</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.63</span><span class="p">,</span><span class="s1">&#39;Most frequent...............................................................&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="n">fontstyle</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.03</span><span class="p">,</span><span class="mf">0.21</span><span class="p">,</span><span class="s1">&#39;Most recent..................................................................&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span><span class="n">fontstyle</span><span class="o">=</span><span class="s1">&#39;italic&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.82</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.6</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">txt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span><span class="mf">0.18</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
		
		<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">dti</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tf</span><span class="p">])</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="n">t1</span><span class="p">]</span>
		
		<span class="c1"># initialise all axes limits/labels		</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
			<span class="n">ax0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub0</span>
			<span class="n">ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub1</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">)</span>
			<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">)</span>
			<span class="n">ax0</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">label</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="n">text_size</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax0</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span> <span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">text_size</span><span class="p">)</span>
			
			<span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
				<span class="n">ax0</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
				<span class="n">ax0</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">label_color</span> <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">slot0</span><span class="p">])</span>
				<span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">ylim0</span><span class="p">)</span>
				<span class="n">ax0</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">ylabel0</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="n">text_size</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">logflag0</span><span class="p">:</span> <span class="n">ax0</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
				<span class="n">ax0</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
				
				<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax0</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span> 
					<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">text_size</span><span class="p">)</span>
					<span class="n">t</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
				
			<span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
				<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
				<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">label_color</span> <span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">slot1</span><span class="p">])</span>
				<span class="n">col</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
				
				<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">ylim1</span><span class="p">)</span>
				<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">ylabel1</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="n">text_size</span><span class="p">,</span><span class="n">color</span> <span class="o">=</span> <span class="n">col</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">ax</span><span class="o">.</span><span class="n">logflag1</span><span class="p">:</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
				<span class="n">ax1</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
				
				<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span> 
					<span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">text_size</span><span class="p">)</span>
					<span class="n">t</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
		
			<span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">make_legend</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvasTkAgg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span><span class="n">master</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">_tkcanvas</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">BOTH</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
		
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">add_empty_plots</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reset_bg</span><span class="p">()</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_line</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">read_with_tcl</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_line</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">close_files</span><span class="p">(</span><span class="s1">&#39;timestep less than daymin&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">update_tlim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span> <span class="k">return</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="k">return</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">tf</span><span class="p">])</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">lim</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">update_lim</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Redraw vertical axes if necessary. &quot;&quot;&quot;</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span> <span class="k">return</span>
		<span class="c1"># rescale axes</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">break</span>
			<span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">break</span>
		<span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
		
		<span class="n">lim0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span>
		<span class="n">dat0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
		
		<span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dat0</span><span class="p">)</span><span class="o">&lt;</span><span class="n">lim0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dat0</span><span class="p">)</span><span class="o">&gt;</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="k">return</span> 	<span class="c1"># check if update required</span>
		
		<span class="k">if</span> <span class="n">ax</span><span class="p">:</span> 
			<span class="n">dat0</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span>
				<span class="n">dat0</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="n">dat0</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">slot</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span>
				<span class="n">dat0</span> <span class="o">+=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">slot</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
				
		<span class="c1"># calculate new limit</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
			<span class="n">dmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dat0</span><span class="p">)</span>
			<span class="n">dmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dat0</span><span class="p">)</span>
			<span class="c1">#if ax: dmid = (0.4*dmin+0.6*dmax)/2.</span>
			<span class="c1">#else: dmid = (0.6*dmin+0.4*dmax)/2.</span>
			<span class="n">dmid</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmin</span><span class="o">+</span><span class="n">dmax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">drange</span> <span class="o">=</span> <span class="n">dmax</span><span class="o">-</span><span class="n">dmin</span>
			<span class="k">if</span> <span class="n">dat0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">dmid</span><span class="o">-</span><span class="n">drange</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span><span class="n">dmid</span><span class="o">+</span><span class="n">drange</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="o">/</span><span class="mf">5.</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">dmid</span><span class="o">-</span><span class="n">drange</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="o">/</span><span class="mf">5.</span><span class="p">,</span><span class="n">dmid</span><span class="o">+</span><span class="n">drange</span><span class="o">*</span><span class="mf">1.1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">dmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dat0</span><span class="p">))</span>
			<span class="n">dmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">dat0</span><span class="p">))</span>
			<span class="n">dmid</span> <span class="o">=</span> <span class="p">(</span><span class="n">dmin</span><span class="o">+</span><span class="n">dmax</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
			<span class="n">drange</span> <span class="o">=</span> <span class="n">dmax</span><span class="o">-</span><span class="n">dmin</span>
			<span class="k">if</span> <span class="n">dat0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lim0</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dmid</span><span class="o">-</span><span class="n">drange</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span><span class="n">dmid</span><span class="o">+</span><span class="n">drange</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="o">/</span><span class="mf">5.</span><span class="p">]))</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dmid</span><span class="o">-</span><span class="n">drange</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">rel_frame</span><span class="o">/</span><span class="mf">5.</span><span class="p">,</span><span class="n">dmid</span><span class="o">+</span><span class="n">drange</span><span class="o">*</span><span class="mf">1.1</span><span class="p">]))</span>
			
		<span class="k">if</span> <span class="n">ax</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ylim1</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub1</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">ylim0</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">sub0</span><span class="o">.</span><span class="n">hold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">reset_bg</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">update_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">:</span> <span class="k">return</span>
		<span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
		<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
			<span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot0</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">break</span>
			<span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">slot1</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">break</span>
		<span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="k">return</span>
		
		<span class="k">if</span> <span class="n">ax</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot1</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">),</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
		<span class="k">else</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">plot0</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">time</span><span class="p">),</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">cs1</span> <span class="o">=</span> <span class="s1">&#39;total code time(timesteps)&#39;</span>
		<span class="n">cs2</span> <span class="o">=</span> <span class="s1">&#39;timestep less than daymin&#39;</span>
		<span class="n">returnFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs1</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="n">returnFlag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cs2</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="n">returnFlag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="n">returnFlag</span><span class="p">:</span> <span class="k">return</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">summarise_nr</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">poll</span> <span class="o">=</span> <span class="kc">False</span>
	<span class="k">def</span> <span class="nf">summarise_nr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#############################################################################</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#############################   SUMMARY   ###################################</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#############################################################################</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;FIRST largest N-R correction</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">True</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;MOST FREQUENT largest N-R corrections</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">c</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_node</span><span class="p">]))</span>
		<span class="n">cnts</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">nd_max</span> <span class="o">=</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
		
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_node</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">nd_max</span><span class="p">:</span> <span class="k">break</span>
				
		<span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>		
		<span class="n">txt2</span> <span class="o">=</span> <span class="s1">&#39;(1) &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; appearance&#39;</span>
		<span class="k">if</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;s&#39;</span>
		<span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="n">txt</span> <span class="o">=</span> <span class="n">txt2</span><span class="o">+</span><span class="n">txt</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
		
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cnts</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">nd_max</span> <span class="o">=</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">nd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_node</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">nd</span><span class="o">.</span><span class="n">index</span> <span class="o">==</span> <span class="n">nd_max</span><span class="p">:</span> <span class="k">break</span>
					
			<span class="n">txt1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>		
			<span class="n">txt2</span> <span class="o">=</span> <span class="s1">&#39;(2) &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; appearance&#39;</span>
			<span class="k">if</span> <span class="n">cnts</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span> <span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;s&#39;</span>
			<span class="n">txt2</span> <span class="o">+=</span> <span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>				
		
			<span class="n">txt</span> <span class="o">+=</span> <span class="n">txt2</span><span class="o">+</span><span class="n">txt1</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;MOST RECENT largest N-R correction</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">txt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
		
		<span class="c1"># create a zone for largestNR nodes in case of export to paraview</span>
		<span class="k">if</span> <span class="mi">980</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">zone</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>			
			<span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">new_zone</span><span class="p">(</span><span class="mi">980</span><span class="p">,</span><span class="s1">&#39;largestNR&#39;</span><span class="p">,</span><span class="n">nodelist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R_node</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">write_NR</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="c1"># first time step, open file</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">wd</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;_NR.dgs&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;largest N-R correction, timestep </span><span class="si">%5i</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">text_R</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="kc">True</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
		<span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_nr</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">write_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Writes data for a single time step to file.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;timestep&#39;</span><span class="p">,</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;total_mass&#39;</span><span class="p">,</span><span class="s1">&#39;total_energy&#39;</span><span class="p">,</span><span class="s1">&#39;residual1&#39;</span><span class="p">,</span><span class="s1">&#39;residual2&#39;</span><span class="p">,</span><span class="s1">&#39;residual3&#39;</span><span class="p">,</span><span class="s1">&#39;mass_input_rate&#39;</span><span class="p">,</span>
			<span class="s1">&#39;mass_output_rate&#39;</span><span class="p">,</span><span class="s1">&#39;enthalpy_input_rate&#39;</span><span class="p">,</span><span class="s1">&#39;enthalpy_output_rate&#39;</span><span class="p">,</span><span class="s1">&#39;mass_error&#39;</span><span class="p">,</span><span class="s1">&#39;energy_error&#39;</span><span class="p">]</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">wd</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
			<span class="c1"># first time step, open files</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;_convergence.dgs&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
			<span class="c1"># write headers			</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;index   &#39;</span><span class="p">)</span>
			<span class="n">N</span> <span class="o">=</span> <span class="mi">14</span>
			<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
				<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">&gt;</span><span class="n">N</span><span class="p">:</span> <span class="n">h</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%14s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">h</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>				
				
			<span class="k">return</span>

		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_nd</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="p">:</span> <span class="n">wd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">work_dir</span><span class="o">+</span><span class="n">os</span><span class="o">.</span><span class="n">sep</span>
			<span class="k">else</span><span class="p">:</span> <span class="n">wd</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">wd</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;_node.dgs&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;index   &#39;</span><span class="p">)</span>
			<span class="n">nm</span> <span class="o">=</span> <span class="s1">&#39;time(days)&#39;</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%16s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">nm</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nd_vars</span><span class="p">:</span>
					<span class="n">nm</span> <span class="o">=</span> <span class="s1">&#39;nd_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">nm</span>
					<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">15</span><span class="p">:</span> <span class="n">nm</span> <span class="o">=</span> <span class="n">nm</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%16s</span><span class="s1">&#39;</span><span class="o">%</span><span class="n">nm</span><span class="o">+</span><span class="s1">&#39;  &#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>				
				
		<span class="c1"># write time step</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%5i</span><span class="s1">   &#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
		<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% 8.7e</span><span class="s1">  &#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
			<span class="k">except</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% 8.7e</span><span class="s1">  &#39;</span><span class="o">%</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
		<span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_cv</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%5i</span><span class="s1">   &#39;</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% 10.9e</span><span class="s1">  &#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="p">:</span>
				<span class="k">for</span> <span class="n">nm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nd_vars</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
					<span class="k">except</span><span class="p">:</span> <span class="n">val</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">nm</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% 10.9e</span><span class="s1">  &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
			<span class="n">os</span><span class="o">.</span><span class="n">fsync</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_nd</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">update_timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Update the time step plot.</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Years  Days  Step Size&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_timestep</span><span class="p">()</span>
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		
		<span class="n">yr</span><span class="p">,</span> <span class="n">day</span><span class="p">,</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">ln</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">day</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
			<span class="n">pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt</span><span class="o">-</span><span class="mf">1.e-30</span><span class="p">,</span><span class="n">pt</span><span class="o">+</span><span class="mf">1.e-30</span><span class="p">]</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_tlim</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;timestep&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;timestep&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Net kg water discharge&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_mass</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;total_mass&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;total_mass&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Net MJ energy discharge&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">total_energy</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total_energy</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;total_energy&#39;</span><span class="p">)</span>			
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_mass_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Water input this time step:&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_input_rate</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;mass_input_rate&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;mass_input_rate&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_mass_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Water discharge this time step:&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_output_rate</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;mass_output_rate&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;mass_output_rate&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>		
	<span class="k">def</span> <span class="nf">update_enthalpy_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Enthalpy input this time step:&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">enthalpy_input_rate</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;enthalpy_input_rate&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;enthalpy_input_rate&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_enthalpy_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Enthalpy discharge this time step:&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">enthalpy_output_rate</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">:]))</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;enthalpy_output_rate&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;enthalpy_output_rate&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Nodal Information (Water)&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">write_nd</span> <span class="o">=</span> <span class="kc">True</span>
		
		<span class="n">keepReading</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">updates</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="c1"># get line to process</span>
			<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="p">)</span>
			<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
			<span class="c1"># check if line empty -&gt; break</span>
			<span class="k">if</span> <span class="n">ln</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="k">break</span>
			<span class="c1"># parse line, store information</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
				<span class="n">nd</span><span class="p">,</span><span class="n">ndP</span><span class="p">,</span><span class="n">ndE</span><span class="p">,</span><span class="n">ndL</span><span class="p">,</span><span class="n">ndT</span><span class="p">,</span><span class="n">ndQ</span><span class="p">,</span><span class="n">ndQE</span> <span class="o">=</span> <span class="n">ln</span>
			<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
				<span class="n">nd</span><span class="p">,</span><span class="n">ndP</span><span class="p">,</span><span class="n">ndT</span><span class="p">,</span><span class="n">ndSw</span><span class="p">,</span><span class="n">ndSaq</span><span class="p">,</span><span class="n">ndS</span><span class="p">,</span> <span class="n">ndQ</span><span class="p">,</span><span class="n">ndQE</span> <span class="o">=</span> <span class="n">ln</span>
			<span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span>
			<span class="n">nd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">nd</span><span class="p">))</span>
			<span class="k">for</span> <span class="n">nm</span><span class="p">,</span><span class="n">ndI</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nd_vars</span><span class="p">,[</span><span class="n">ndP</span><span class="p">,</span><span class="n">ndT</span><span class="p">,</span><span class="n">ndQ</span><span class="p">]):</span>
				<span class="n">nm</span> <span class="o">=</span> <span class="s1">&#39;nd&#39;</span><span class="o">+</span><span class="n">nd</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">nm</span>
				<span class="k">try</span><span class="p">:</span> 
					<span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ndI</span><span class="p">)</span>
					<span class="n">updates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span>
				<span class="k">except</span><span class="p">:</span>
					<span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">nm</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ndI</span><span class="p">)</span>
					<span class="k">except</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">nm</span><span class="p">,[</span><span class="n">ndI</span><span class="p">])</span>
		
		<span class="k">for</span> <span class="n">update</span> <span class="ow">in</span> <span class="n">updates</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="n">update</span><span class="p">)</span>
		
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_node2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Nodal Information&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		
		<span class="c1">####### 1. check species type, e.g., water, gas, tracer</span>
		<span class="n">node_type</span> <span class="o">=</span> <span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">node_type</span> <span class="o">==</span> <span class="s1">&#39;(Water)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_node_general</span><span class="p">(</span><span class="s1">&#39;water&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">node_type</span> <span class="o">==</span> <span class="s1">&#39;(Gas)&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_node_general</span><span class="p">(</span><span class="s1">&#39;gas&#39;</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">node_type</span> <span class="o">==</span> <span class="s1">&#39;(Tracer)&#39;</span><span class="p">:</span> 
			<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
			<span class="n">ln</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_node_general</span><span class="p">(</span><span class="s1">&#39;tracer&#39;</span><span class="o">+</span><span class="n">ln</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">update_node_general</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
		<span class="n">lns</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()]</span>
		<span class="k">while</span> <span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;Node&#39;</span><span class="p">:</span> <span class="n">lns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="k">for</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
		<span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;water&#39;</span><span class="p">:</span> 
			<span class="n">keys_read</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P (MPa)&#39;</span><span class="p">,</span><span class="s1">&#39;E (MJ)&#39;</span><span class="p">,</span><span class="s1">&#39;L sat&#39;</span><span class="p">,</span><span class="s1">&#39;Temp (C)&#39;</span><span class="p">,</span><span class="s1">&#39;(kg/s)&#39;</span><span class="p">,</span><span class="s1">&#39;(MJ/s)&#39;</span><span class="p">,</span><span class="s1">&#39;perm (m2)&#39;</span><span class="p">,</span><span class="s1">&#39;porosity&#39;</span><span class="p">,</span><span class="s1">&#39;Kx W/(m K)&#39;</span><span class="p">,</span><span class="s1">&#39;Pwv (MPa)&#39;</span><span class="p">,</span><span class="s1">&#39;D*wv (m2/s)&#39;</span><span class="p">,</span><span class="s1">&#39;ps_delta_rxn&#39;</span><span class="p">,</span><span class="s1">&#39;density (kg/m3)&#39;</span><span class="p">]</span>
			<span class="n">keys_save</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;sat&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;Qm&#39;</span><span class="p">,</span><span class="s1">&#39;Qe&#39;</span><span class="p">,</span><span class="s1">&#39;perm&#39;</span><span class="p">,</span><span class="s1">&#39;por&#39;</span><span class="p">,</span><span class="s1">&#39;Kx&#39;</span><span class="p">,</span><span class="s1">&#39;Pwv&#39;</span><span class="p">,</span><span class="s1">&#39;D*wv&#39;</span><span class="p">,</span><span class="s1">&#39;ps_delta&#39;</span><span class="p">,</span><span class="s1">&#39;dens&#39;</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s1">&#39;gas&#39;</span><span class="p">:</span> 
			<span class="n">keys_read</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Gas (MPa)&#39;</span><span class="p">,</span><span class="s1">&#39;Pres (MPa)&#39;</span><span class="p">,</span><span class="s1">&#39;(kg/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Residual&#39;</span><span class="p">]</span> 
			<span class="n">keys_read2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Capillary&#39;</span><span class="p">,</span><span class="s1">&#39;Liquid&#39;</span><span class="p">]</span>
			
			<span class="n">keys_save</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P_gas&#39;</span><span class="p">,</span><span class="s1">&#39;Pres (MPa)&#39;</span><span class="p">,</span><span class="s1">&#39;Qgas&#39;</span><span class="p">,</span><span class="s1">&#39;residual&#39;</span><span class="p">]</span> 
			<span class="n">keys_save2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P_cap&#39;</span><span class="p">,</span><span class="s1">&#39;P_liq&#39;</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tracer&#39;</span><span class="p">):</span> 
			<span class="n">keys_read</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">,</span><span class="s1">&#39;anl&#39;</span><span class="p">,</span><span class="s1">&#39;anw&#39;</span><span class="p">,</span><span class="s1">&#39;mol/s&#39;</span><span class="p">,</span><span class="s1">&#39;residual&#39;</span><span class="p">]</span>
			<span class="n">keys_read2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sinkint&#39;</span><span class="p">]</span>
			<span class="n">keys_save</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;an&#39;</span><span class="p">,</span><span class="s1">&#39;anl&#39;</span><span class="p">,</span><span class="s1">&#39;anw&#39;</span><span class="p">,</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span><span class="s1">&#39;residual&#39;</span><span class="p">]</span>
			<span class="n">keys_save2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sinkint&#39;</span><span class="p">]</span>
		<span class="n">key_pos</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">kr</span><span class="p">,</span><span class="n">ks</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys_read</span><span class="p">,</span><span class="n">keys_save</span><span class="p">):</span>
			<span class="k">if</span> <span class="n">kr</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
				<span class="k">if</span> <span class="n">kr</span> <span class="o">==</span> <span class="s1">&#39;Pres (MPa)&#39;</span><span class="p">:</span>
					<span class="k">for</span> <span class="n">kr2</span><span class="p">,</span><span class="n">ks2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys_read2</span><span class="p">,</span><span class="n">keys_save2</span><span class="p">):</span>
						<span class="k">if</span> <span class="n">kr2</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> 
							<span class="n">key_pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ks2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">kr2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">key_pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ks</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">kr</span><span class="p">)[</span><span class="mi">0</span><span class="p">])))</span>
		<span class="k">if</span> <span class="nb">type</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;tracer&#39;</span><span class="p">):</span>
			<span class="k">for</span> <span class="n">kr2</span><span class="p">,</span><span class="n">ks2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys_read2</span><span class="p">,</span><span class="n">keys_save2</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">kr2</span> <span class="ow">in</span> <span class="n">lns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> 
					<span class="n">key_pos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ks2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">lns</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">kr2</span><span class="p">)[</span><span class="mi">0</span><span class="p">])))</span>
		<span class="n">key_pos</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
		
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
		<span class="k">while</span> <span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;-&#39;</span><span class="p">:</span>
			<span class="n">nd</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">lni</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span> <span class="ow">in</span> <span class="n">ln</span><span class="p">[</span><span class="mi">1</span><span class="p">:]]</span>
			<span class="k">if</span> <span class="n">nd</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">nd</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],[])</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key_pos</span><span class="p">])</span>
			<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">key_pos</span><span class="p">,</span><span class="n">vals</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">nd</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">nd</span><span class="p">][</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">nd</span><span class="p">][</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
			<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
			<span class="n">ln</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
				<span class="k">while</span> <span class="ow">not</span> <span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
					<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">ln</span><span class="p">)</span>
					<span class="n">ln</span> <span class="o">=</span> <span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
					
				<span class="bp">self</span><span class="o">.</span><span class="n">update_node_general</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
				<span class="k">return</span>
		<span class="k">return</span>
	<span class="k">def</span> <span class="nf">update_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Conservation Errors:&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">mass_error</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">energy_error</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;mass_error&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;mass_error&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;energy_error&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;energy_error&#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="kc">True</span>
	<span class="k">def</span> <span class="nf">update_residuals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;Largest Residuals&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="c1"># get first residual</span>
		<span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">nd</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
			<span class="n">pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual1</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt</span><span class="o">-</span><span class="mf">1.e-30</span><span class="p">,</span><span class="n">pt</span><span class="o">+</span><span class="mf">1.e-30</span><span class="p">]</span>
		<span class="c1"># get second residual</span>
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
			<span class="n">pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual2</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt</span><span class="o">-</span><span class="mf">1.e-30</span><span class="p">,</span><span class="n">pt</span><span class="o">+</span><span class="mf">1.e-30</span><span class="p">]</span>
		<span class="c1"># get third residual</span>
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;EQ3&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
				<span class="n">pt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">residual3</span><span class="o">.</span><span class="n">lim</span> <span class="o">=</span> <span class="p">[</span><span class="n">pt</span><span class="o">-</span><span class="mf">1.e-30</span><span class="p">,</span><span class="n">pt</span><span class="o">+</span><span class="mf">1.e-30</span><span class="p">]</span>
				
		<span class="c1"># plot residuals on log axes</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;residual1&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;residual1&#39;</span><span class="p">)</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;residual2&#39;</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;residual2&#39;</span><span class="p">)</span>
		
		<span class="k">if</span> <span class="n">ln</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;EQ3&#39;</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_lim</span><span class="p">(</span><span class="s1">&#39;residual3&#39;</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">update_plot</span><span class="p">(</span><span class="s1">&#39;residual3&#39;</span><span class="p">)</span>
	<span class="k">def</span> <span class="nf">update_largestNR</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ln</span><span class="p">):</span>
		<span class="n">check_string</span> <span class="o">=</span> <span class="s1">&#39;#### largest N-R corrections, timestep&#39;</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="p">):</span> <span class="k">return</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([(</span><span class="n">lni</span> <span class="o">==</span> <span class="n">chk</span><span class="p">)</span> <span class="k">for</span> <span class="n">lni</span><span class="p">,</span> <span class="n">chk</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">check_string</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span><span class="n">ln</span><span class="p">)]):</span> <span class="k">return</span> <span class="kc">False</span>
		
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="k">try</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
		<span class="k">except</span><span class="p">:</span> <span class="k">return</span>
		
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">timestep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">new_node</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
		
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">new_node</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="mi">2</span><span class="p">)</span>
		
		<span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">printout</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">new_node</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">ln</span><span class="p">[</span><span class="mi">4</span><span class="p">]),</span><span class="mi">3</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span> 
			<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R3_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.e-30</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">R3_node</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
		
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">nodelist</span><span class="p">)</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
			<span class="k">pass</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_NR</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">redraw</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">largest_NR</span><span class="o">.</span><span class="n">retext</span><span class="p">()</span>
	<span class="k">def</span> <span class="nf">_get_axs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">],[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ax1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ax2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ax3</span><span class="p">]))</span>
	<span class="n">axs</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_axs</span><span class="p">)</span>
<div class="viewcode-block" id="foutput"><a class="viewcode-back" href="../fdata.html#fdata.foutput">[docs]</a><span class="k">class</span> <span class="nc">foutput</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">grid</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hide</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">silent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">filename</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_silent</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">silent</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">:</span>
			<span class="k">if</span> <span class="nb">input</span> <span class="ow">and</span> <span class="n">grid</span><span class="p">:</span>
				<span class="n">diag</span> <span class="o">=</span> <span class="n">process_output</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">hide</span> <span class="o">=</span> <span class="n">hide</span><span class="p">,</span><span class="n">silent</span> <span class="o">=</span> <span class="n">silent</span><span class="p">,</span><span class="nb">input</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span><span class="n">write</span><span class="o">=</span><span class="n">write</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">diag</span> <span class="o">=</span> <span class="n">process_output</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">hide</span> <span class="o">=</span> <span class="n">hide</span><span class="p">,</span><span class="n">silent</span><span class="o">=</span><span class="n">silent</span><span class="p">,</span><span class="n">write</span><span class="o">=</span><span class="n">write</span><span class="p">)</span>		
		<span class="bp">self</span><span class="o">.</span><span class="n">_node</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">diag</span><span class="o">.</span><span class="n">node</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">diag</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
	<span class="k">def</span> <span class="nf">_get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span>
	<span class="n">node</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_node</span><span class="p">)</span> <span class="c1">#: (*dict*) Dictionary of node output, keyed first on component (&#39;water&#39;,&#39;gas&#39;,&#39;tracer1&#39;), then on node number, then on variable.</span>
	<span class="k">def</span> <span class="nf">_get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="s1">&#39;gas&#39;</span><span class="p">,</span><span class="s1">&#39;tracer1&#39;</span><span class="p">]:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> <span class="k">continue</span>
			<span class="n">nds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">nds</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
			<span class="k">return</span> <span class="n">nds</span>
		<span class="k">return</span> <span class="kc">None</span>
	<span class="n">nodes</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_nodes</span><span class="p">)</span>
	
	<span class="k">def</span> <span class="nf">_get_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot; Get Variables</span>
<span class="sd">		Returns the variables in the foutput object or returns None if no </span>
<span class="sd">		variables. &quot;&quot;&quot;</span>

		<span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="s1">&#39;gas&#39;</span><span class="p">,</span><span class="s1">&#39;tracer1&#39;</span><span class="p">]:</span>
			<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
				<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">node</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span> 
					<span class="k">continue</span>
					
				<span class="n">vrbls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="p">[</span><span class="nb">type</span><span class="p">][</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
				<span class="n">vrbls</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
				
				<span class="k">return</span> <span class="n">vrbls</span>
			
		<span class="k">return</span> <span class="kc">None</span>

	<span class="n">variables</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_variables</span><span class="p">)</span> <span class="c1">#: (*lst*) List of variables available for the various components.</span>
    
	<span class="k">def</span> <span class="nf">_get_components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
		<span class="n">cpts</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="nb">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span><span class="s1">&#39;gas&#39;</span><span class="p">,</span><span class="s1">&#39;tracer1&#39;</span><span class="p">,</span><span class="s1">&#39;tracer2&#39;</span><span class="p">]:</span>		
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_node</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">cpts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">cpts</span>
	<span class="n">components</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_components</span><span class="p">)</span> <span class="c1">#: (*lst*) Component names for which nodal information available</span>
	
	<span class="k">def</span> <span class="nf">_get_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span>
	<span class="n">times</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_times</span><span class="p">)</span> <span class="c1">#: (*ndarray*) Vector of output times.</span>
	<span class="k">def</span> <span class="nf">_get_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span>
	<span class="k">def</span> <span class="nf">_set_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">value</span>
	<span class="n">filename</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_filename</span><span class="p">,</span> <span class="n">_set_filename</span><span class="p">)</span> <span class="c1">#: (*str*) Name of output file</span>
	<span class="k">def</span> <span class="nf">_get_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="nb">print</span> <span class="s1">&#39;FEHM output file </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">&#39;</span>
		<span class="nb">print</span> <span class="s1">&#39;    call format: foutput.node[component][node][variable]&#39;</span>
		<span class="n">prntStr</span> <span class="o">=</span>  <span class="s1">&#39;    components: &#39;</span>
		<span class="k">for</span> <span class="n">cpt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">components</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cpt</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="nb">print</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
		<span class="n">prntStr</span> <span class="o">=</span> <span class="s1">&#39;    nodes: &#39;</span>
		<span class="k">for</span> <span class="n">nd</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span> <span class="n">prntStr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;, &#39;</span>
		<span class="nb">print</span> <span class="n">prntStr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
	<span class="n">what</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_information</span><span class="p">)</span> <span class="c1">#:(*str*) Print out information about the fcontour object.</span></div>
	
	
	
	
	
	
	
	
	
	
	
	
</pre></div>

          </div>
            
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFEHM 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2018, Los Alamos National Laboratory. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>