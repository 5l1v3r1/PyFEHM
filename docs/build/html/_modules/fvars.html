
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>fvars &#8212; PyFEHM 1.0.4 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  
   

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFEHM 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar"><a href="
    ../index.html" class="text-logo">PyFEHM</a>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fgrid.html">fgrid: FEHM grid manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fdata.html">fdata: FEHM input file manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fpost.html">fpost: FEHM output file manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fvars.html">fvars: FEHM thermodynamic calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorials</a></li>
</ul>

    
  </div>
</div>
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
      
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Module code</a></li>
              
              <li>fvars</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <h1>Source code for fvars</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Functions for FEHM thermodynamic variables calculations.&quot;&quot;&quot;</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Copyright 2013.</span>
<span class="sd">Los Alamos National Security, LLC. </span>
<span class="sd">This material was produced under U.S. Government contract DE-AC52-06NA25396 for </span>
<span class="sd">Los Alamos National Laboratory (LANL), which is operated by Los Alamos National </span>
<span class="sd">Security, LLC for the U.S. Department of Energy. The U.S. Government has rights </span>
<span class="sd">to use, reproduce, and distribute this software.  NEITHER THE GOVERNMENT NOR LOS </span>
<span class="sd">ALAMOS NATIONAL SECURITY, LLC MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR ASSUMES </span>
<span class="sd">ANY LIABILITY FOR THE USE OF THIS SOFTWARE.  If software is modified to produce </span>
<span class="sd">derivative works, such modified software should be clearly marked, so as not to </span>
<span class="sd">confuse it with the version available from LANL.</span>

<span class="sd">Additionally, this library is free software; you can redistribute it and/or modify </span>
<span class="sd">it under the terms of the GNU Lesser General Public License as published by the </span>
<span class="sd">Free Software Foundation; either version 2.1 of the License, or (at your option) </span>
<span class="sd">any later version. Accordingly, this library is distributed in the hope that it </span>
<span class="sd">will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of </span>
<span class="sd">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General </span>
<span class="sd">Public License for more details.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">ftool</span> <span class="k">import</span><span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">interpolate</span>

<span class="kn">from</span> <span class="nn">fdflt</span> <span class="k">import</span><span class="o">*</span>
<span class="n">dflt</span> <span class="o">=</span> <span class="n">fdflt</span><span class="p">()</span>

<span class="n">YEL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.25623465e-03</span><span class="p">,</span> <span class="mf">0.10184405e-02</span><span class="p">,</span> <span class="mf">0.22554970e-04</span><span class="p">,</span> <span class="mf">0.34836663e-07</span><span class="p">,</span> <span class="mf">0.41769866e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21244879e-04</span><span class="p">,</span> 
   <span class="mf">0.25493516e-07</span><span class="p">,</span> <span class="mf">0.89557885e-04</span><span class="p">,</span> <span class="mf">0.10855046e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21720560e-06</span><span class="p">,]</span>
<span class="n">YEV</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.31290881e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10e+01</span><span class="p">,</span> <span class="mf">0.25748596e-01</span><span class="p">,</span> <span class="mf">0.38846142e-03</span><span class="p">,</span> <span class="mf">0.11319298e-01</span><span class="p">,</span> <span class="mf">0.20966376e-04</span><span class="p">,</span> 
   <span class="mf">0.74228083e-08</span><span class="p">,</span> <span class="mf">0.19206133e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10372453e-03</span><span class="p">,</span> <span class="mf">0.59104245e-07</span><span class="p">,]</span>
<span class="n">YDL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mf">0.17472599e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.20443098e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17442012e-06</span><span class="p">,</span> <span class="mf">0.49564109e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40757664e-04</span><span class="p">,</span> 
   <span class="mf">0.50676664e-07</span><span class="p">,</span> <span class="mf">0.50330978e-04</span><span class="p">,</span> <span class="mf">0.33914814e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.18383009e-06</span><span class="p">,]</span> 
<span class="n">YDV</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.15089524e-05</span><span class="p">,</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.16676705e-02</span><span class="p">,</span> <span class="mf">0.40111210e-07</span><span class="p">,</span> <span class="mf">0.25625316e-10</span><span class="p">,</span> 
  <span class="o">-</span><span class="mf">0.40479650e-12</span><span class="p">,</span> <span class="mf">0.43379623e-01</span><span class="p">,</span> <span class="mf">0.24991800e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.94755043e-04</span><span class="p">,]</span>
<span class="n">YVL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.17409149e-02</span><span class="p">,</span> <span class="mf">0.18894882e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.66439332e-07</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.23122388e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31534914e-05</span><span class="p">,</span> <span class="mf">0.11120716e-07</span><span class="p">,</span> 
  <span class="o">-</span><span class="mf">0.48576020e-10</span><span class="p">,</span> <span class="mf">0.28006861e-07</span><span class="p">,</span> <span class="mf">0.23225035e-09</span><span class="p">,</span> <span class="mf">0.47180171e-10</span><span class="p">,]</span> 
<span class="n">YVV</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.13920783e-03</span><span class="p">,</span> <span class="mf">0.98434337e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.51504232e-03</span><span class="p">,</span> <span class="mf">0.62554603e-04</span><span class="p">,</span> <span class="mf">0.27105772e-04</span><span class="p">,</span> <span class="mf">0.84981906e-05</span><span class="p">,</span> 
   <span class="mf">0.34539757e-07</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25524682e-03</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.12316788e-05</span><span class="p">,]</span> 
 
<span class="n">ZEL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mf">0.23513278e-01</span><span class="p">,</span> <span class="mf">0.48716386e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.19935046e-08</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50770309e-02</span><span class="p">,</span> <span class="mf">0.57780287e-05</span><span class="p">,</span> 
   <span class="mf">0.90972916e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.58981537e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12990752e-07</span><span class="p">,</span> <span class="mf">0.45872518e-08</span><span class="p">,]</span>
<span class="n">ZEV</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.12511319e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36061317e+00</span><span class="p">,</span> <span class="mf">0.58668929e-02</span><span class="p">,</span> <span class="mf">0.99059715e-04</span><span class="p">,</span> <span class="mf">0.44331611e-02</span><span class="p">,</span> <span class="mf">0.50902084e-05</span><span class="p">,</span> 
  <span class="o">-</span><span class="mf">0.10812602e-08</span><span class="p">,</span> <span class="mf">0.90918809e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26960555e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.36454880e-06</span><span class="p">,]</span>
<span class="n">ZDL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10009476e-02</span><span class="p">,</span> <span class="mf">0.16812589e-04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.24582622e-07</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.17014984e-09</span><span class="p">,</span> <span class="mf">0.48841156e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32967985e-07</span><span class="p">,</span> 
   <span class="mf">0.28619380e-10</span><span class="p">,</span> <span class="mf">0.53249055e-07</span><span class="p">,</span> <span class="mf">0.30456698e-09</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.12221899e-09</span><span class="p">,]</span>
<span class="n">ZDV</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.12636224e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.30463489e+00</span><span class="p">,</span> <span class="mf">0.27981880e-02</span><span class="p">,</span> <span class="mf">0.51132337e-05</span><span class="p">,</span> <span class="mf">0.59318010e-02</span><span class="p">,</span> <span class="mf">0.80972509e-05</span><span class="p">,</span> 
  <span class="o">-</span><span class="mf">0.43798358e-07</span><span class="p">,</span> <span class="mf">0.53046787e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.84916607e-05</span><span class="p">,</span> <span class="mf">0.48444919e-06</span><span class="p">,]</span>
<span class="n">ZVL</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mf">0.10523153e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22658391e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31796607e-06</span><span class="p">,</span> <span class="mf">0.29869141e-01</span><span class="p">,</span> <span class="mf">0.21844248e-03</span><span class="p">,</span> 
  <span class="o">-</span><span class="mf">0.87658855e-06</span><span class="p">,</span> <span class="mf">0.41690362e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25147022e-05</span><span class="p">,</span> <span class="mf">0.22144660e-05</span><span class="p">,]</span>
<span class="n">ZVV</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10e1</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.10e1</span> <span class="p">,</span> <span class="mf">0.10000000e+01</span><span class="p">,</span>  <span class="mf">0.0000000e+01</span><span class="p">,</span>
  <span class="o">-</span><span class="mf">0.22934622e-03</span><span class="p">,</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.25834551e-01</span><span class="p">,]</span>    
  
<span class="n">YSP</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.71725602e-03</span><span class="p">,</span> <span class="mf">0.22607516e-04</span><span class="p">,</span> <span class="mf">0.26178556e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.10516335e-07</span><span class="p">,</span> <span class="mf">0.63167028e-09</span><span class="p">,]</span>
<span class="n">YST</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.25048121e-05</span><span class="p">,</span> <span class="mf">0.45249584e-02</span><span class="p">,</span> <span class="mf">0.33551528e+00</span><span class="p">,</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="mf">0.12254786e+00</span><span class="p">,]</span>

<span class="n">ZSP</span><span class="o">=</span><span class="p">[</span> <span class="mf">0.10000000e+01</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.22460012e-02</span><span class="p">,</span> <span class="mf">0.30234492e-05</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32466525e-09</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,]</span>
<span class="n">ZST</span><span class="o">=</span><span class="p">[</span><span class="mf">0.20889841e-06</span><span class="p">,</span> <span class="mf">0.11587544e-03</span><span class="p">,</span> <span class="mf">0.31934455e-02</span><span class="p">,</span> <span class="mf">0.45538151e-02</span><span class="p">,</span> <span class="mf">0.23756593e-03</span><span class="p">,]</span>  

<span class="k">if</span> <span class="n">WINDOWS</span><span class="p">:</span>
	<span class="n">co2_interp_path</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">co2_interp_path</span>
<span class="k">else</span><span class="p">:</span>
	<span class="n">co2_interp_path</span> <span class="o">=</span> <span class="n">dflt</span><span class="o">.</span><span class="n">co2_interp_path</span>

<span class="n">co2Vars</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">if</span> <span class="n">co2_interp_path</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">co2_interp_path</span><span class="p">):</span> <span class="n">co2Vars</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">if</span> <span class="n">co2Vars</span><span class="p">:</span>
	<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">co2_interp_path</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">tn</span><span class="p">,</span><span class="n">pn</span><span class="p">,</span><span class="n">na</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]</span>
		<span class="n">tn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tn</span><span class="p">);</span> <span class="n">pn</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pn</span><span class="p">);</span> <span class="n">na</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">na</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="c1"># read in temperature data</span>
		<span class="n">keepReading</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="n">T</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
			<span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
		<span class="n">T</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">T</span><span class="p">))</span>
		<span class="n">Tval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">T</span><span class="p">])</span>
		<span class="n">Tdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">t</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Tval</span><span class="p">)])</span>
		<span class="c1"># read in pressure data</span>
		<span class="n">P</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
			<span class="n">P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
		<span class="n">P</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
		<span class="n">Pval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">])</span>	
		<span class="n">Pdict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">p</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Pval</span><span class="p">)])</span>
		<span class="c1"># read to array data</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
		<span class="c1"># read in array data</span>
		<span class="n">arraynames</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">,</span><span class="s1">&#39;dddt&#39;</span><span class="p">,</span><span class="s1">&#39;dddp&#39;</span><span class="p">,</span><span class="s1">&#39;enthalpy&#39;</span><span class="p">,</span><span class="s1">&#39;dhdt&#39;</span><span class="p">,</span><span class="s1">&#39;dhdp&#39;</span><span class="p">,</span><span class="s1">&#39;viscosity&#39;</span><span class="p">,</span><span class="s1">&#39;dvdt&#39;</span><span class="p">,</span><span class="s1">&#39;dvdp&#39;</span><span class="p">]</span>
		<span class="n">arrays</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">arrayname</span> <span class="ow">in</span> <span class="n">arraynames</span><span class="p">:</span>
			<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
				<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
				<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
				<span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
			<span class="n">array</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">array</span><span class="p">))</span>
			<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">array</span><span class="p">])</span>	
			<span class="n">arrays</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="n">arrayname</span><span class="p">,</span><span class="n">array</span><span class="p">),)))</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;Number of saturation line vertices&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> 
				<span class="n">n_sv</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
				<span class="k">break</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="c1"># read in saturation line vertices</span>
		<span class="n">co2_sat_P</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">co2_sat_T</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="n">co2_sat_i</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sv</span><span class="p">):</span>
			<span class="n">vs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
			<span class="n">co2_sat_i</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
			<span class="n">co2_sat_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
			<span class="n">co2_sat_T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">co2l_arrays</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sv</span><span class="p">):</span>
			<span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
		<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">arrayname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arraynames</span><span class="p">):</span>
			<span class="n">co2l_arrays</span><span class="p">[</span><span class="n">arrayname</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
		<span class="k">while</span> <span class="n">keepReading</span><span class="p">:</span>
			<span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
			<span class="k">if</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span> <span class="k">break</span>
		<span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">co2g_arrays</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="n">array</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_sv</span><span class="p">):</span>
			<span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()])</span>
		<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
		<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">arrayname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">arraynames</span><span class="p">):</span>
			<span class="n">co2g_arrays</span><span class="p">[</span><span class="n">arrayname</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>

	
<div class="viewcode-block" id="dens"><a class="viewcode-back" href="../fvars.html#fvars.dens">[docs]</a><span class="k">def</span> <span class="nf">dens</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">derivative</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return liquid water, vapor water and CO2 density, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</span>
<span class="sd">	</span>
<span class="sd">	:param P: Pressure (MPa). </span>
<span class="sd">	:type P: fl64</span>
<span class="sd">	:param T: Temperature (degC)</span>
<span class="sd">	:type T: fl64</span>
<span class="sd">	:param derivative: Supply &#39;T&#39; or &#39;temperature&#39; for derivatives with respect to temperature, or &#39;P&#39; or &#39;pressure&#39; for derivatives with respect to pressure.</span>
<span class="sd">	:type T: str</span>
<span class="sd">	:returns: Three element tuple containing (liquid, vapor, CO2) density or derivatives if requested.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span> 
		<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
	<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span> 
		<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T</span><span class="p">])</span>
	<span class="c1"># calculate water properties</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="n">YL0</span><span class="o">/</span><span class="n">ZL0</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="n">YV0</span><span class="o">/</span><span class="n">ZV0</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZDV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZDV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;not a valid derivative&#39;</span><span class="p">;</span> <span class="k">return</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">co2Vars</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
	
	<span class="c1"># calculate co2 properties</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dddp&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dddt&#39;</span>
	
	<span class="n">arr_z</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">Pval</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">Tval</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Pval</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">Tval</span><span class="p">))</span> 
	<span class="n">fdens</span> <span class="o">=</span> <span class="n">interpolate</span><span class="o">.</span><span class="n">interp2d</span><span class="p">(</span> <span class="n">Tval</span><span class="p">,</span> <span class="n">Pval</span><span class="p">,</span> <span class="n">arr_z</span> <span class="p">)</span>
	<span class="n">dens_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">fdens</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">P</span><span class="p">)]</span> 

	<span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dens_c</span><span class="p">))</span></div>
<div class="viewcode-block" id="enth"><a class="viewcode-back" href="../fvars.html#fvars.enth">[docs]</a><span class="k">def</span> <span class="nf">enth</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">derivative</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return liquid water, vapor water and CO2 enthalpy, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</span>
<span class="sd">	</span>
<span class="sd">	:param P: Pressure (MPa). </span>
<span class="sd">	:type P: fl64</span>
<span class="sd">	:param T: Temperature (degC)</span>
<span class="sd">	:type T: fl64</span>
<span class="sd">	:param derivative: Supply &#39;T&#39; or &#39;temperature&#39; for derivatives with respect to temperature, or &#39;P&#39; or &#39;pressure&#39; for derivatives with respect to pressure.</span>
<span class="sd">	:type T: str</span>
<span class="sd">	:returns: Three element tuple containing (liquid, vapor, CO2) enthalpy or derivatives if requested.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
	<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="n">YL0</span><span class="o">/</span><span class="n">ZL0</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="n">YV0</span><span class="o">/</span><span class="n">ZV0</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZEV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZEV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;not a valid derivative&#39;</span><span class="p">;</span> <span class="k">return</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">co2Vars</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
		
	<span class="c1"># calculate co2 properties</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;enthalpy&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dhdp&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dhdt&#39;</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T</span><span class="p">])</span>
	<span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">P</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
	<span class="c1"># calculate bounding values of P</span>
	<span class="n">dens_c</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">Ti</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">Pi</span><span class="o">&lt;=</span><span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">Pi</span><span class="o">&gt;=</span><span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="k">if</span> <span class="n">Pi</span><span class="o">&lt;=</span><span class="n">p</span><span class="p">:</span> 
					<span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="k">break</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">p0</span> <span class="o">=</span> <span class="n">p</span>
		<span class="c1"># calculate bounding values of T</span>
		<span class="k">if</span> <span class="n">Ti</span><span class="o">&lt;=</span><span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">Ti</span><span class="o">&gt;=</span><span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="k">if</span> <span class="n">Ti</span><span class="o">&lt;=</span><span class="n">t</span><span class="p">:</span> 
					<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="k">break</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>
		<span class="c1"># calculate four indices</span>
		<span class="n">dt0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ti</span><span class="o">-</span><span class="n">t0</span><span class="p">);</span> <span class="n">dt1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ti</span><span class="o">-</span><span class="n">t1</span><span class="p">);</span> <span class="n">dp0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Pi</span><span class="o">-</span><span class="n">p0</span><span class="p">);</span> <span class="n">dp1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Pi</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span>
		<span class="n">t0</span> <span class="o">=</span> <span class="n">Tdict</span><span class="p">[</span><span class="n">t0</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tdict</span><span class="p">[</span><span class="n">t1</span><span class="p">];</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pdict</span><span class="p">[</span><span class="n">p0</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pdict</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
		<span class="n">i1</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t0</span>
		<span class="n">i2</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t1</span>
		<span class="n">i3</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t0</span>
		<span class="n">i4</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t1</span>
		<span class="c1"># locate value in array</span>
		<span class="n">v1</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i1</span><span class="p">]</span>
		<span class="n">v2</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span>
		<span class="n">v3</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i3</span><span class="p">]</span>
		<span class="n">v4</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i4</span><span class="p">]</span>
		<span class="n">dens_c</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">v3</span><span class="o">+</span><span class="n">t0</span><span class="o">*</span><span class="n">v4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t1</span><span class="o">+</span><span class="n">t0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">v1</span><span class="o">+</span><span class="n">t0</span><span class="o">*</span><span class="n">v2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t1</span><span class="o">+</span><span class="n">t0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="n">p1</span><span class="p">))</span>
	
	<span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dens_c</span><span class="p">))</span></div>
<div class="viewcode-block" id="visc"><a class="viewcode-back" href="../fvars.html#fvars.visc">[docs]</a><span class="k">def</span> <span class="nf">visc</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">derivative</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return liquid water, vapor water and CO2 viscosity, or derivatives with respect to temperature or pressure, for specified temperature and pressure.</span>
<span class="sd">	</span>
<span class="sd">	:param P: Pressure (MPa). </span>
<span class="sd">	:type P: fl64</span>
<span class="sd">	:param T: Temperature (degC)</span>
<span class="sd">	:type T: fl64</span>
<span class="sd">	:param derivative: Supply &#39;T&#39; or &#39;temperature&#39; for derivatives with respect to temperature, or &#39;P&#39; or &#39;pressure&#39; for derivatives with respect to pressure.</span>
<span class="sd">	:type T: str</span>
<span class="sd">	:returns: Three element tuple containing (liquid, vapor, CO2) viscosity or derivatives if requested.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
	<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="n">YL0</span><span class="o">/</span><span class="n">ZL0</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="n">YV0</span><span class="o">/</span><span class="n">ZV0</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span>
		<span class="c1"># terms</span>
		<span class="n">YL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVV</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
		<span class="c1"># derivatives</span>
		<span class="n">YL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZL1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">YV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">YVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">ZV1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZVV</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">*</span><span class="n">P</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span>
		       <span class="n">ZVV</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
		<span class="n">dens_l</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZL0</span><span class="o">*</span><span class="n">YL1</span><span class="o">-</span><span class="n">YL0</span><span class="o">*</span><span class="n">ZL1</span><span class="p">)</span><span class="o">/</span><span class="n">ZL0</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">dens_v</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZV0</span><span class="o">*</span><span class="n">YV1</span><span class="o">-</span><span class="n">YV0</span><span class="o">*</span><span class="n">ZV1</span><span class="p">)</span><span class="o">/</span><span class="n">ZV0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">else</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;not a valid derivative&#39;</span><span class="p">;</span> <span class="k">return</span>
	
	<span class="c1"># calculate co2 properties</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;viscosity&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dvdp&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dvdt&#39;</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">co2Vars</span><span class="p">:</span> <span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
	
	<span class="k">if</span> <span class="ow">not</span> <span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">P</span><span class="p">])</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T</span><span class="p">])</span>
	<span class="k">if</span> <span class="n">P</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">P</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">T</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">P</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="n">T</span> <span class="o">=</span> <span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">P</span><span class="p">)))[</span><span class="mi">0</span><span class="p">]</span>
	<span class="c1"># calculate bounding values of P</span>
	<span class="n">dens_c</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="k">for</span> <span class="n">Pi</span><span class="p">,</span> <span class="n">Ti</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">T</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">Pi</span><span class="o">&lt;=</span><span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">Pi</span><span class="o">&gt;=</span><span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">p0</span> <span class="o">=</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Pval</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="k">if</span> <span class="n">Pi</span><span class="o">&lt;=</span><span class="n">p</span><span class="p">:</span> 
					<span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="p">;</span> <span class="k">break</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">p0</span> <span class="o">=</span> <span class="n">p</span>
		<span class="c1"># calculate bounding values of T</span>
		<span class="k">if</span> <span class="n">Ti</span><span class="o">&lt;=</span><span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">elif</span> <span class="n">Ti</span><span class="o">&gt;=</span><span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">t0</span> <span class="o">=</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">Tval</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
				<span class="k">if</span> <span class="n">Ti</span><span class="o">&lt;=</span><span class="n">t</span><span class="p">:</span> 
					<span class="n">t1</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="k">break</span>
				<span class="k">else</span><span class="p">:</span> 
					<span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>
		<span class="c1"># calculate four indices</span>
		<span class="n">dt0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ti</span><span class="o">-</span><span class="n">t0</span><span class="p">);</span> <span class="n">dt1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Ti</span><span class="o">-</span><span class="n">t1</span><span class="p">);</span> <span class="n">dp0</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Pi</span><span class="o">-</span><span class="n">p0</span><span class="p">);</span> <span class="n">dp1</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Pi</span><span class="o">-</span><span class="n">p1</span><span class="p">)</span>
		<span class="n">t0</span> <span class="o">=</span> <span class="n">Tdict</span><span class="p">[</span><span class="n">t0</span><span class="p">];</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">Tdict</span><span class="p">[</span><span class="n">t1</span><span class="p">];</span> <span class="n">p0</span> <span class="o">=</span> <span class="n">Pdict</span><span class="p">[</span><span class="n">p0</span><span class="p">];</span> <span class="n">p1</span> <span class="o">=</span> <span class="n">Pdict</span><span class="p">[</span><span class="n">p1</span><span class="p">]</span>
		<span class="n">i1</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t0</span>
		<span class="n">i2</span> <span class="o">=</span> <span class="n">p0</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t1</span>
		<span class="n">i3</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t0</span>
		<span class="n">i4</span> <span class="o">=</span> <span class="n">p1</span><span class="o">*</span><span class="n">tn</span><span class="o">+</span><span class="n">t1</span>
		<span class="c1"># locate value in array</span>
		<span class="n">v1</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i1</span><span class="p">]</span>
		<span class="n">v2</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i2</span><span class="p">]</span>
		<span class="n">v3</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i3</span><span class="p">]</span>
		<span class="n">v4</span> <span class="o">=</span> <span class="n">arrays</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i4</span><span class="p">]</span>
		<span class="n">dens_c</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">p0</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">v3</span><span class="o">+</span><span class="n">t0</span><span class="o">*</span><span class="n">v4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t1</span><span class="o">+</span><span class="n">t0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p1</span><span class="o">*</span><span class="p">(</span><span class="n">t1</span><span class="o">*</span><span class="n">v1</span><span class="o">+</span><span class="n">t0</span><span class="o">*</span><span class="n">v2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">t1</span><span class="o">+</span><span class="n">t0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">p0</span><span class="o">+</span><span class="n">p1</span><span class="p">))</span>
	
	<span class="k">return</span> <span class="p">(</span><span class="n">dens_l</span><span class="p">,</span><span class="n">dens_v</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dens_c</span><span class="p">)</span><span class="o">*</span><span class="mf">1e-6</span><span class="p">)</span></div>
<div class="viewcode-block" id="sat"><a class="viewcode-back" href="../fvars.html#fvars.sat">[docs]</a><span class="k">def</span> <span class="nf">sat</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return saturation pressure and first derivative for given temperature.</span>
<span class="sd">	</span>
<span class="sd">	:param T: Temperature (degC)</span>
<span class="sd">	:type T: fl64</span>
<span class="sd">	:returns: Two element tuple containing (saturation pressure, derivative).</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">Y0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YSP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Z0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZSP</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YSP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">YSP</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Z1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZSP</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">ZSP</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">satP</span> <span class="o">=</span> <span class="n">Y0</span><span class="o">/</span><span class="n">Z0</span>
	<span class="n">dsatPdT</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z0</span><span class="o">*</span><span class="n">Y1</span><span class="o">-</span><span class="n">Y0</span><span class="o">*</span><span class="n">Z1</span><span class="p">)</span><span class="o">/</span><span class="n">Z0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">satP</span><span class="p">,</span> <span class="n">dsatPdT</span><span class="p">)</span></div>
<div class="viewcode-block" id="tsat"><a class="viewcode-back" href="../fvars.html#fvars.tsat">[docs]</a><span class="k">def</span> <span class="nf">tsat</span><span class="p">(</span><span class="n">P</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return saturation temperature and first derivative for given pressure.</span>
<span class="sd">	</span>
<span class="sd">	:param P: Pressure (degC)</span>
<span class="sd">	:type P: fl64</span>
<span class="sd">	:returns: Two element tuple containing (saturation temperature, derivative).</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">Y0</span> <span class="o">=</span> <span class="p">(</span><span class="n">YST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Z0</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">YST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">YST</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">Z1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZST</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span>
	      <span class="n">ZST</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="n">P</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
	<span class="n">satT</span> <span class="o">=</span> <span class="n">Y0</span><span class="o">/</span><span class="n">Z0</span>
	<span class="n">dsatTdP</span> <span class="o">=</span> <span class="p">(</span><span class="n">Z0</span><span class="o">*</span><span class="n">Y1</span><span class="o">-</span><span class="n">Y0</span><span class="o">*</span><span class="n">Z1</span><span class="p">)</span><span class="o">/</span><span class="n">Z0</span><span class="o">**</span><span class="mi">2</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">satT</span><span class="p">,</span> <span class="n">dsatTdP</span><span class="p">)</span></div>
<div class="viewcode-block" id="fluid_column"><a class="viewcode-back" href="../fvars.html#fvars.fluid_column">[docs]</a><span class="k">def</span> <span class="nf">fluid_column</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">Tgrad</span><span class="p">,</span><span class="n">Tsurf</span><span class="p">,</span><span class="n">Psurf</span><span class="p">,</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">3</span><span class="p">):</span>
	<span class="sd">&#39;&#39;&#39;Calculate thermodynamic properties of a column of fluid.</span>
<span class="sd">	</span>
<span class="sd">	:param z: Vector of depths at which to return properties. If z does not begin at 0, this will be prepended.</span>
<span class="sd">	:type z: ndarray</span>
<span class="sd">	:param Tgrad: Temperature gradient in the column (degC / m).</span>
<span class="sd">	:type Tgrad: fl64</span>
<span class="sd">	:param Tsurf: Surface temperature (degC).</span>
<span class="sd">	:type Tsurf: fl64</span>
<span class="sd">	:param Psurf: Surface pressure (MPa).</span>
<span class="sd">	:type Psurf:</span>
<span class="sd">	:param iterations: Number of times to recalculate column pressure based on updated density.</span>
<span class="sd">	:type iterations: int</span>
<span class="sd">	:returns: Three element tuple containing (liquid, vapor, CO2) properties. Each contains a three column array corresponding to pressure, temperature, density, enthalpy and viscosity of the fluid.</span>
<span class="sd">	</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">z</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
	
	<span class="k">if</span> <span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
	
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span> 		<span class="c1"># interpret Tgrad as a down well temperature profile</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">):</span> <span class="nb">print</span> <span class="s1">&#39;ERROR: cannot find temperature gradient file </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">Tgrad</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">.&#39;</span><span class="p">;</span> <span class="k">return</span>
		
		<span class="n">tempfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">ln</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
		<span class="n">tempfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
		<span class="n">commaFlag</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">spaceFlag</span> <span class="o">=</span> <span class="kc">False</span>
		<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">commaFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ln</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> <span class="n">spaceFlag</span> <span class="o">=</span> <span class="kc">True</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">commaFlag</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">spaceFlag</span><span class="p">:</span> <span class="nb">print</span> <span class="s1">&#39;ERROR: incorrect formatting for </span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">Tgrad</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">. Expect first column depth (m) and second column temperature (degC), either comma or space separated.&#39;</span><span class="p">;</span> <span class="k">return</span>
		<span class="k">if</span> <span class="n">commaFlag</span><span class="p">:</span> <span class="n">tempdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span> <span class="n">tempdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">)</span>
		<span class="n">zt</span> <span class="o">=</span> <span class="n">tempdat</span><span class="p">[:,</span><span class="mi">0</span><span class="p">];</span> <span class="n">tt</span> <span class="o">=</span> <span class="n">tempdat</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
		
		<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">zt</span><span class="p">,</span><span class="n">tt</span><span class="p">)</span>
		
	<span class="k">else</span><span class="p">:</span>
		<span class="n">Tgrad</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">Tgrad</span><span class="p">)</span>
		<span class="n">T</span> <span class="o">=</span> <span class="n">Tsurf</span> <span class="o">+</span> <span class="n">Tgrad</span><span class="o">*</span><span class="n">z</span>
	<span class="n">Pgrad</span> <span class="o">=</span> <span class="mi">800</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e6</span>
	<span class="n">Phgrad</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e6</span>
	<span class="k">if</span> <span class="n">co2Vars</span><span class="p">:</span>
		<span class="n">Pco2</span> <span class="o">=</span> <span class="n">Psurf</span> <span class="o">+</span> <span class="n">Pgrad</span><span class="o">*</span><span class="n">z</span>
	<span class="n">Ph</span> <span class="o">=</span> <span class="n">Psurf</span> <span class="o">+</span> <span class="n">Phgrad</span><span class="o">*</span><span class="n">z</span>
	
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">co2Vars</span><span class="p">:</span>
			<span class="n">rho</span> <span class="o">=</span> <span class="n">dens</span><span class="p">(</span><span class="n">Pco2</span><span class="p">,</span><span class="n">T</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
			<span class="n">Pco2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">rho</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">z</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span><span class="o">+</span><span class="n">Pco2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">))])</span>
		<span class="n">rho</span> <span class="o">=</span> <span class="n">dens</span><span class="p">(</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">Ph</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">rho</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">z</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span><span class="o">*</span><span class="mf">9.81</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span><span class="o">+</span><span class="n">Ph</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rho</span><span class="p">))])</span>
	
	<span class="k">if</span> <span class="n">co2Vars</span><span class="p">:</span>
		<span class="n">rho</span> <span class="o">=</span> <span class="n">dens</span><span class="p">(</span><span class="n">Pco2</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
		<span class="n">H</span> <span class="o">=</span> <span class="n">enth</span><span class="p">(</span><span class="n">Pco2</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
		<span class="n">mu</span> <span class="o">=</span> <span class="n">visc</span><span class="p">(</span><span class="n">Pco2</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
	
	<span class="n">rhoh</span> <span class="o">=</span> <span class="n">dens</span><span class="p">(</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
	<span class="n">Hh</span> <span class="o">=</span> <span class="n">enth</span><span class="p">(</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
	<span class="n">muh</span> <span class="o">=</span> <span class="n">visc</span><span class="p">(</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">)</span>
	
	<span class="k">if</span> <span class="n">co2Vars</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">rhoh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">muh</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">rhoh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Hh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">muh</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Pco2</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">rho</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">H</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">mu</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">rhoh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hh</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">muh</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Ph</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">rhoh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">Hh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">muh</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span></div>

<span class="k">def</span> <span class="nf">co2_dens_sat_line</span><span class="p">(</span><span class="n">derivative</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;Return CO2 density, or derivatives with respect to temperature or pressure, for specified temperature and pressure near the CO2 saturation line.</span>
<span class="sd">	</span>
<span class="sd">	:param P: Pressure (MPa). </span>
<span class="sd">	:type P: fl64</span>
<span class="sd">	:param T: Temperature (degC)</span>
<span class="sd">	:type T: fl64</span>
<span class="sd">	:param derivative: Supply &#39;T&#39; or &#39;temperature&#39; for derivatives with respect to temperature, or &#39;P&#39; or &#39;pressure&#39; for derivatives with respect to pressure.</span>
<span class="sd">	:type T: str</span>
<span class="sd">	:returns: Three element tuple containing (liquid, vapor, CO2) density or derivatives if requested.</span>
<span class="sd">	</span>
<span class="sd">	&quot;&quot;&quot;</span>

	<span class="k">if</span> <span class="ow">not</span> <span class="n">co2Vars</span><span class="p">:</span> 
		<span class="nb">print</span> <span class="s2">&quot;Error: CO2 property table not found&quot;</span>
		<span class="k">return</span>
	
	<span class="c1"># calculate co2 properties</span>
	<span class="k">if</span> <span class="ow">not</span> <span class="n">derivative</span><span class="p">:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;density&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dddp&#39;</span>
	<span class="k">elif</span> <span class="n">derivative</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">]:</span> <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;dddt&#39;</span>
	
	<span class="nb">print</span> <span class="s1">&#39;P T liquid-&#39;</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="s1">&#39; gas-&#39;</span><span class="o">+</span><span class="n">k</span>
	<span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">co2_sat_P</span><span class="p">,</span> <span class="n">co2_sat_T</span><span class="p">,</span> <span class="n">co2l_arrays</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">co2g_arrays</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
		<span class="nb">print</span> <span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">g</span>

	<span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="n">co2_sat_P</span><span class="p">,</span> <span class="n">co2_sat_T</span><span class="p">,</span> <span class="n">co2l_arrays</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">co2g_arrays</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
</pre></div>

          </div>
            
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyFEHM 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2018, Los Alamos National Laboratory. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>